<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="https://www.w3.org/2005/Atom">
  <title>GWAN IT Blog</title>
  
  <subtitle>GWAN IT Blog</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://gwanhyeon.github.io/"/>
  <updated>2021-02-28T05:58:42.181Z</updated>
  <id>http://gwanhyeon.github.io/</id>
  
  <author>
    <name>gwanhyeon Kim</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Codility(코딜리티) Binarygap</title>
    <link href="http://gwanhyeon.github.io/Codility-20210228-codility-binary-gap/"/>
    <id>http://gwanhyeon.github.io/Codility-20210228-codility-binary-gap/</id>
    <published>2021-02-28T05:52:46.000Z</published>
    <updated>2021-02-28T05:58:42.181Z</updated>
    
    <content type="html"><![CDATA[<h1 id="codility-binary-gap"><a href="#codility-binary-gap" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#codility-binary-gap"></a> <a href="https://app.codility.com/programmers/lessons/1-iterations/binary_gap/start/" target="_blank" rel="noopener">Codility Binary Gap</a></h1><h2 id="keompyutingjeog-sago"><a href="#keompyutingjeog-sago" class="header-anchor">1.1. </a><a class="markdownIt-Anchor" href="#컴퓨팅적-사고"></a> 컴퓨팅적 사고</h2><p>이진수를 활용하여 이진수의 1의 위치에서 가장 최댓값을 구하는 간단한 문제였습니다. 약 20분정도 소요된 문제입니다. 처음에는 Integer.binaryString() 함수를 사용하지 않고 직접 구현을 하였는데, 불 필요해보였습니다. reverse()도 따로해줘야하고 시간복잡도면에서 뛰어나지 않다고 생각을 하게 되었습니다.</p><ol><li>N의 값 이진수로 변환합니다.</li><li>이진수로 변환후 1의 위치를 리스트에 저장합니다.</li><li>리스트에 담긴 위치별로 substring을 사용하여 값에 대한 length를 체크하여 최댓값을 구해줍니다.</li></ol><p>시간복잡도: O(N)</p><h2 id="soseukodeu"><a href="#soseukodeu" class="header-anchor">1.2. </a><a class="markdownIt-Anchor" href="#소스코드"></a> 소스코드</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">binaryGap_lesson01</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        solution(<span class="number">9</span>);</span><br><span class="line">        solution(<span class="number">1162</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">solution</span><span class="params">(<span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// write your code in Java SE 8</span></span><br><span class="line">        <span class="comment">/* 직접 구현하기 이진수로 변경</span></span><br><span class="line"><span class="comment">        List&lt;Integer&gt; arrList = new ArrayList&lt;&gt;();</span></span><br><span class="line"><span class="comment">                while(N &gt; 0)&#123;</span></span><br><span class="line"><span class="comment">                    int div = N % 2;</span></span><br><span class="line"><span class="comment">                    N = N / 2;</span></span><br><span class="line"><span class="comment">                    arrList.add(div);</span></span><br><span class="line"><span class="comment">                &#125;</span></span><br><span class="line"><span class="comment">                Collections.reverse(arrList);</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        String binaryStr = Integer.toBinaryString(N);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        List&lt;Integer&gt; arrList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;binaryStr.length(); i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(binaryStr.charAt(i) == <span class="string">'1'</span>)&#123;</span><br><span class="line">                cnt++;</span><br><span class="line">                arrList.add(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> answer = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(cnt &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arrList.size() - <span class="number">1</span>; i++) &#123;</span><br><span class="line">                String subStr = binaryStr.substring(arrList.get(i), arrList.get(i+<span class="number">1</span>));</span><br><span class="line">                answer = Math.max(answer, subStr.length()-<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//System.out.println("answer = " + answer);</span></span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;codility-binary-gap&quot;&gt;&lt;a href=&quot;#codility-binary-gap&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#codility-binary
      
    
    </summary>
    
    
      <category term="Codility" scheme="http://gwanhyeon.github.io/categories/codility/"/>
    
    
      <category term="Codility" scheme="http://gwanhyeon.github.io/tags/codility/"/>
    
      <category term="binary" scheme="http://gwanhyeon.github.io/tags/binary/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱서치 Bucket Aggregation(버켓 어그리게이션)</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-bucket-aggregation/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-bucket-aggregation/</id>
    <published>2021-02-19T07:00:40.000Z</published>
    <updated>2021-02-19T08:13:04.879Z</updated>
    
    <content type="html"><![CDATA[<h1 id="elk-elraseutigseoci-bucket-aggregation"><a href="#elk-elraseutigseoci-bucket-aggregation" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#elk-엘라스틱서치-bucket-aggregation"></a> ELK  엘라스틱서치 Bucket Aggregation</h1><blockquote><p>Bucket Aggregation이란?</p></blockquote><p>집계는 데이터를 그룹화하고 통계치를 얻는 기능입니다. SQL GROUP BY 및 SQL 집계 기능과 대략 같다고 보면 가장 쉽게 이해할 수 있습니다. Elasticsearch에서는 하나의 응답에서 검색 적중을 반환하는 검색을 실행함과 동시에 그와는 별도로 집계 결과를 반환할 수 있습니다. 즉 간결한 API를 사용하여 쿼리와 여러 집계를 실행하고 두 작업(또는 둘 중 하나)의 결과를 한꺼번에 얻어 네트워크 왕복을 피할 수 있다는 점에서 강력하고 효율적입니다.</p><p>요약하면, 평균을 구할때는 Matrix Aggregation을 사용하고 Bucket Aggregation은 그룹 및 통계치 기능하는 종류중 하나입니다.</p><blockquote><p>AGGREGATIONS STRUCTURE(어그리게이션 구조)</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET &lt;인덱스명&gt;/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"query"</span>: &#123;</span><br><span class="line">    … &lt;쿼리 구문&gt; …</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggs"</span>: &#123;</span><br><span class="line">    <span class="string">"&lt;임의의 aggregation 1&gt;"</span>: &#123;</span><br><span class="line">      <span class="string">"&lt;aggregation 종류&gt;"</span>: &#123;</span><br><span class="line">        … &lt;aggreagation 구문&gt; …</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"&lt;임의의 aggregation 2&gt;"</span>: &#123;</span><br><span class="line">      <span class="string">"&lt;aggregation 종류&gt;"</span>: &#123;</span><br><span class="line">        … &lt;aggreagation 구문&gt; …</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Aggregation 에는 크게 Metrics 그리고 Bucket 두 종류가 있습니다. Aggregations 구문이나 옵션에 metrics 이거나 bucket 이라고 따로 명시를 하지는 않습니다. Aggregation 종류들 중 숫자 또는 날짜 필드의 값을 가지고 계산을 하는 aggregation 들을 metrics aggregation 이라고 분류하고, 범위나 keyword 값 등을 가지고 도큐먼트들을 그룹화 하는 aggregation 들을 bucket aggregation 이라고 분류 합니다.</p><blockquote><p>basketball 인덱스 생성</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT -H &apos;Content-Type:application/json&apos; localhost:9200/basketball</span><br><span class="line">&#123;&quot;acknowledged&quot;:true,&quot;shards_acknowledged&quot;:true,&quot;index&quot;:&quot;basketball&quot;&#125;%</span><br></pre></td></tr></table></figure><blockquote><p>baseketball 인덱스 매핑 조회<br>해당 basketball_mapping JSON값들을 확인해보겠습니다.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vi</span> basketball_mapping.json</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  2     <span class="string">"record"</span> : &#123;</span><br><span class="line">  3         <span class="string">"properties"</span> : &#123;</span><br><span class="line">  4             <span class="string">"team"</span> : &#123;</span><br><span class="line">  5                 <span class="string">"type"</span> : <span class="string">"text"</span>,</span><br><span class="line">  6                 <span class="string">"fielddata"</span> : <span class="literal">true</span></span><br><span class="line">  7             &#125;,</span><br><span class="line">  8             <span class="string">"name"</span> : &#123;</span><br><span class="line">  9                 <span class="string">"type"</span> : <span class="string">"text"</span>,</span><br><span class="line"> 10                 <span class="string">"fielddata"</span> : <span class="literal">true</span></span><br><span class="line"> 11             &#125;,</span><br><span class="line"> 12             <span class="string">"points"</span> : &#123;</span><br><span class="line"> 13                 <span class="string">"type"</span> : <span class="string">"long"</span></span><br><span class="line"> 14             &#125;,</span><br><span class="line"> 15             <span class="string">"rebounds"</span> : &#123;</span><br><span class="line"> 16                 <span class="string">"type"</span> : <span class="string">"long"</span></span><br><span class="line"> 17             &#125;,</span><br><span class="line"> 18             <span class="string">"assists"</span> : &#123;</span><br><span class="line"> 19                 <span class="string">"type"</span> : <span class="string">"long"</span></span><br><span class="line"> 20             &#125;,</span><br><span class="line"> 21             <span class="string">"blocks"</span> : &#123;</span><br><span class="line"> 22                 <span class="string">"type"</span> : <span class="string">"long"</span></span><br><span class="line"> 23             &#125;,</span><br><span class="line"> 24             <span class="string">"submit_date"</span> : &#123;</span><br><span class="line"> 25                 <span class="string">"type"</span> : <span class="string">"date"</span>,</span><br><span class="line"> 26                 <span class="string">"format"</span> : <span class="string">"yyyy-MM-dd"</span></span><br><span class="line"> 27             &#125;</span><br><span class="line"> 28         &#125;</span><br><span class="line"> 29     &#125;</span><br><span class="line"> 30 &#125;</span><br><span class="line">~</span><br></pre></td></tr></table></figure><blockquote><p>baseketball 매핑 타입 삽입</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/basketball/record/_mapping&amp;include_type_name=true'</span> -d @basketball_mapping.json</span><br><span class="line">&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"_mapping&amp;include_type_name=true"</span>,<span class="string">"_version"</span>:5,<span class="string">"result"</span>:<span class="string">"updated"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:12,<span class="string">"_primary_term"</span>:1&#125;%</span><br></pre></td></tr></table></figure><p><strong>의미</strong></p><p>basketball: Index<br>record: Type<br>_mapping: Mapping<br>-d: direct</p><blockquote><p>baseketball documents 삽입</p></blockquote><p><strong>twoteam_basketball.json</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"basketball"</span>, <span class="string">"_type"</span> : <span class="string">"record"</span>, <span class="string">"_id"</span> : <span class="string">"1"</span> &#125;     &#125;</span><br><span class="line"> 2 &#123;<span class="string">"team"</span> : <span class="string">"Chicago"</span>,<span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>, <span class="string">"points"</span> : 30,<span class="string">"rebounds"</span> :     3,<span class="string">"assists"</span> : 4, <span class="string">"blocks"</span> : 3, <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span>&#125;</span><br><span class="line"> 3 &#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"basketball"</span>, <span class="string">"_type"</span> : <span class="string">"record"</span>, <span class="string">"_id"</span> : <span class="string">"2"</span> &#125;     &#125;</span><br><span class="line"> 4 &#123;<span class="string">"team"</span> : <span class="string">"Chicago"</span>,<span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>,<span class="string">"points"</span> : 20,<span class="string">"rebounds"</span> :     5,<span class="string">"assists"</span> : 8, <span class="string">"blocks"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"1996-10-13"</span>&#125;</span><br><span class="line"> 5 &#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"basketball"</span>, <span class="string">"_type"</span> : <span class="string">"record"</span>, <span class="string">"_id"</span> : <span class="string">"3"</span> &#125;     &#125;</span><br><span class="line"> 6 &#123;<span class="string">"team"</span> : <span class="string">"LA"</span>,<span class="string">"name"</span> : <span class="string">"Kobe Bryant"</span>,<span class="string">"points"</span> : 30,<span class="string">"rebounds"</span> : 2,<span class="string">"assis    ts"</span> : 8, <span class="string">"blocks"</span> : 5, <span class="string">"submit_date"</span> : <span class="string">"2014-10-13"</span>&#125;</span><br><span class="line"> 7 &#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"basketball"</span>, <span class="string">"_type"</span> : <span class="string">"record"</span>, <span class="string">"_id"</span> : <span class="string">"4"</span> &#125;     &#125;</span><br><span class="line"> 8 &#123;<span class="string">"team"</span> : <span class="string">"LA"</span>,<span class="string">"name"</span> : <span class="string">"Kobe Bryant"</span>,<span class="string">"points"</span> : 40,<span class="string">"rebounds"</span> : 4,<span class="string">"assis    ts"</span> : 8, <span class="string">"blocks"</span> : 6, <span class="string">"submit_date"</span> : <span class="string">"2014-11-13"</span>&#125;</span><br></pre></td></tr></table></figure><p><strong>document삽입</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_bulk'</span> --data-binary @twoteam_basketball.json</span><br><span class="line">&#123;<span class="string">"took"</span>:411,<span class="string">"errors"</span>:<span class="literal">false</span>,<span class="string">"items"</span>:[&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:1,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:201&#125;&#125;,&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"2"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:2,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:201&#125;&#125;,&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"3"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:3,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:201&#125;&#125;,&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"4"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:4,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:201&#125;&#125;]&#125;%</span><br></pre></td></tr></table></figure><blockquote><p>Term Aggregation(GROUP BY TEAM)</p></blockquote><p><strong>terms_aggs.json 데이터 확인</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">vi terms_aggs.json</span><br><span class="line"></span><br><span class="line">1 &#123;</span><br><span class="line">2     <span class="string">"size"</span> : 0,</span><br><span class="line">3     <span class="string">"aggs"</span> : &#123;</span><br><span class="line">4         <span class="string">"players"</span> : &#123;</span><br><span class="line">5             <span class="string">"terms"</span> : &#123;</span><br><span class="line">6                 <span class="string">"field"</span> : <span class="string">"team"</span></span><br><span class="line">7             &#125;</span><br><span class="line">8         &#125;</span><br><span class="line">9     &#125;</span><br><span class="line">10 &#125;</span><br></pre></td></tr></table></figure><p><strong>terms_aggs.json 조회</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">$curl -XGET -H &apos;Content-Type:application/json&apos; &apos;localhost:9200/_search?pretty&apos; --data-binary @terms_aggs.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;took&quot; : 880,</span><br><span class="line">  &quot;timed_out&quot; : false,</span><br><span class="line">  &quot;_shards&quot; : &#123;</span><br><span class="line">    &quot;total&quot; : 7,</span><br><span class="line">    &quot;successful&quot; : 6,</span><br><span class="line">    &quot;skipped&quot; : 0,</span><br><span class="line">    &quot;failed&quot; : 1,</span><br><span class="line">    &quot;failures&quot; : [</span><br><span class="line">      &#123;</span><br><span class="line">        &quot;shard&quot; : 0,</span><br><span class="line">        &quot;index&quot; : &quot;basketball&quot;,</span><br><span class="line">        &quot;node&quot; : &quot;gsruIbFGTQmlTUIk7jr1Aw&quot;,</span><br><span class="line">        &quot;reason&quot; : &#123;</span><br><span class="line">          &quot;type&quot; : &quot;illegal_argument_exception&quot;,</span><br><span class="line">          &quot;reason&quot; : &quot;Text fields are not optimised for operations that require per-document field data like aggregations and sorting, so these operations are disabled by default. Please use a keyword field instead. Alternatively, set fielddata=true on [team] in order to load field data by uninverting the inverted index. Note that this can use significant memory.&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;hits&quot; : &#123;</span><br><span class="line">    &quot;total&quot; : &#123;</span><br><span class="line">      &quot;value&quot; : 48,</span><br><span class="line">      &quot;relation&quot; : &quot;eq&quot;</span><br><span class="line">    &#125;,</span><br><span class="line">    &quot;max_score&quot; : null,</span><br><span class="line">    &quot;hits&quot; : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;aggregations&quot; : &#123;</span><br><span class="line">    &quot;players&quot; : &#123;</span><br><span class="line">      &quot;doc_count_error_upper_bound&quot; : 0,</span><br><span class="line">      &quot;sum_other_doc_count&quot; : 0,</span><br><span class="line">      &quot;buckets&quot; : [ ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 Aggregation을 조회해온것을 확인할 수 있습니다.</p><blockquote><p>AGGS(STATS GROUP BT TEAM)</p></blockquote><p><strong>vi stats_by_team.json 데이터확인</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$vi</span> stat_by_team.json</span><br><span class="line">1 &#123;</span><br><span class="line"> 2     <span class="string">"size"</span> : 0,</span><br><span class="line"> 3     <span class="string">"aggs"</span> : &#123;</span><br><span class="line"> 4         <span class="string">"team_stats"</span> : &#123;</span><br><span class="line"> 5             <span class="string">"terms"</span> : &#123;</span><br><span class="line"> 6                 <span class="string">"field"</span> : <span class="string">"team"</span></span><br><span class="line"> 7             &#125;,</span><br><span class="line"> 8             <span class="string">"aggs"</span> : &#123;</span><br><span class="line"> 9                 <span class="string">"stats_score"</span> : &#123;</span><br><span class="line">10                     <span class="string">"stats"</span> : &#123;</span><br><span class="line">11                         <span class="string">"field"</span> : <span class="string">"points"</span></span><br><span class="line">12                     &#125;</span><br><span class="line">13                 &#125;</span><br><span class="line">14             &#125;</span><br><span class="line">15         &#125;</span><br><span class="line">16     &#125;</span><br><span class="line">17 &#125;</span><br></pre></td></tr></table></figure><blockquote><p>Aggregation 내용 확인하기</p></blockquote><p>size는 보기편하기위해서 넣어준 속성이되고, 팀별로 documents들을 묶고, 나머지 어그리제이션을 사용하여 점수별로 Stat를 한번 표시해라 라는 의미가 됩니다. 각 팀별로 통계분석을 도출하면 되는 뜻입니다.</p><p><strong>AGGS(STATS GROUP BT TEAM)조회</strong></p><blockquote><p>결과값 데이터가 제대로 들어가지않은부분이 있어서 다시 수정 필요.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_search?q=points&amp;pretty'</span> --data-binary @stats_by_team.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 44,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 7,</span><br><span class="line">    <span class="string">"successful"</span> : 6,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 1,</span><br><span class="line">    <span class="string">"failures"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"shard"</span> : 0,</span><br><span class="line">        <span class="string">"index"</span> : <span class="string">"basketball"</span>,</span><br><span class="line">        <span class="string">"node"</span> : <span class="string">"gsruIbFGTQmlTUIk7jr1Aw"</span>,</span><br><span class="line">        <span class="string">"reason"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"illegal_argument_exception"</span>,</span><br><span class="line">          <span class="string">"reason"</span> : <span class="string">"Text fields are not optimised for operations that require per-document field data like aggregations and sorting, so these operations are disabled by default. Please use a keyword field instead. Alternatively, set fielddata=true on [team] in order to load field data by uninverting the inverted index. Note that this can use significant memory."</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 0,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : null,</span><br><span class="line">    <span class="string">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="string">"team_stats"</span> : &#123;</span><br><span class="line">      <span class="string">"doc_count_error_upper_bound"</span> : 0,</span><br><span class="line">      <span class="string">"sum_other_doc_count"</span> : 0,</span><br><span class="line">      <span class="string">"buckets"</span> : [ ]</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Reference</p></blockquote><p><a href="https://esbook.kimjmin.net/08-aggregations/8.2-bucket-aggregations" target="_blank" rel="noopener">https://esbook.kimjmin.net/08-aggregations/8.2-bucket-aggregations</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;elk-elraseutigseoci-bucket-aggregation&quot;&gt;&lt;a href=&quot;#elk-elraseutigseoci-bucket-aggregation&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;mar
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
      <category term="Aggregation" scheme="http://gwanhyeon.github.io/tags/aggregation/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱서치 Metric Aggregation(메트릭 어그리게이션)</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-metric-aggregation/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-metric-aggregation/</id>
    <published>2021-02-19T06:12:31.000Z</published>
    <updated>2021-02-19T07:11:37.435Z</updated>
    
    <content type="html"><![CDATA[<h1 id="elraseutigseoci-metric-eogeurigeisyeon-metric-aggregation"><a href="#elraseutigseoci-metric-eogeurigeisyeon-metric-aggregation" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#엘라스틱서치-metric-어그리게이션metric-aggregation"></a> 엘라스틱서치 Metric 어그리게이션(Metric Aggregation)</h1><blockquote><p>Aggregation ?</p></blockquote><p>Elasticsearch 는 검색엔진으로 개발되었지만 지금은 로그분석을 비롯해 다양한 목적의데이터 시스템으로 사용되고 있습니다. Elasticsearch가 이렇게 다양한 용도로 활용이 될 수 있는 이유는 데이터를 단순히 검색만 하는 것이 아니라 여러가지 연산을 할 수 있는 Aggregation 기능이 있기 때문입니다</p><blockquote><p>메트릭 어그리게이션(Metric Aggregation)?<br>가장 흔하게 사용되는 metrics aggregations 은 min, max, sum, avg aggregation 입니다. 순서대로 명시한 필드의 최소, 최대, 합, 평균 값을 가져오는 aggregation 입니다.<br>엘라스틱서치안에 있는 Document안에 있는 값을 조합을 통하여 값을 핸들링할때 사용하는 컨셉이라고 할 수 있습니다.</p></blockquote><blockquote><p>메트릭 어그리게이션(Metric Aggregation) 구조</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">GET my_stations/_search</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"size"</span>: 0,</span><br><span class="line">  <span class="string">"aggs"</span>: &#123;</span><br><span class="line">    <span class="string">"all_passangers"</span>: &#123;</span><br><span class="line">      <span class="string">"sum"</span>: &#123;</span><br><span class="line">        <span class="string">"field"</span>: <span class="string">"passangers"</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Data</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"basketball"</span>, <span class="string">"_type"</span> : <span class="string">"record"</span>, <span class="string">"_id"</span> : <span class="string">"1"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"team"</span> : <span class="string">"Chicago Bulls"</span>,<span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>, <span class="string">"points"</span> : 30,<span class="string">"rebounds"</span> : 3,<span class="string">"assists"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span>&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"basketball"</span>, <span class="string">"_type"</span> : <span class="string">"record"</span>, <span class="string">"_id"</span> : <span class="string">"2"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"team"</span> : <span class="string">"Chicago Bulls"</span>,<span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>,<span class="string">"points"</span> : 20,<span class="string">"rebounds"</span> : 5,<span class="string">"assists"</span> : 8, <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span>&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Data Insert</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_bulk'</span> --data-binary @simple_basketball.json</span><br><span class="line">&#123;<span class="string">"took"</span>:58,<span class="string">"errors"</span>:<span class="literal">false</span>,<span class="string">"items"</span>:[&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:2,<span class="string">"result"</span>:<span class="string">"updated"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:2,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:200&#125;&#125;,&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"2"</span>,<span class="string">"_version"</span>:2,<span class="string">"result"</span>:<span class="string">"updated"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:3,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:200&#125;&#125;]&#125;%</span><br></pre></td></tr></table></figure><p>다음과 같은 데이터를 -XPOST 옵션과 --data-binary를 통해 넣어주겠습니다.<br>평균값을 넣어주는 json파일의 형식을 조회해오면 다음과 같은 값들을 넣을 수 있습니다.</p><blockquote><p>평균값 json 조회</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET localhost:9200/_search\?pretty --data-binary @avg_point_aggs.json</span><br></pre></td></tr></table></figure><blockquote><p>평균값 json 조회 결과</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_search?pretty'</span> --data-binary @avg_points_aggs.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 21,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 7,</span><br><span class="line">    <span class="string">"successful"</span> : 7,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 50,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : null,</span><br><span class="line">    <span class="string">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="string">"avg_score"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 25.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 Metric Aggregation을 사용하여 평균값을 구한것을 확인할 수 있습니다.</p><blockquote><p>최댓값 구하기</p></blockquote><p><strong>Data</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"size"</span> : 0,</span><br><span class="line">    <span class="string">"aggs"</span> : &#123;</span><br><span class="line">        <span class="string">"max_score"</span> : &#123;</span><br><span class="line">            <span class="string">"max"</span> : &#123;</span><br><span class="line">                <span class="string">"field"</span> : <span class="string">"points"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>최댓값 조회</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_search?pretty'</span> --data-binary @max_points_aggs.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 36,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 7,</span><br><span class="line">    <span class="string">"successful"</span> : 7,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 50,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : null,</span><br><span class="line">    <span class="string">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="string">"max_score"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 30.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 Metric Aggregation을 사용하여 최댓값을 구한것을 확인할 수 있습니다.</p><blockquote><p>최솟값 구하기</p></blockquote><p><strong>Data</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"size"</span> : 0,</span><br><span class="line">    <span class="string">"aggs"</span> : &#123;</span><br><span class="line">        <span class="string">"min_score"</span> : &#123;</span><br><span class="line">            <span class="string">"min"</span> : &#123;</span><br><span class="line">                <span class="string">"field"</span> : <span class="string">"points"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>최솟값 조회</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_search?pretty'</span> --data-binary @min_points_aggs.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 268,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 7,</span><br><span class="line">    <span class="string">"successful"</span> : 7,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 50,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : null,</span><br><span class="line">    <span class="string">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="string">"min_score"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 20.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 Metric Aggregation을 사용하여 최솟값을 구한것을 확인할 수 있습니다.</p><blockquote><p>모든합(SUM) 구하기</p></blockquote><p><strong>Data</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"size"</span> : 0,</span><br><span class="line">    <span class="string">"aggs"</span> : &#123;</span><br><span class="line">        <span class="string">"sum_score"</span> : &#123;</span><br><span class="line">            <span class="string">"sum"</span> : &#123;</span><br><span class="line">                <span class="string">"field"</span> : <span class="string">"points"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>모든합 조회</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_search?pretty'</span> --data-binary @sum_points_aggs.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 17,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 7,</span><br><span class="line">    <span class="string">"successful"</span> : 7,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 50,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : null,</span><br><span class="line">    <span class="string">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="string">"sum_score"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 50.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 Metric Aggregation을 사용하여 모든합을 구한것을 확인할 수 있습니다.</p><blockquote><p>모든값 목록 (STAT) 구하기</p></blockquote><p><strong>Data</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"size"</span> : 0,</span><br><span class="line">    <span class="string">"aggs"</span> : &#123;</span><br><span class="line">        <span class="string">"stats_score"</span> : &#123;</span><br><span class="line">            <span class="string">"stats"</span> : &#123;</span><br><span class="line">                <span class="string">"field"</span> : <span class="string">"points"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>모든값 목록 (STAT) 구하기</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_search?pretty'</span> --data-binary @stat_points_aggs.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 66,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 7,</span><br><span class="line">    <span class="string">"successful"</span> : 7,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 50,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : null,</span><br><span class="line">    <span class="string">"hits"</span> : [ ]</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"aggregations"</span> : &#123;</span><br><span class="line">    <span class="string">"stats_score"</span> : &#123;</span><br><span class="line">      <span class="string">"count"</span> : 2,</span><br><span class="line">      <span class="string">"min"</span> : 20.0,</span><br><span class="line">      <span class="string">"max"</span> : 30.0,</span><br><span class="line">      <span class="string">"avg"</span> : 25.0,</span><br><span class="line">      <span class="string">"sum"</span> : 50.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 Metric Aggregation을 사용하여 모든 연사결과의 목록을 구한것을 확인할 수 있습니다.</p><blockquote><p>Reference</p></blockquote><p><a href="https://esbook.kimjmin.net/08-aggregations/8.1-metrics-aggregations" target="_blank" rel="noopener">https://esbook.kimjmin.net/08-aggregations/8.1-metrics-aggregations</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;elraseutigseoci-metric-eogeurigeisyeon-metric-aggregation&quot;&gt;&lt;a href=&quot;#elraseutigseoci-metric-eogeurigeisyeon-metric-aggregation&quot; clas
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
      <category term="MetricAggregation" scheme="http://gwanhyeon.github.io/tags/metricaggregation/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱서치 Search Function</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-search-function/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-search-function/</id>
    <published>2021-02-19T05:54:27.000Z</published>
    <updated>2021-02-19T08:15:05.171Z</updated>
    
    <content type="html"><![CDATA[<h1 id="elk-elraseutig-seoci-searchfunction"><a href="#elk-elraseutig-seoci-searchfunction" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#elk-엘라스틱-서치-searchfunction"></a> ELK 엘라스틱 서치 SearchFunction</h1><p>이번에 포스팅에서는 ELK의 SearchFunction에 대해서 살펴보겠습니다.</p><blockquote><p>Data</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type:application/json'</span> <span class="string">'localhost:9200/_bulk'</span> --dat</span><br><span class="line">a-binary @simple_basketball.json</span><br><span class="line"></span><br><span class="line">&#123;<span class="string">"took"</span>:1391,<span class="string">"errors"</span>:<span class="literal">false</span>,<span class="string">"items"</span>:[&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:0,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:201&#125;&#125;,&#123;<span class="string">"index"</span>:&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"2"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:1,<span class="string">"_primary_term"</span>:1,<span class="string">"status"</span>:201&#125;&#125;]&#125;%</span><br></pre></td></tr></table></figure><p>다음과 같은 데이터를 가지고 확인을 해보겠습니다. 그러면 두개의 Document가 삽입되게 됩니다.</p><blockquote><p>Search</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET localhost:9200/basketball/record/_search\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 80,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 1,</span><br><span class="line">    <span class="string">"successful"</span> : 1,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 2,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : 1.0,</span><br><span class="line">    <span class="string">"hits"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"basketball"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"record"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"team"</span> : <span class="string">"Chicago Bulls"</span>,</span><br><span class="line">          <span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>,</span><br><span class="line">          <span class="string">"points"</span> : 30,</span><br><span class="line">          <span class="string">"rebounds"</span> : 3,</span><br><span class="line">          <span class="string">"assists"</span> : 4,</span><br><span class="line">          <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"basketball"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"record"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"2"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"team"</span> : <span class="string">"Chicago Bulls"</span>,</span><br><span class="line">          <span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>,</span><br><span class="line">          <span class="string">"points"</span> : 20,</span><br><span class="line">          <span class="string">"rebounds"</span> : 5,</span><br><span class="line">          <span class="string">"assists"</span> : 8,</span><br><span class="line">          <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 데이터가 정상적으로 들어가고 Documents가 조회되는것들을 확인할 수 있습니다.</p><blockquote><p>SEARCH -URI</p></blockquote><p>-URI 옵션을 사용하여 제가 조회할 데이터들을 조회할 수 있습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET <span class="string">'localhost:9200/basketball/record/_search?q=points:30&amp;pretty'</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 18,</span><br><span class="line">  <span class="string">"timed_out"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"_shards"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : 1,</span><br><span class="line">    <span class="string">"successful"</span> : 1,</span><br><span class="line">    <span class="string">"skipped"</span> : 0,</span><br><span class="line">    <span class="string">"failed"</span> : 0</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"hits"</span> : &#123;</span><br><span class="line">    <span class="string">"total"</span> : &#123;</span><br><span class="line">      <span class="string">"value"</span> : 1,</span><br><span class="line">      <span class="string">"relation"</span> : <span class="string">"eq"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"max_score"</span> : 1.0,</span><br><span class="line">    <span class="string">"hits"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"basketball"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"record"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"_score"</span> : 1.0,</span><br><span class="line">        <span class="string">"_source"</span> : &#123;</span><br><span class="line">          <span class="string">"team"</span> : <span class="string">"Chicago Bulls"</span>,</span><br><span class="line">          <span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>,</span><br><span class="line">          <span class="string">"points"</span> : 30,</span><br><span class="line">          <span class="string">"rebounds"</span> : 3,</span><br><span class="line">          <span class="string">"assists"</span> : 4,</span><br><span class="line">          <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SEARCH - REQUEST BODY</p></blockquote><p>이번에 살펴볼 옵션은 -REQUEST BODY옵션입니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET -H <span class="string">'Content-Type:application/json'</span> localhost:9200/basketball/record/_search -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;</span></span><br><span class="line"><span class="string">"query" : &#123;</span></span><br><span class="line"><span class="string">"term" : &#123;"points" : 30&#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br><span class="line"><span class="string">&#125;'</span></span><br><span class="line">&#123;<span class="string">"took"</span>:16,<span class="string">"timed_out"</span>:<span class="literal">false</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:1,<span class="string">"successful"</span>:1,<span class="string">"skipped"</span>:0,<span class="string">"failed"</span>:0&#125;,<span class="string">"hits"</span>:&#123;<span class="string">"total"</span>:&#123;<span class="string">"value"</span>:1,<span class="string">"relation"</span>:<span class="string">"eq"</span>&#125;,<span class="string">"max_score"</span>:1.0,<span class="string">"hits"</span>:[&#123;<span class="string">"_index"</span>:<span class="string">"basketball"</span>,<span class="string">"_type"</span>:<span class="string">"record"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_score"</span>:1.0,<span class="string">"_source"</span>:&#123;<span class="string">"team"</span> : <span class="string">"Chicago Bulls"</span>,<span class="string">"name"</span> : <span class="string">"Michael Jordan"</span>, <span class="string">"points"</span> : 30,<span class="string">"rebounds"</span> : 3,<span class="string">"assists"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"1996-10-11"</span>&#125;&#125;]&#125;&#125;%</span><br></pre></td></tr></table></figure><p>다음과 같이 직접 REQUEST BODY를 사용하여 값을 조회해오는모습을 볼 수 있습니다.<br>-d는 Direct로 처리하기 위한 옵션입니다.</p><blockquote><p>참고사항</p></blockquote><p><a href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/search-request-body.html" target="_blank" rel="noopener">https://www.elastic.co/guide/en/elasticsearch/reference/6.8/search-request-body.html</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;elk-elraseutig-seoci-searchfunction&quot;&gt;&lt;a href=&quot;#elk-elraseutig-seoci-searchfunction&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownI
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
      <category term="SearchFunction" scheme="http://gwanhyeon.github.io/tags/searchfunction/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱 서치 Mapping</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-mapping/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-mapping/</id>
    <published>2021-02-19T05:11:20.000Z</published>
    <updated>2021-02-19T05:39:44.746Z</updated>
    
    <content type="html"><![CDATA[<h1 id="elk-elraseutigseoci-mapping"><a href="#elk-elraseutigseoci-mapping" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#elk-엘라스틱서치-mapping"></a> ELK 엘라스틱서치 MAPPING</h1><p>ELK에서 말하는 개념은 RDS에서 스키마와 동일한 의미를 가지고 있습니다.<br>Mapping없이 ELK 데이터를 넣는것은 상당히 위험하고 Document Mapping이 되어있지않다면 Date, String과 같은 구별이 가지않을 수 있습니다.</p><p>잘못지정된 타입같은 경우 Kibana를 사용하여 데이터를 분리하여 보여주고 싶거나 데이터값의 평균값을 구할때 제대로된 계산이 처리되지 않을 수 있습니다.</p><blockquote><p>Mapping JSON</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"class"</span> : &#123;</span><br><span class="line">        <span class="string">"properties"</span> : &#123;</span><br><span class="line">            <span class="string">"title"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"professor"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"major"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"semester"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"student_count"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"integer"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"unit"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"integer"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"rating"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"integer"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"submit_date"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"date"</span>,</span><br><span class="line">                <span class="string">"format"</span>: <span class="string">"yyyy-MM-dd"</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="string">"school_location"</span> : &#123;</span><br><span class="line">                <span class="string">"type"</span> : <span class="string">"geo_point"</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>현재 Mapping 관계를 사용해보기 위해서 사용해볼 json형식은 다음과 같습니다.<br>Type:geo_point 같은 경우 Kibana Data시각화할때, 지도위에서 학교위치를 직접 표시할 수 있습니다. Type이 Date Format을 사용할경우 날짜별로 시각화를 처리할 수도 있습니다.</p><p>이제 다음과 같이 이전에 사용하였던 classes인덱스를 삭제해주고 다시 classes라는 인덱스를 재생성하여 Mapping 처리를  알아 보도록 하겠습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$curl</span> -XDELETE http://localhost:9200/classes</span><br><span class="line">&#123;<span class="string">"acknowledged"</span>:<span class="literal">true</span>&#125;%</span><br><span class="line"> kgh  ~</span><br><span class="line"><span class="variable">$curl</span> -XPUT http://localhost:9200/classes</span><br><span class="line">&#123;<span class="string">"acknowledged"</span>:<span class="literal">true</span>,<span class="string">"shards_acknowledged"</span>:<span class="literal">true</span>,<span class="string">"index"</span>:<span class="string">"classes"</span>&#125;%</span><br><span class="line"> kgh  ~</span><br><span class="line"><span class="variable">$curl</span> -XGET http://localhost:9200/classes\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"classes"</span> : &#123;</span><br><span class="line">    <span class="string">"aliases"</span> : &#123; &#125;,</span><br><span class="line">    <span class="string">"mappings"</span> : &#123; &#125;,</span><br><span class="line">    <span class="string">"settings"</span> : &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"routing"</span> : &#123;</span><br><span class="line">          <span class="string">"allocation"</span> : &#123;</span><br><span class="line">            <span class="string">"include"</span> : &#123;</span><br><span class="line">              <span class="string">"_tier_preference"</span> : <span class="string">"data_content"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"number_of_shards"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"provided_name"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"creation_date"</span> : <span class="string">"1613711830633"</span>,</span><br><span class="line">        <span class="string">"number_of_replicas"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"uuid"</span> : <span class="string">"q99TJFowRqu7LFB1DjowZQ"</span>,</span><br><span class="line">        <span class="string">"version"</span> : &#123;</span><br><span class="line">          <span class="string">"created"</span> : <span class="string">"7110199"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 인덱스를 삭제하고 재 생성한것을 보실 수 있습니다. 여기서 중요한점은<br>mapping이 현재 비어져있다는것입니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPUT -H <span class="string">'Content-Type:application/json'</span> <span class="string">'http://localhost:9200/classes/class/_mapping?include_type_name=true'</span> -d @classesRating_mapping.json</span><br><span class="line">&#123;<span class="string">"acknowledged"</span>:<span class="literal">true</span>&#125;%</span><br></pre></td></tr></table></figure><p>Elasticsearch 6.0 will show this error. 가 발생하였는데, 제가 지금쓰고 있는 버전은 7.11버전을 사용중입니다.<br>즉, elasticsearch 7.x 버전부터는 curl 리퀘스트에서 헤더를 명확히 설정해주어야하고 또 mappign을 생성할 때에는 include_type_name을 true로 설정해주어야합니다.<br>이에 대해서 원인을 찾아보니 elasticsearch가 mapping 타입 중 string을 삭제하고 text로 변경하여 사용하고있다고 합니다.</p><p>버전별로 생기는 미세한 차이점을 잘 체크하면서 변경된 사항을 잘 확인해야될 것 같습니다.</p><p><a href="https://stackoverflow.com/questions/47452770/no-handler-for-type-string-declared-on-field-name" target="_blank" rel="noopener">https://stackoverflow.com/questions/47452770/no-handler-for-type-string-declared-on-field-name</a></p><blockquote><p>이제 다음과 같이 ELK 매핑이 되었는지 확인을 해보겠습니다.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$curl</span> -XGET http://localhost:9200/classes\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"classes"</span> : &#123;</span><br><span class="line">    <span class="string">"aliases"</span> : &#123; &#125;,</span><br><span class="line">    <span class="string">"mappings"</span> : &#123;</span><br><span class="line">      <span class="string">"properties"</span> : &#123;</span><br><span class="line">        <span class="string">"major"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"professor"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"rating"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"integer"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"school_location"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"geo_point"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"semester"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"student_count"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"integer"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"submit_date"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"date"</span>,</span><br><span class="line">          <span class="string">"format"</span> : <span class="string">"yyyy-MM-dd"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"title"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"text"</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"unit"</span> : &#123;</span><br><span class="line">          <span class="string">"type"</span> : <span class="string">"integer"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="string">"settings"</span> : &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"routing"</span> : &#123;</span><br><span class="line">          <span class="string">"allocation"</span> : &#123;</span><br><span class="line">            <span class="string">"include"</span> : &#123;</span><br><span class="line">              <span class="string">"_tier_preference"</span> : <span class="string">"data_content"</span></span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"number_of_shards"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"provided_name"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"creation_date"</span> : <span class="string">"1613711830633"</span>,</span><br><span class="line">        <span class="string">"number_of_replicas"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"uuid"</span> : <span class="string">"q99TJFowRqu7LFB1DjowZQ"</span>,</span><br><span class="line">        <span class="string">"version"</span> : &#123;</span><br><span class="line">          <span class="string">"created"</span> : <span class="string">"7110199"</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>이제 이런식으로 매핑을 진행하면 시각화에서 조금더 유연하게 처리가 가능하게 됩니다.다시 Document에 값을 집어 넣어보도록 하겠습니다.</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H 'Content-Type:application/json' http://localhost:9200/_bulk\?pretty --data-binary @Classes.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attr">"took"</span> : <span class="number">1703</span>,</span><br><span class="line">  <span class="attr">"errors"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="attr">"items"</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">0</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"2"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"3"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">2</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"5"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">3</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"6"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">4</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"7"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">5</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"8"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">6</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"9"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">7</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"10"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">8</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"11"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">9</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"12"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">10</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"13"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">11</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"14"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">12</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"15"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">13</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"16"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">14</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"17"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">15</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"18"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">16</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"19"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">17</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"20"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">18</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"21"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">19</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"22"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">20</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"23"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">21</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"24"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">22</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"index"</span> : &#123;</span><br><span class="line">        <span class="attr">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="attr">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="attr">"_id"</span> : <span class="string">"25"</span>,</span><br><span class="line">        <span class="attr">"_version"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="attr">"_shards"</span> : &#123;</span><br><span class="line">          <span class="attr">"total"</span> : <span class="number">2</span>,</span><br><span class="line">          <span class="attr">"successful"</span> : <span class="number">1</span>,</span><br><span class="line">          <span class="attr">"failed"</span> : <span class="number">0</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">"_seq_no"</span> : <span class="number">23</span>,</span><br><span class="line">        <span class="attr">"_primary_term"</span> : <span class="number">1</span>,</span><br><span class="line">        <span class="attr">"status"</span> : <span class="number">201</span></span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>최종 출력</p></blockquote><p>이제 제대로 값들이 들어간것을 확인할 수 있습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://localhost:9200/classes/class/1\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">  <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">  <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">  <span class="string">"_version"</span> : 1,</span><br><span class="line">  <span class="string">"_seq_no"</span> : 0,</span><br><span class="line">  <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">  <span class="string">"found"</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"_source"</span> : &#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Machine Learning"</span>,</span><br><span class="line">    <span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,</span><br><span class="line">    <span class="string">"major"</span> : <span class="string">"Computer Science"</span>,</span><br><span class="line">    <span class="string">"semester"</span> : [</span><br><span class="line">      <span class="string">"spring"</span>,</span><br><span class="line">      <span class="string">"fall"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"student_count"</span> : 100,</span><br><span class="line">    <span class="string">"unit"</span> : 3,</span><br><span class="line">    <span class="string">"rating"</span> : 5,</span><br><span class="line">    <span class="string">"submit_date"</span> : <span class="string">"2016-01-02"</span>,</span><br><span class="line">    <span class="string">"school_location"</span> : &#123;</span><br><span class="line">      <span class="string">"lat"</span> : 36.0,</span><br><span class="line">      <span class="string">"lon"</span> : -120.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;elk-elraseutigseoci-mapping&quot;&gt;&lt;a href=&quot;#elk-elraseutigseoci-mapping&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
      <category term="Mapping" scheme="http://gwanhyeon.github.io/tags/mapping/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱서치 BULK</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-bulk/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-bulk/</id>
    <published>2021-02-19T04:57:51.000Z</published>
    <updated>2021-02-19T05:08:19.227Z</updated>
    
    <content type="html"><![CDATA[<h1 id="elk-elraseutigseoci-bulk"><a href="#elk-elraseutigseoci-bulk" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#elk-엘라스틱서치-bulk"></a> ELK 엘라스틱서치 BULK</h1><blockquote><p>Elastic BULK란 무엇일까요?</p></blockquote><p>간단히 말해 여러개의 Document를 한번에 ElasticSearch에 넣는 방식을 말합니다.</p><p>그러면 바로 실습으로 알아보도록 하겠습니다.</p><p>제가 사용할 실습 json파일은 다음과 같습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"1"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Machine Learning"</span>,<span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>, <span class="string">"fall"</span>],<span class="string">"student_count"</span> : 100,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 5, <span class="string">"submit_date"</span> : <span class="string">"2016-01-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 36.00, <span class="string">"lon"</span> : -120.00&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"2"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Network"</span>,<span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 50,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"2016-02-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 36.00, <span class="string">"lon"</span> : -120.00&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"3"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Operating System"</span>,<span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>],<span class="string">"student_count"</span> : 50,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"2016-03-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 36.00, <span class="string">"lon"</span> : -120.00&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"5"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Machine Learning"</span>,<span class="string">"Professor"</span> : <span class="string">"Tim Cook"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>],<span class="string">"student_count"</span> : 40,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-04-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 39.00, <span class="string">"lon"</span> : -112.00&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"6"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Network"</span>,<span class="string">"Professor"</span> : <span class="string">"Tim Cook"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"summer"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-02-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 36.00, <span class="string">"lon"</span> : -120.00&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"7"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Operating System"</span>,<span class="string">"Professor"</span> : <span class="string">"Jeniffer Anderson"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"winter"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 1, <span class="string">"submit_date"</span> : <span class="string">"2016-11-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 39.97, <span class="string">"lon"</span> : -89.78&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"8"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Algorithm"</span>,<span class="string">"Professor"</span> : <span class="string">"Tim Cook"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 80,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-10-22"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 39.97, <span class="string">"lon"</span> : -89.78&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"9"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Data Structure"</span>,<span class="string">"Professor"</span> : <span class="string">"Tim Cook"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"winter"</span>],<span class="string">"student_count"</span> : 50,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-07-22"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 39.97, <span class="string">"lon"</span> : -89.78&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"10"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Computer Graphic"</span>,<span class="string">"Professor"</span> : <span class="string">"Jeniffer Anderson"</span>,<span class="string">"major"</span> : <span class="string">"Computer Science"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>],<span class="string">"student_count"</span> : 60,<span class="string">"unit"</span> : 2,<span class="string">"rating"</span> : 3, <span class="string">"submit_date"</span> : <span class="string">"2016-11-12"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 39.97, <span class="string">"lon"</span> : -89.78&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"11"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Music Fundamental"</span>,<span class="string">"Professor"</span> : <span class="string">"Jay Z"</span>,<span class="string">"major"</span> : <span class="string">"Music"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 100,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 5, <span class="string">"submit_date"</span> : <span class="string">"2016-05-22"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.51, <span class="string">"lon"</span> : -74.83&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"12"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Vocal Techniques"</span>,<span class="string">"Professor"</span> : <span class="string">"Beyonce"</span>,<span class="string">"major"</span> : <span class="string">"Music"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 5, <span class="string">"submit_date"</span> : <span class="string">"2016-11-22"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.51, <span class="string">"lon"</span> : -74.83&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"13"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Guitar Techiniques"</span>,<span class="string">"Professor"</span> : <span class="string">"Eric Clapton"</span>,<span class="string">"major"</span> : <span class="string">"Music"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>, <span class="string">"fall"</span>],<span class="string">"student_count"</span> : 20,<span class="string">"unit"</span> : 2,<span class="string">"rating"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"2016-03-12"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.51, <span class="string">"lon"</span> : -74.83&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"14"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Finance"</span>,<span class="string">"Professor"</span> : <span class="string">"Bill Gates"</span>,<span class="string">"major"</span> : <span class="string">"Accounting"</span>,<span class="string">"semester"</span> : [<span class="string">"winter"</span>],<span class="string">"student_count"</span> : 50,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-01-12"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.51, <span class="string">"lon"</span> : -74.83&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"15"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Marketing"</span>,<span class="string">"Professor"</span> : <span class="string">"Bill Gates"</span>,<span class="string">"major"</span> : <span class="string">"Accounting"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>],<span class="string">"student_count"</span> : 60,<span class="string">"unit"</span> : 2,<span class="string">"rating"</span> : 3, <span class="string">"submit_date"</span> : <span class="string">"2016-01-22"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.51, <span class="string">"lon"</span> : -74.83&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"16"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Accounting Information Systems"</span>,<span class="string">"Professor"</span> : <span class="string">"Tom Cruise"</span>,<span class="string">"major"</span> : <span class="string">"Accounting"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 100,<span class="string">"unit"</span> : 2,<span class="string">"rating"</span> : 1, <span class="string">"submit_date"</span> : <span class="string">"2016-11-12"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.51, <span class="string">"lon"</span> : -74.83&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"17"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Individual Taxation"</span>,<span class="string">"Professor"</span> : <span class="string">"Tom Cruise"</span>,<span class="string">"major"</span> : <span class="string">"Accounting"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 1,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-08-02"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.32, <span class="string">"lon"</span> : -94.74&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"18"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Auditing"</span>,<span class="string">"Professor"</span> : <span class="string">"Victoria Park"</span>,<span class="string">"major"</span> : <span class="string">"Accounting"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>, <span class="string">"fall"</span>],<span class="string">"student_count"</span> : 20,<span class="string">"unit"</span> : 2,<span class="string">"rating"</span> : 3, <span class="string">"submit_date"</span> : <span class="string">"2016-09-13"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.32, <span class="string">"lon"</span> : -94.74&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"19"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Cell Biology"</span>,<span class="string">"Professor"</span> : <span class="string">"Anjella Kim"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 40,<span class="string">"unit"</span> : 5,<span class="string">"rating"</span> : 5, <span class="string">"submit_date"</span> : <span class="string">"2016-02-22"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 42.32, <span class="string">"lon"</span> : -94.74&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"20"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Physiology"</span>,<span class="string">"Professor"</span> : <span class="string">"Jack Berk"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"summer"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 5,<span class="string">"rating"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"2016-11-12"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 32.69, <span class="string">"lon"</span> : -99.44&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"21"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Neuroscience"</span>,<span class="string">"Professor"</span> : <span class="string">"Jihee Yang"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>, <span class="string">"fall"</span>],<span class="string">"student_count"</span> : 20,<span class="string">"unit"</span> : 5,<span class="string">"rating"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"2016-06-03"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 32.69, <span class="string">"lon"</span> : -99.44&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"22"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Immunology"</span>,<span class="string">"Professor"</span> : <span class="string">"Meredith Lee"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"winter"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 2, <span class="string">"submit_date"</span> : <span class="string">"2016-06-21"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 32.69, <span class="string">"lon"</span> : -99.44&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"23"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Genetics"</span>,<span class="string">"Professor"</span> : <span class="string">"David Pollack"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"spring"</span>],<span class="string">"student_count"</span> : 20,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 3, <span class="string">"submit_date"</span> : <span class="string">"2016-06-30"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 28.22, <span class="string">"lon"</span> : -81.87&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"24"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Biochemistry"</span>,<span class="string">"Professor"</span> : <span class="string">"John Miller"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 3,<span class="string">"rating"</span> : 4, <span class="string">"submit_date"</span> : <span class="string">"2016-01-11"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 28.22, <span class="string">"lon"</span> : -81.87&#125;&#125;</span><br><span class="line">&#123; <span class="string">"index"</span> : &#123; <span class="string">"_index"</span> : <span class="string">"classes"</span>, <span class="string">"_type"</span> : <span class="string">"class"</span>, <span class="string">"_id"</span> : <span class="string">"25"</span> &#125; &#125;</span><br><span class="line">&#123;<span class="string">"title"</span> : <span class="string">"Anatomy"</span>,<span class="string">"Professor"</span> : <span class="string">"Tom Johnson"</span>,<span class="string">"major"</span> : <span class="string">"Medical"</span>,<span class="string">"semester"</span> : [<span class="string">"fall"</span>],<span class="string">"student_count"</span> : 30,<span class="string">"unit"</span> : 5,<span class="string">"rating"</span> : 3, <span class="string">"submit_date"</span> : <span class="string">"2016-11-12"</span>, <span class="string">"school_location"</span> : &#123;<span class="string">"lat"</span> : 28.22, <span class="string">"lon"</span> : -81.87&#125;&#125;</span><br></pre></td></tr></table></figure><p>Bulk 파일을 보면 Meta Information의 형식으로 가지고 있습니다.</p><blockquote><p>Bulk를 사용하여 값들을 Document에 삽입해보도록 하겠습니다.</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type:application/json'</span> http://localhost:9200/_bulk/\?pretty --data-binary @classes.json</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"took"</span> : 591,</span><br><span class="line">  <span class="string">"errors"</span> : <span class="literal">false</span>,</span><br><span class="line">  <span class="string">"items"</span> : [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 7,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"updated"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 6,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 200</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"2"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 7,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"3"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 8,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"5"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 9,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"6"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 10,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"7"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 11,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"8"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 12,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"9"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 13,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"10"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 14,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"11"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 15,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"12"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 16,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"13"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 17,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"14"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 18,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"15"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 19,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"16"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 20,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"17"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 21,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"18"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 22,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"19"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 23,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"20"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 24,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"21"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 25,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"22"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 26,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"23"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 27,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"24"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 28,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="string">"index"</span> : &#123;</span><br><span class="line">        <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">        <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">        <span class="string">"_id"</span> : <span class="string">"25"</span>,</span><br><span class="line">        <span class="string">"_version"</span> : 1,</span><br><span class="line">        <span class="string">"result"</span> : <span class="string">"created"</span>,</span><br><span class="line">        <span class="string">"_shards"</span> : &#123;</span><br><span class="line">          <span class="string">"total"</span> : 2,</span><br><span class="line">          <span class="string">"successful"</span> : 1,</span><br><span class="line">          <span class="string">"failed"</span> : 0</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">"_seq_no"</span> : 29,</span><br><span class="line">        <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">        <span class="string">"status"</span> : 201</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같은형식으로 bulk파일들이 정상적으로 document에 들어간것을 확인할 수 있습니다</p><blockquote><p>Bulk Document 조회</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET localhost:9200/classes/class/1\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">  <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">  <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">  <span class="string">"_version"</span> : 7,</span><br><span class="line">  <span class="string">"_seq_no"</span> : 6,</span><br><span class="line">  <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">  <span class="string">"found"</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"_source"</span> : &#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Machine Learning"</span>,</span><br><span class="line">    <span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,</span><br><span class="line">    <span class="string">"major"</span> : <span class="string">"Computer Science"</span>,</span><br><span class="line">    <span class="string">"semester"</span> : [</span><br><span class="line">      <span class="string">"spring"</span>,</span><br><span class="line">      <span class="string">"fall"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"student_count"</span> : 100,</span><br><span class="line">    <span class="string">"unit"</span> : 3,</span><br><span class="line">    <span class="string">"rating"</span> : 5,</span><br><span class="line">    <span class="string">"submit_date"</span> : <span class="string">"2016-01-02"</span>,</span><br><span class="line">    <span class="string">"school_location"</span> : &#123;</span><br><span class="line">      <span class="string">"lat"</span> : 36.0,</span><br><span class="line">      <span class="string">"lon"</span> : -120.0</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 첫번째에 들어있는 document값을 정상적으로 조회한것을 확인할 수 있습니다.<br>여기서 주의할점은 pretty연산을 진행하기전에 앞에 \를 붙여실행해야 정상적으로 원하는 결과를 볼 수 있습니다.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;elk-elraseutigseoci-bulk&quot;&gt;&lt;a href=&quot;#elk-elraseutigseoci-bulk&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#elk-엘
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
      <category term="BULK" scheme="http://gwanhyeon.github.io/tags/bulk/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱서치 Data CRUD</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-crud/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-crud/</id>
    <published>2021-02-19T04:18:53.000Z</published>
    <updated>2021-02-19T08:13:15.888Z</updated>
    
    <content type="html"><![CDATA[<h1 id="elraseutigseoci-deiteo-ibryeog-johoe-sagje-get-post-put-delete"><a href="#elraseutigseoci-deiteo-ibryeog-johoe-sagje-get-post-put-delete" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#엘라스틱서치-데이터-입력-조회-삭제-get-post-put-delete"></a> 엘라스틱서치 데이터 입력 조회 삭제 (GET, POST, PUT, DELETE)</h1><p>이번 시간에 살펴볼 내용은 엘라스틱서치에서 Data CRUD를 실습해보는 시간을 가져보겠습니다.</p><p>그전에 엘라스틱서피와 RDS와의 차이점을 살펴보겠습니다.</p><blockquote><p>ELASTIC SEARCH VS RDS</p></blockquote><table><thead><tr><th>Elastic Search</th><th style="text-align:center">RDS</th></tr></thead><tbody><tr><td><code>Index</code></td><td style="text-align:center">Database</td></tr><tr><td><code>Type</code></td><td style="text-align:center">Table</td></tr><tr><td><code>Document</code></td><td style="text-align:center">Row</td></tr><tr><td><code>Field</code></td><td style="text-align:center">Column</td></tr><tr><td><code>Mapping</code></td><td style="text-align:center">Schema</td></tr></tbody></table><p>엘라스틱서치에서는 REST API를 사용합니다.</p><table><thead><tr><th>Elastic Search</th><th style="text-align:center">RDS</th><th style="text-align:center">CRUD</th></tr></thead><tbody><tr><td><code>GET</code></td><td style="text-align:center">Select</td><td style="text-align:center">Read</td></tr><tr><td><code>PUT</code></td><td style="text-align:center">Update</td><td style="text-align:center">Update</td></tr><tr><td><code>POST</code></td><td style="text-align:center">Insert</td><td style="text-align:center">Create</td></tr><tr><td><code>DELETE</code></td><td style="text-align:center">Delete</td><td style="text-align:center">Delete</td></tr></tbody></table><p>다음과 같이 표를 보면 CRUD의 역할과 동일하게 처리한다라고 생각을 하면됩니다.</p><blockquote><p>GET 조회시</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://localhost:9200/classes</span><br><span class="line">&#123;<span class="string">"error"</span>:&#123;<span class="string">"root_cause"</span>:[&#123;<span class="string">"type"</span>:<span class="string">"index_not_found_exception"</span>,<span class="string">"reason"</span>:<span class="string">"no such index [classes]"</span>,<span class="string">"resource.type"</span>:<span class="string">"index_or_alias"</span>,<span class="string">"resource.id"</span>:<span class="string">"classes"</span>,<span class="string">"index_uuid"</span>:<span class="string">"_na_"</span>,<span class="string">"index"</span>:<span class="string">"classes"</span>&#125;],<span class="string">"type"</span>:<span class="string">"index_not_found_exception"</span>,<span class="string">"reason"</span>:<span class="string">"no such index [classes]"</span>,<span class="string">"resource.type"</span>:<span class="string">"index_or_alias"</span>,<span class="string">"resource.id"</span>:<span class="string">"classes"</span>,<span class="string">"index_uuid"</span>:<span class="string">"_na_"</span>,<span class="string">"index"</span>:<span class="string">"classes"</span>&#125;,<span class="string">"status"</span>:404&#125;%</span><br></pre></td></tr></table></figure><p>curl의 -XGET 옵션을 통하여 엘라스틱서치의 9200번 포트로 접근해줍니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://localhost:9200/classes</span><br><span class="line"></span><br><span class="line">http://localhost:9200 - 엘라스틱서치 주소</span><br><span class="line">classes - Index</span><br></pre></td></tr></table></figure><blockquote><p>GET 조회시 깔끔하게 보고싶다면?</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://localhost:9200/classe\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"error"</span> : &#123;</span><br><span class="line">    <span class="string">"root_cause"</span> : [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"type"</span> : <span class="string">"index_not_found_exception"</span>,</span><br><span class="line">        <span class="string">"reason"</span> : <span class="string">"no such index [classe]"</span>,</span><br><span class="line">        <span class="string">"resource.type"</span> : <span class="string">"index_or_alias"</span>,</span><br><span class="line">        <span class="string">"resource.id"</span> : <span class="string">"classe"</span>,</span><br><span class="line">        <span class="string">"index_uuid"</span> : <span class="string">"_na_"</span>,</span><br><span class="line">        <span class="string">"index"</span> : <span class="string">"classe"</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"type"</span> : <span class="string">"index_not_found_exception"</span>,</span><br><span class="line">    <span class="string">"reason"</span> : <span class="string">"no such index [classe]"</span>,</span><br><span class="line">    <span class="string">"resource.type"</span> : <span class="string">"index_or_alias"</span>,</span><br><span class="line">    <span class="string">"resource.id"</span> : <span class="string">"classe"</span>,</span><br><span class="line">    <span class="string">"index_uuid"</span> : <span class="string">"_na_"</span>,</span><br><span class="line">    <span class="string">"index"</span> : <span class="string">"classe"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"status"</span> : 404</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 JSON 포멧으로 깔끔하게 결과값들을 확인할 수 있습니다.</p><blockquote><p>인덱스 생성 PUT</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$curl</span> -XPUT http://localhost:9200/classes</span><br><span class="line">&#123;<span class="string">"acknowledged"</span>:<span class="literal">true</span>,<span class="string">"shards_acknowledged"</span>:<span class="literal">true</span>,<span class="string">"index"</span>:<span class="string">"classes"</span>&#125;%</span><br></pre></td></tr></table></figure><p>다음과 같이 인덱스가 정상적으로 생성된것을 확인할 수 있습니다.</p><blockquote><p>인덱스 삭제 DELETE</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XDELETE http://localhost:9200/classes</span><br><span class="line">&#123;<span class="string">"acknowledged"</span>:<span class="literal">true</span>&#125;%</span><br></pre></td></tr></table></figure><p>다음과 같이 정상적으로 엘라스틱서치의 인덱스값이 삭제된것을 확인할 수 있습니다.</p><blockquote><p>Document 생성하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type: application/json'</span> http://localhost:9200/classes/class/1/ -d <span class="string">'&#123;"title" : "Algorithm", "professor" : "John"&#125;'</span></span><br><span class="line">&#123;<span class="string">"_index"</span>:<span class="string">"classes"</span>,<span class="string">"_type"</span>:<span class="string">"class"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:1,<span class="string">"result"</span>:<span class="string">"created"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:0,<span class="string">"_primary_term"</span>:1&#125;%</span><br></pre></td></tr></table></figure><p><strong>주의사항</strong><br>curl -XPOSt <a href="http://localhost:9200/classes/class/1/" target="_blank" rel="noopener">http://localhost:9200/classes/class/1/</a> -d ‘{“title” : “Algorithm”, “professor” : “John”}’ 입력 시 www-form-urlencoded is not supported status 406 에러가 발생합니다. 높은 버전에선 -H ‘Content-Type: application/json’ 를 사용해주어야합니다.</p><blockquote><p>참고링크<br><a href="https://www.elastic.co/kr/blog/strict-content-type-checking-for-elasticsearch-rest-requests" target="_blank" rel="noopener">https://www.elastic.co/kr/blog/strict-content-type-checking-for-elasticsearch-rest-requests</a></p></blockquote><p><strong>Starting from Elasticsearch 6.0, all REST requests that include a body must also provide the correct content-type for that body.</strong></p><blockquote><p>Document 생성된것 확인하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$curl</span> -XGET http://localhost:9200/classes/class/1/\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">  <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">  <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">  <span class="string">"_version"</span> : 1,</span><br><span class="line">  <span class="string">"_seq_no"</span> : 0,</span><br><span class="line">  <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">  <span class="string">"found"</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"_source"</span> : &#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Algorithm"</span>,</span><br><span class="line">    <span class="string">"professor"</span> : <span class="string">"John"</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>파일을 사용하여 Document 생성하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type: application/json'</span> http://localhost:9200/classes/class/1/ -d @class.json</span><br><span class="line">&#123;<span class="string">"_index"</span>:<span class="string">"classes"</span>,<span class="string">"_type"</span>:<span class="string">"class"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:2,<span class="string">"result"</span>:<span class="string">"updated"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:1,<span class="string">"_primary_term"</span>:1&#125;%</span><br></pre></td></tr></table></figure><p>@기호를 사용하여 class.json 파일안에 있는 json 데이터를 통하여 Document를 생성하였습니다. JSON내용은 다음과같습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Machine Learning"</span>,</span><br><span class="line">    <span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,</span><br><span class="line">    <span class="string">"major"</span> : <span class="string">"Computer Science"</span>,</span><br><span class="line">    <span class="string">"semester"</span> : [<span class="string">"spring"</span>, <span class="string">"fall"</span>],</span><br><span class="line">    <span class="string">"student_count"</span> : 100,</span><br><span class="line">    <span class="string">"unit"</span> : 3,</span><br><span class="line">    <span class="string">"rating"</span> : 5</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Document 조회해보기</p></blockquote><p>이제 정상적으로 파일에서 가져온 Document값을 조회해보도록 하겠습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://localhost:9200/classes/class/1/\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">  <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">  <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">  <span class="string">"_version"</span> : 2,</span><br><span class="line">  <span class="string">"_seq_no"</span> : 1,</span><br><span class="line">  <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">  <span class="string">"found"</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"_source"</span> : &#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Machine Learning"</span>,</span><br><span class="line">    <span class="string">"Professor"</span> : <span class="string">"Minsuk Heo"</span>,</span><br><span class="line">    <span class="string">"major"</span> : <span class="string">"Computer Science"</span>,</span><br><span class="line">    <span class="string">"semester"</span> : [</span><br><span class="line">      <span class="string">"spring"</span>,</span><br><span class="line">      <span class="string">"fall"</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="string">"student_count"</span> : 100,</span><br><span class="line">    <span class="string">"unit"</span> : 3,</span><br><span class="line">    <span class="string">"rating"</span> : 5</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>이렇게 정상적으로 파일에 들어가있는 값들을 통하여 document로 정상적으로 구성되었습니다.</p><blockquote><p>Data Update</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl -XPOST -H <span class="string">'Content-Type:application/json'</span> http://localhost:9200/classes/class/1/_update -d <span class="string">'</span></span><br><span class="line"><span class="string">&#123;"doc":&#123;"unit":1&#125;&#125;'</span></span><br><span class="line">&#123;<span class="string">"_index"</span>:<span class="string">"classes"</span>,<span class="string">"_type"</span>:<span class="string">"class"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:4,<span class="string">"result"</span>:<span class="string">"noop"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:0,<span class="string">"successful"</span>:0,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:3,<span class="string">"_primary_term"</span>:1&#125;%</span><br></pre></td></tr></table></figure><p>_update를 뒤에 붙여주면서 진행을 하면 해당 unit값이 업데이트된것을 확인할 수 있습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET http://localhost:9200/classes/class/1\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">  <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">  <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">  <span class="string">"_version"</span> : 5,</span><br><span class="line">  <span class="string">"_seq_no"</span> : 4,</span><br><span class="line">  <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">  <span class="string">"found"</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"_source"</span> : &#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Algorithm"</span>,</span><br><span class="line">    <span class="string">"professor"</span> : <span class="string">"John"</span>,</span><br><span class="line">    <span class="string">"unit"</span> : 2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>script를 이용하여 업데이트하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$curl</span> -XPOST -H <span class="string">'Content-Type:application/json'</span> http://localhost:9200/classes/class/1/_update -d <span class="string">'</span></span><br><span class="line"><span class="string">quote&gt; &#123;"script":"ctx._source.unit += 5"&#125; '</span></span><br><span class="line">&#123;<span class="string">"_index"</span>:<span class="string">"classes"</span>,<span class="string">"_type"</span>:<span class="string">"class"</span>,<span class="string">"_id"</span>:<span class="string">"1"</span>,<span class="string">"_version"</span>:6,<span class="string">"result"</span>:<span class="string">"updated"</span>,<span class="string">"_shards"</span>:&#123;<span class="string">"total"</span>:2,<span class="string">"successful"</span>:1,<span class="string">"failed"</span>:0&#125;,<span class="string">"_seq_no"</span>:5,<span class="string">"_primary_term"</span>:1&#125;%</span><br><span class="line"> kgh  ~</span><br><span class="line"> </span><br><span class="line"><span class="variable">$curl</span> -XGET http://localhost:9200/classes/class/1\?pretty</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"_index"</span> : <span class="string">"classes"</span>,</span><br><span class="line">  <span class="string">"_type"</span> : <span class="string">"class"</span>,</span><br><span class="line">  <span class="string">"_id"</span> : <span class="string">"1"</span>,</span><br><span class="line">  <span class="string">"_version"</span> : 6,</span><br><span class="line">  <span class="string">"_seq_no"</span> : 5,</span><br><span class="line">  <span class="string">"_primary_term"</span> : 1,</span><br><span class="line">  <span class="string">"found"</span> : <span class="literal">true</span>,</span><br><span class="line">  <span class="string">"_source"</span> : &#123;</span><br><span class="line">    <span class="string">"title"</span> : <span class="string">"Algorithm"</span>,</span><br><span class="line">    <span class="string">"professor"</span> : <span class="string">"John"</span>,</span><br><span class="line">    <span class="string">"unit"</span> : 7</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>{“script”:“ctx._source.unit += 5”} 과 같이 script문을 사용하면 다음과같이 정상적으로 데이터가 업데이트를 쉽게 처리할 수 있습니다.</p><blockquote><p>Reference</p></blockquote><p><a href="https://github.com/minsuk-heo/BigData" target="_blank" rel="noopener">https://github.com/minsuk-heo/BigData</a></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;elraseutigseoci-deiteo-ibryeog-johoe-sagje-get-post-put-delete&quot;&gt;&lt;a href=&quot;#elraseutigseoci-deiteo-ibryeog-johoe-sagje-get-post-put-de
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
      <category term="CRUD" scheme="http://gwanhyeon.github.io/tags/crud/"/>
    
  </entry>
  
  <entry>
    <title>ELK 엘라스틱서치 정의 및 설치하기</title>
    <link href="http://gwanhyeon.github.io/ELK-20210219-elk-install/"/>
    <id>http://gwanhyeon.github.io/ELK-20210219-elk-install/</id>
    <published>2021-02-19T02:43:32.000Z</published>
    <updated>2021-02-19T04:42:14.020Z</updated>
    
    <content type="html"><![CDATA[<h1 id="homebrew"><a href="#homebrew" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#homebrew"></a> Homebrew</h1><p>Homebrew는 자유-오픈 소스 소프트웨어 패키지 관리 시스템의 하나로서 애플의 macOS 운영 체제의 소프트웨어 설치를 단순하게 만들어준다. 원래 맥스 호웰(Max Howell)이 개발한 이 패키지 관리자는 루비 온 웨일즈 공동체에서 인기를 얻었으며 확장성으로 호평을 받았습니다.홈브루는 쉬운 사용성, 명령 줄로의 통합이 가능하므로 이용이 권장됩니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$/bin/bash -c <span class="string">"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install.sh)"</span></span><br></pre></td></tr></table></figure><p>Homebrew를 이용하기 위해 설치를 진행해줍니다.</p><h1 id="elkran"><a href="#elkran" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#elk란"></a> ELK란?</h1><h2 id="elasticsearch"><a href="#elasticsearch" class="header-anchor">2.1. </a><a class="markdownIt-Anchor" href="#elasticsearch"></a> ElasticSearch</h2><ul><li>ElasticSearch는 Lucene 기반으로 개발한 분산 검색엔진으로, Logstash를 통해 수신된 데이터를 저장소에 저장하는 역할을 담당합니다.</li><li>데이터를 중심부에 저장하여 예상되는 항목을 검색하고 예상치 못한 항목을 찾아낼 수 있습니다.</li><li>정형, 비정형, 위치정보, 메트릭 등 원하는 방법으로 다양한 유형의 검색을 수행하고 결합할 수 있습니다.</li></ul><h2 id="logstash"><a href="#logstash" class="header-anchor">2.2. </a><a class="markdownIt-Anchor" href="#logstash"></a> Logstash</h2><ul><li>오픈소스 서버측 데이터 처리 파이프라인으로, 다양한 소스에서 동시에 데이터를 수집하고 변환하여 stash 보관소로 보내는 역할을 합니다.</li><li>수집할 로그를 선정해서, 지정된 대상 서버(ElasticSearch)에 인덱싱하여 전송하는 역할을 담당하는 소프트웨어입니다.</li></ul><h2 id="kibana"><a href="#kibana" class="header-anchor">2.3. </a><a class="markdownIt-Anchor" href="#kibana"></a> Kibana</h2><ul><li>데이터를 시각적으로 탐색하고 실시간으로 분석 할 수 있습니다.</li><li>시각화를 담당하는 HTML와 Javascript 엔진입니다.</li></ul><h1 id="elastic-seolcihagi"><a href="#elastic-seolcihagi" class="header-anchor">3. </a><a class="markdownIt-Anchor" href="#elastic-설치하기"></a> Elastic 설치하기</h1><blockquote><p>설치전 이슈</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$brew</span> tap elastic/tap</span><br><span class="line">Error:</span><br><span class="line">  homebrew-core is a shallow <span class="built_in">clone</span>.</span><br><span class="line">To `brew update`, first run:</span><br><span class="line">  git -C /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow</span><br><span class="line">This restriction has been made on GitHub<span class="string">'s request because updating shallow</span></span><br><span class="line"><span class="string">clones is an extremely expensive operation due to the tree layout and traffic of</span></span><br><span class="line"><span class="string">Homebrew/homebrew-core and Homebrew/homebrew-cask. We don'</span>t <span class="keyword">do</span> this <span class="keyword">for</span> you</span><br><span class="line">automatically to avoid repeatedly performing an expensive unshallow operation <span class="keyword">in</span></span><br><span class="line">CI systems (<span class="built_in">which</span> should instead be fixed to not use shallow clones). Sorry <span class="keyword">for</span></span><br><span class="line">the inconvenience!</span><br><span class="line">==&gt; Tapping elastic/tap</span><br><span class="line">Cloning into <span class="string">'/usr/local/Homebrew/Library/Taps/elastic/homebrew-tap'</span>...</span><br><span class="line">remote: Enumerating objects: 32, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (32/32), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (29/29), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 791 (delta 15), reused 8 (delta 3), pack-reused 759</span><br><span class="line">Receiving objects: 100% (791/791), 181.90 KiB | 432.00 KiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (601/601), <span class="keyword">done</span>.</span><br><span class="line">Tapped 17 formulae (44 files, 289.5KB).</span><br></pre></td></tr></table></figure><p>ELK를 설치하는데 있어서 해당오류가 발생하여 다음과 같이 해결을 진행하였습니다. 업데이트가 제대로 진행이 되지 않아 homebrew core를 업데이트를 진행하였습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$brew</span> update</span><br><span class="line">Error:</span><br><span class="line">  homebrew-core is a shallow <span class="built_in">clone</span>.</span><br><span class="line">To `brew update`, first run:</span><br><span class="line">  git -C /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/homebrew-core fetch --unshallow</span><br><span class="line">This restriction has been made on GitHub<span class="string">'s request because updating shallow</span></span><br><span class="line"><span class="string">clones is an extremely expensive operation due to the tree layout and traffic of</span></span><br><span class="line"><span class="string">Homebrew/homebrew-core and Homebrew/homebrew-cask. We don'</span>t <span class="keyword">do</span> this <span class="keyword">for</span> you</span><br><span class="line">automatically to avoid repeatedly performing an expensive unshallow operation <span class="keyword">in</span></span><br><span class="line">CI systems (<span class="built_in">which</span> should instead be fixed to not use shallow clones). Sorry <span class="keyword">for</span></span><br></pre></td></tr></table></figure><p>Homebrew를 업데이트를 진행하려고하였지만, 역시나 같은오류가 발생하여 Stackoverflow의 힘을 빌리게 되었습니다.<br><a href="https://stackoverflow.com/questions/65160625/cant-update-or-upgrade-homebrew" target="_blank" rel="noopener">https://stackoverflow.com/questions/65160625/cant-update-or-upgrade-homebrew</a></p><blockquote><p>homebrew core update</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/</span><br><span class="line">rm -rf homebrew-core</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Homebrew/homebrew-core.git</span><br></pre></td></tr></table></figure><p>다음과 같은 명령어로 현재 Homebrew 라이브러리안에 있는 탭볼륨의 코어를 삭제후 다시 설치를 진행하였습니다.</p><blockquote><p>Elastic 설치하기</p></blockquote><p>이제 본격적으로 ELK설치를 진행하겠습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew/</span><br><span class="line">rm -rf homebrew-core</span><br><span class="line">git <span class="built_in">clone</span> https://github.com/Homebrew/homebrew-core.git</span><br><span class="line">Cloning into <span class="string">'homebrew-core'</span>...</span><br><span class="line">remote: Enumerating objects: 34, <span class="keyword">done</span>.</span><br><span class="line">remote: Counting objects: 100% (34/34), <span class="keyword">done</span>.</span><br><span class="line">remote: Compressing objects: 100% (24/24), <span class="keyword">done</span>.</span><br><span class="line">remote: Total 910921 (delta 19), reused 19 (delta 10), pack-reused 910887</span><br><span class="line">Receiving objects: 100% (910921/910921), 364.35 MiB | 8.72 MiB/s, <span class="keyword">done</span>.</span><br><span class="line">Resolving deltas: 100% (620824/620824), <span class="keyword">done</span>.</span><br><span class="line">Updating files: 100% (5773/5773), <span class="keyword">done</span>.</span><br><span class="line"> kgh  /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/homebrew   stable</span><br><span class="line"><span class="variable">$brew</span> tap elastic/tap</span><br><span class="line">Updating Homebrew...</span><br><span class="line">To restore the stashed changes to /usr/<span class="built_in">local</span>/Homebrew/Library/Taps/adoptopenjdk/homebrew-openjdk run:</span><br><span class="line">  <span class="string">'cd /usr/local/Homebrew/Library/Taps/adoptopenjdk/homebrew-openjdk &amp;&amp; git stash pop'</span></span><br><span class="line">==&gt; Auto-updated Homebrew!</span><br><span class="line">Updated 3 taps (homebrew/cask, homebrew/services and adoptopenjdk/openjdk).</span><br><span class="line">==&gt; New Casks</span><br><span class="line">accordance                             forticlient-vpn                        mubu                                   spotter</span><br><span class="line">aldente                                fspy                                   munkiadmin                             start</span><br><span class="line">astah-uml                              gather                                 opgg                                   stringz</span><br><span class="line">atemosc                                gdat                                   oss-browser                            textbuddy</span><br><span class="line">audiogridder-plugin                    google-drive                           parsify                                the-unofficial-homestuck-collection</span><br><span class="line">audiogridder-server                    grid                                   pathephone                             twobird</span><br><span class="line">bleunlock                              helo                                   pibar                                  ultdata</span><br><span class="line">brewlet                                imdone                                 pokemon-trading-card-game-online       unclack</span><br><span class="line">cakebrewjs                             imobie-m1-app-checker                  pragli                                 vine-server</span><br><span class="line">cinco                                  intellidock                            prezi-video                            vofa-plus</span><br><span class="line">colorwell                              kieler                                 ptpwebcam                              webull</span><br><span class="line">curseforge                             kiwi-for-gmail                         ray                                    wolfram-engine</span><br><span class="line">deadbeef                               lightform                              raycast                                xcodes</span><br><span class="line">decloner                               lightkey                               sengi                                  xournal-plus-plus</span><br><span class="line">deskreen                               little-navmap                          signet                                 yesplaymusic</span><br><span class="line">digital                                macfuse                                sitesucker-pro                         zy-player</span><br><span class="line">duckstation                            mathinspector                          slippi-dolphin</span><br><span class="line">f-bar                                  melonds                                space-saver</span><br><span class="line">fawkes                                 miniforge                              spaceman</span><br><span class="line">==&gt; Updated Casks</span><br><span class="line">Updated 1352 casks.</span><br><span class="line">==&gt; Deleted Casks</span><br><span class="line">archi                     clashxr                   facebook-ios-sdk          jeromelebel-mongohub      racket-cs                 tagalicious</span><br><span class="line">arrayfire                 disablemonitor            google-hangouts           oni                       ringtones                 teamspeak-client</span><br><span class="line">barxtemp                  evom                      irip                      project-slippi-dolphin    ripit                     yyets</span><br></pre></td></tr></table></figure><p>Homebrew 코어를 업데이트를 진행한 후 <code>$brew tap elastic/tap</code> 과 같은 명령어로 볼륨 설치를 완료하게 되었습니다.<br>그리고 이제 elastic을 설치해보겠습니다</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">brew install elasticsearch-full</span><br><span class="line">Updating Homebrew...</span><br><span class="line">==&gt; Auto-updated Homebrew!</span><br><span class="line">Updated 1 tap (homebrew/core).</span><br><span class="line">==&gt; Updated Formulae</span><br><span class="line">Updated 2 formulae.</span><br><span class="line"></span><br><span class="line">Warning: elasticsearch has been deprecated because it is switching to an incompatible license!</span><br><span class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/elasticsearch-7.10.2.cat</span><br><span class="line">==&gt; Downloading from https://d29vzk4ow07wi7.cloudfront.net/6bb47c36590116e78d</span><br><span class="line"><span class="comment">#=#=#                                                                        ##O#- #                                                                      ##O=#  #                                                                                                                                                0.                                                                           0.                                                                           0.                                                                           0.                                                                           0.                                                                           0.                                                                           1.#                                                                          1.#                                                                          1.#                                                                          2.##                                                                         3.###                                                                        4.###                                                                        5.####                                                                       6.#####                                                                      7.######                                                                     8.#######                                                                   11.########                                                                  12.#########                                                                 13.##########                                                                15.###########                                                               16.############                                                              17.##############                                                            19.###############                                                           21.################                                                          22.#################                                                         24.##################                                                        25.###################                                                       27.####################                                                      29.#####################                                                     30.#######################                                                   32.########################                                                  34.#########################                                                 35.##########################                                                36.###########################                                               38.############################                                              40.#############################                                             41.##############################                                            42.################################                                          44.#################################                                         46.##################################                                        47.##################################                                        48.####################################                                      51.#####################################                                     52.#####################################                                     52.######################################                                    53.########################################                                  56.########################################                                  56.#########################################                                 57.##########################################                                59.############################################                              61.#############################################                             63.##############################################                            64.###############################################                           65.################################################                          66.#################################################                         68.##################################################                        69.##################################################                        70.###################################################                       71.####################################################                      73.####################################################                      73.#####################################################                     74.#######################################################                   76.########################################################                  78.########################################################                  78.##########################################################                81.###########################################################               82.############################################################              84.#############################################################             86.###############################################################           87.################################################################          88.#################################################################         90.##################################################################        92.####################################################################      94.#####################################################################     96.#####################################################################     97.#######################################################################   98.######################################################################## 100.0%</span></span><br><span class="line">==&gt; Pouring elasticsearch-7.10.2.catalina.bottle.tar.gz</span><br><span class="line">==&gt; /usr/<span class="built_in">local</span>/Cellar/elasticsearch/7.10.2/bin/elasticsearch-keystore create</span><br><span class="line">==&gt; Caveats</span><br><span class="line">Data:    /usr/<span class="built_in">local</span>/var/lib/elasticsearch/</span><br><span class="line">Logs:    /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/elasticsearch/elasticsearch_kgh.log</span><br><span class="line">Plugins: /usr/<span class="built_in">local</span>/var/elasticsearch/plugins/</span><br><span class="line">Config:  /usr/<span class="built_in">local</span>/etc/elasticsearch/</span><br><span class="line"></span><br><span class="line">To have launchd start elasticsearch now and restart at login:</span><br><span class="line"> brew services start elasticsearch</span><br><span class="line">Or, <span class="keyword">if</span> you don<span class="string">'t want/need a background service you can just run:</span></span><br><span class="line"><span class="string"> elasticsearch</span></span><br><span class="line"><span class="string">==&gt; Summary</span></span><br><span class="line"><span class="string">🍺  /usr/local/Cellar/elasticsearch/7.10.2: 156 files, 113.5MB</span></span><br></pre></td></tr></table></figure><h1 id="kibana-seolcihagi"><a href="#kibana-seolcihagi" class="header-anchor">4. </a><a class="markdownIt-Anchor" href="#kibana-설치하기"></a> Kibana 설치하기</h1><p>다음과 같은 명령어로 Kibana설치를 진행합니다</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">brew install elastic/tap/kibana(full을 사용하지않으면 최신화적인 elasticsearch와의 버전문제가 생길 가능성이 있습니다.) 사용 X</span><br><span class="line"></span><br><span class="line">brew install elastic/tap/kibana-full(사용O)</span><br><span class="line">Updating Homebrew...</span><br><span class="line">==&gt; Auto-updated Homebrew!</span><br><span class="line">Updated 1 tap (homebrew/core).</span><br><span class="line">==&gt; Updated Formulae</span><br><span class="line">Updated 2 formulae.</span><br><span class="line"></span><br><span class="line">==&gt; Installing kibana-full from elastic/tap</span><br><span class="line">==&gt; Downloading https://artifacts.elastic.co/downloads/kibana/kibana-7.11.1-darwin-x86_64.tar.gz?tap=elastic/homebrew-tap</span><br><span class="line"><span class="comment">######################################################################## 100.0%</span></span><br><span class="line">==&gt; Caveats</span><br><span class="line">Config: /usr/<span class="built_in">local</span>/etc/kibana/</span><br><span class="line">If you wish to preserve your plugins upon upgrade, make a copy of</span><br><span class="line">/usr/<span class="built_in">local</span>/opt/kibana-full/plugins before upgrading, and copy it into the</span><br><span class="line">new keg location after upgrading.</span><br><span class="line"></span><br><span class="line">To have launchd start elastic/tap/kibana-full now and restart at login:</span><br><span class="line">  brew services start elastic/tap/kibana-full</span><br><span class="line">Or, <span class="keyword">if</span> you don<span class="string">'t want/need a background service you can just run:</span></span><br><span class="line"><span class="string">  kibana</span></span><br><span class="line"><span class="string">==&gt; Summary</span></span><br><span class="line"><span class="string">🍺  /usr/local/Cellar/kibana-full/7.11.1: 47,465 files, 655.5MB, built in 2 minutes 10 seconds</span></span><br><span class="line"><span class="string">==&gt; `brew cleanup` has not been run in 30 days, running now...</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/bdw-gc--8.0.4_1.catalina.bottle.1.tar.gz... (513KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/certbot--1.10.1.catalina.bottle.tar.gz... (7.2MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/dialog--1.3-20201126.catalina.bottle.tar.gz... (330.7KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/emacs--27.1.catalina.bottle.tar.gz... (44.3MB)</span></span><br><span class="line"><span class="string">Removing: /usr/local/Cellar/gdbm/1.18.1... (20 files, 591.2KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/gnu-getopt--2.36.1.catalina.bottle.tar.gz... (56.2KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/go--1.15.6.catalina.bottle.tar.gz... (153.9MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/groonga--10.1.0.catalina.bottle.tar.gz... (8MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/guile--3.0.4.catalina.bottle.2.tar.gz... (11.5MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/mariadb--10.5.8.catalina.bottle.2.tar.gz... (50.6MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/nettle--3.6.catalina.bottle.tar.gz... (866.6KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/nghttp2--1.42.0_1.catalina.bottle.tar.gz... (971.0KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/node--15.5.0.catalina.bottle.tar.gz... (15.1MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/openjdk--15.0.1.catalina.bottle.tar.gz... (190.9MB)</span></span><br><span class="line"><span class="string">Removing: /usr/local/Cellar/pkg-config/0.29.2... (11 files, 627.2KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/python@3.9--setuptools--51.0.0.zip... (2.0MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/python@3.9--pip--20.3.1.tar.gz... (1.5MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/python@3.9--wheel--0.36.1.tar.gz... (62.7KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/redis--6.0.9.catalina.bottle.tar.gz... (1.8MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/sphinx-doc--3.4.1.catalina.bottle.tar.gz... (15.1MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Caches/Homebrew/unbound--1.13.0.catalina.bottle.tar.gz... (2.7MB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/pkg-config... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/tree... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libtool... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/jansson... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/gmp... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/msgpack... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/augeas... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libidn2... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/nghttp2... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/go... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/nettle... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/mariadb... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/gdbm... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/gnu-getopt... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libunistring... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/jemalloc... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/bdw-gc... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/maven... (101B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/icu4c... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/certbot... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/readline... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/sqlite... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/c-ares... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/yarn... (100B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/nvm... (99B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/emacs... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/dialog... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/openjdk... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/git-flow... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/gettext... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/git-flow-avh... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/sphinx-doc... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libtasn1... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libevent... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/openssl@1.1... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/cask... (100B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/node... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/unbound... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/zsh... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/groonga... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/guile... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/p11-kit... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libev... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/protobuf... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/libffi... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/python@3.9... (2 files, 754.7KB)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/ethereum... (64B)</span></span><br><span class="line"><span class="string">Removing: /Users/kgh/Library/Logs/Homebrew/gnutls... (64B)</span></span><br><span class="line"><span class="string">Pruned 2 symbolic links and 3 directories from /usr/local</span></span><br></pre></td></tr></table></figure><h1 id="elasticsearch-silhaenghagi"><a href="#elasticsearch-silhaenghagi" class="header-anchor">5. </a><a class="markdownIt-Anchor" href="#elasticsearch-실행하기"></a> Elasticsearch 실행하기</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">elasticsearch</span><br><span class="line">warning: no-jdk distributions that <span class="keyword">do</span> not bundle a JDK are deprecated and will be removed <span class="keyword">in</span> a future release</span><br><span class="line">warning: no-jdk distributions that <span class="keyword">do</span> not bundle a JDK are deprecated and will be removed <span class="keyword">in</span> a future release</span><br><span class="line">[2021-02-19T12:05:59,584][INFO ][o.e.n.Node               ] [kgh-2.local] version[7.10.2-SNAPSHOT], pid[94450], build[oss/tar/unknown/2021-01-16T01:34:41.142971Z], OS[Mac OS X/10.15.5/x86_64], JVM[Oracle Corporation/OpenJDK 64-Bit Server VM/15.0.1/15.0.1+9]</span><br><span class="line">[2021-02-19T12:05:59,590][INFO ][o.e.n.Node               ] [kgh-2.local] JVM home [/usr/<span class="built_in">local</span>/Cellar/openjdk/15.0.1/libexec/openjdk.jdk/Contents/Home]</span><br><span class="line">[2021-02-19T12:05:59,598][INFO ][o.e.n.Node               ] [kgh-2.local] JVM arguments [-Xshare:auto, -Des.networkaddress.cache.ttl=60, -Des.networkaddress.cache.negative.ttl=10, -XX:+AlwaysPreTouch, -Xss1m, -Djava.awt.headless=<span class="literal">true</span>, -Dfile.encoding=UTF-8, -Djna.nosys=<span class="literal">true</span>, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, -Dio.netty.noUnsafe=<span class="literal">true</span>, -Dio.netty.noKeySetOptimization=<span class="literal">true</span>, -Dio.netty.recycler.maxCapacityPerThread=0, -Dio.netty.allocator.numDirectArenas=0, -Dlog4j.shutdownHookEnabled=<span class="literal">false</span>, -Dlog4j2.disable.jmx=<span class="literal">true</span>, -Djava.locale.providers=SPI,COMPAT, -Xms1g, -Xmx1g, -XX:+UseG1GC, -XX:G1ReservePercent=25, -XX:InitiatingHeapOccupancyPercent=30, -Djava.io.tmpdir=/var/folders/fy/5zsq88p55dx45pk4gmpltmmr0000gp/T/elasticsearch-9946170376789376085, -XX:+HeapDumpOnOutOfMemoryError, -XX:HeapDumpPath=data, -XX:ErrorFile=logs/hs_err_pid%p.log, -Xlog:gc*,gc+age=trace,safepoint:file=/usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/elasticsearch/gc.log:utctime,pid,tags:filecount=32,filesize=64m, -XX:MaxDirectMemorySize=536870912, -Des.path.home=/usr/<span class="built_in">local</span>/Cellar/elasticsearch/7.10.2/libexec, -Des.path.conf=/usr/<span class="built_in">local</span>/etc/elasticsearch, -Des.distribution.flavor=oss, -Des.distribution.type=tar, -Des.bundled_jdk=<span class="literal">false</span>]</span><br><span class="line">[2021-02-19T12:05:59,599][WARN ][o.e.n.Node               ] [kgh-2.local] version [7.10.2-SNAPSHOT] is a pre-release version of Elasticsearch and is not suitable <span class="keyword">for</span> production</span><br><span class="line">[2021-02-19T12:06:00,853][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [aggs-matrix-stats]</span><br><span class="line">[2021-02-19T12:06:00,855][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [analysis-common]</span><br><span class="line">[2021-02-19T12:06:00,856][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [geo]</span><br><span class="line">[2021-02-19T12:06:00,857][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [ingest-common]</span><br><span class="line">[2021-02-19T12:06:00,858][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [ingest-geoip]</span><br><span class="line">[2021-02-19T12:06:00,859][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [ingest-user-agent]</span><br><span class="line">[2021-02-19T12:06:00,859][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [kibana]</span><br><span class="line">[2021-02-19T12:06:00,860][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [lang-expression]</span><br><span class="line">[2021-02-19T12:06:00,861][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [lang-mustache]</span><br><span class="line">[2021-02-19T12:06:00,861][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [lang-painless]</span><br><span class="line">[2021-02-19T12:06:00,862][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [mapper-extras]</span><br><span class="line">[2021-02-19T12:06:00,863][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [parent-join]</span><br><span class="line">[2021-02-19T12:06:00,864][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [percolator]</span><br><span class="line">[2021-02-19T12:06:00,864][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [rank-eval]</span><br><span class="line">[2021-02-19T12:06:00,865][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [reindex]</span><br><span class="line">[2021-02-19T12:06:00,865][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [repository-url]</span><br><span class="line">[2021-02-19T12:06:00,866][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [<span class="built_in">test</span>-delayed-aggs]</span><br><span class="line">[2021-02-19T12:06:00,867][INFO ][o.e.p.PluginsService     ] [kgh-2.local] loaded module [transport-netty4]</span><br><span class="line">[2021-02-19T12:06:00,868][INFO ][o.e.p.PluginsService     ] [kgh-2.local] no plugins loaded</span><br><span class="line">[2021-02-19T12:06:00,920][INFO ][o.e.e.NodeEnvironment    ] [kgh-2.local] using [1] data paths, mounts [[/System/Volumes/Data (/dev/disk1s1)]], net usable_space [39.2gb], net total_space [233.5gb], types [apfs]</span><br><span class="line">[2021-02-19T12:06:00,921][INFO ][o.e.e.NodeEnvironment    ] [kgh-2.local] heap size [1gb], compressed ordinary object pointers [<span class="literal">true</span>]</span><br><span class="line">[2021-02-19T12:06:01,012][INFO ][o.e.n.Node               ] [kgh-2.local] node name [kgh-2.local], node ID [_FYb0BAnQFyCJd4z4-M3Jw], cluster name [elasticsearch_brew], roles [master, remote_cluster_client, data, ingest]</span><br><span class="line">[2021-02-19T12:06:05,212][INFO ][o.e.t.NettyAllocator     ] [kgh-2.local] creating NettyAllocator with the following configs: [name=unpooled, suggested_max_allocation_size=256kb, factors=&#123;es.unsafe.use_unpooled_allocator=null, g1gc_enabled=<span class="literal">true</span>, g1gc_region_size=1mb, heap_size=1gb&#125;]</span><br><span class="line">[2021-02-19T12:06:05,377][INFO ][o.e.d.DiscoveryModule    ] [kgh-2.local] using discovery <span class="built_in">type</span> [zen] and seed hosts providers [settings]</span><br><span class="line">[2021-02-19T12:06:05,870][WARN ][o.e.g.DanglingIndicesState] [kgh-2.local] gateway.auto_import_dangling_indices is disabled, dangling indices will not be automatically detected or imported and must be managed manually</span><br><span class="line">[2021-02-19T12:06:06,195][INFO ][o.e.n.Node               ] [kgh-2.local] initialized</span><br><span class="line">[2021-02-19T12:06:06,196][INFO ][o.e.n.Node               ] [kgh-2.local] starting ...</span><br><span class="line">[2021-02-19T12:06:06,446][INFO ][o.e.t.TransportService   ] [kgh-2.local] publish_address &#123;127.0.0.1:9300&#125;, bound_addresses &#123;[::1]:9300&#125;, &#123;127.0.0.1:9300&#125;</span><br><span class="line">[2021-02-19T12:06:06,883][WARN ][o.e.b.BootstrapChecks    ] [kgh-2.local] the default discovery settings are unsuitable <span class="keyword">for</span> production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured</span><br><span class="line">[2021-02-19T12:06:06,944][INFO ][o.e.c.c.ClusterBootstrapService] [kgh-2.local] no discovery configuration found, will perform best-effort cluster bootstrapping after [3s] unless existing master is discovered</span><br><span class="line">[2021-02-19T12:06:09,949][INFO ][o.e.c.c.Coordinator      ] [kgh-2.local] setting initial configuration to VotingConfiguration&#123;_FYb0BAnQFyCJd4z4-M3Jw&#125;</span><br><span class="line">[2021-02-19T12:06:10,258][INFO ][o.e.c.s.MasterService    ] [kgh-2.local] elected-as-master ([1] nodes joined)[&#123;kgh-2.local&#125;&#123;_FYb0BAnQFyCJd4z4-M3Jw&#125;&#123;XfIeFRDrTIqm91ZOBkXD1Q&#125;&#123;127.0.0.1&#125;&#123;127.0.0.1:9300&#125;&#123;dimr&#125; elect leader, _BECOME_MASTER_TASK_, _FINISH_ELECTION_], term: 1, version: 1, delta: master node changed &#123;previous [], current [&#123;kgh-2.local&#125;&#123;_FYb0BAnQFyCJd4z4-M3Jw&#125;&#123;XfIeFRDrTIqm91ZOBkXD1Q&#125;&#123;127.0.0.1&#125;&#123;127.0.0.1:9300&#125;&#123;dimr&#125;]&#125;</span><br><span class="line">[2021-02-19T12:06:10,362][INFO ][o.e.c.c.CoordinationState] [kgh-2.local] cluster UUID <span class="built_in">set</span> to [opZ_8jGaS-yI2qclxNlqhg]</span><br><span class="line">[2021-02-19T12:06:10,433][INFO ][o.e.c.s.ClusterApplierService] [kgh-2.local] master node changed &#123;previous [], current [&#123;kgh-2.local&#125;&#123;_FYb0BAnQFyCJd4z4-M3Jw&#125;&#123;XfIeFRDrTIqm91ZOBkXD1Q&#125;&#123;127.0.0.1&#125;&#123;127.0.0.1:9300&#125;&#123;dimr&#125;]&#125;, term: 1, version: 1, reason: Publication&#123;term=1, version=1&#125;</span><br><span class="line">[2021-02-19T12:06:10,487][INFO ][o.e.h.AbstractHttpServerTransport] [kgh-2.local] publish_address &#123;127.0.0.1:9200&#125;, bound_addresses &#123;[::1]:9200&#125;, &#123;127.0.0.1:9200&#125;</span><br><span class="line">[2021-02-19T12:06:10,488][INFO ][o.e.n.Node               ] [kgh-2.local] started</span><br><span class="line">[2021-02-19T12:06:10,547][INFO ][o.e.g.GatewayService     ] [kgh-2.local] recovered [0] indices into cluster_state</span><br></pre></td></tr></table></figure><p>다음과 같이 <code>elasticsearch</code> 명령어로 Elasticsearch가 실행된것을 알 수 있습니다. 이제 publish_address인 127.0.0.1:9200 경로로 웹브라우저 상에서 접근을 하게 되면 다음과 같은 메시지를 얻을 수 있습니다.  아니면 아래와 같은 방식으로 curl -XGET 방식으로 직접터미널에서 확인해보는 방식이 있습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$curl</span> -XGET localhost:9200</span><br><span class="line">&#123;</span><br><span class="line">  <span class="string">"name"</span> : <span class="string">"kgh-2.local"</span>,</span><br><span class="line">  <span class="string">"cluster_name"</span> : <span class="string">"elasticsearch_brew"</span>,</span><br><span class="line">  <span class="string">"cluster_uuid"</span> : <span class="string">"opZ_8jGaS-yI2qclxNlqhg"</span>,</span><br><span class="line">  <span class="string">"version"</span> : &#123;</span><br><span class="line">    <span class="string">"number"</span> : <span class="string">"7.10.2-SNAPSHOT"</span>,</span><br><span class="line">    <span class="string">"build_flavor"</span> : <span class="string">"oss"</span>,</span><br><span class="line">    <span class="string">"build_type"</span> : <span class="string">"tar"</span>,</span><br><span class="line">    <span class="string">"build_hash"</span> : <span class="string">"unknown"</span>,</span><br><span class="line">    <span class="string">"build_date"</span> : <span class="string">"2021-01-16T01:34:41.142971Z"</span>,</span><br><span class="line">    <span class="string">"build_snapshot"</span> : <span class="literal">true</span>,</span><br><span class="line">    <span class="string">"lucene_version"</span> : <span class="string">"8.7.0"</span>,</span><br><span class="line">    <span class="string">"minimum_wire_compatibility_version"</span> : <span class="string">"6.8.0"</span>,</span><br><span class="line">    <span class="string">"minimum_index_compatibility_version"</span> : <span class="string">"6.0.0-beta1"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">"tagline"</span> : <span class="string">"You Know, for Search"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  "name" : "kgh-2.local",</span><br><span class="line">  "cluster_name" : "elasticsearch_brew",</span><br><span class="line">  "cluster_uuid" : </span><br><span class="line">  "version" : &#123;</span><br><span class="line">    "number" : "7.10.2-SNAPSHOT",</span><br><span class="line">    "build_flavor" : "oss",</span><br><span class="line">    "build_type" : "tar",</span><br><span class="line">    "build_hash" : "unknown",</span><br><span class="line">    "build_date" : "2021-01-16T01:34:41.142971Z",</span><br><span class="line">    "build_snapshot" : true,</span><br><span class="line">    "lucene_version" : "8.7.0",</span><br><span class="line">    "minimum_wire_compatibility_version" : "6.8.0",</span><br><span class="line">    "minimum_index_compatibility_version" : "6.0.0-beta1"</span><br><span class="line">  &#125;,</span><br><span class="line">  "tagline" : "You Know, for Search"</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="kibana-silhaenghagi"><a href="#kibana-silhaenghagi" class="header-anchor">6. </a><a class="markdownIt-Anchor" href="#kibana-실행하기"></a> Kibana 실행하기</h1><p>Terminal상에서 다음과 같은 명령어로 Kibana를 실행하여줍니다. 실행시 오류가 발생하여 보니 elasticsearch와의 버전문제가 발생하였습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$kibana</span></span><br><span class="line">  <span class="built_in">log</span>   [12:12:04.315] [info][plugins-service] Plugin <span class="string">"visTypeXy"</span> is disabled.</span><br><span class="line">  <span class="built_in">log</span>   [12:12:04.439] [warning][config][deprecation] Environment variable <span class="string">"DATA_PATH"</span> will be removed.  It has been replaced with kibana.yml setting <span class="string">"path.data"</span></span><br><span class="line">  <span class="built_in">log</span>   [12:12:04.440] [warning][config][deprecation] Config key [monitoring.cluster_alerts.email_notifications.email_address] will be required <span class="keyword">for</span> email notifications to work <span class="keyword">in</span> 8.0.<span class="string">"</span></span><br><span class="line"><span class="string">  log   [12:12:04.754] [info][plugins-system] Setting up [101] plugins: [taskManager,licensing,globalSearch,globalSearchProviders,code,usageCollection,xpackLegacy,telemetryCollectionManager,telemetry,telemetryCollectionXpack,kibanaUsageCollection,securityOss,newsfeed,mapsLegacy,kibanaLegacy,translations,bfetch,share,legacyExport,embeddable,uiActionsEnhanced,expressions,data,home,observability,console,consoleExtensions,apmOss,searchprofiler,painlessLab,grokdebugger,management,indexPatternManagement,advancedSettings,fileUpload,savedObjects,visualizations,visTypeTable,visTypeMarkdown,visTypeVega,visTypeTimelion,features,licenseManagement,dataEnhanced,tileMap,mapsOss,regionMap,lensOss,inputControlVis,graph,timelion,dashboard,dashboardEnhanced,visualize,charts,visTypeVislib,visTypeTimeseries,visTypeTimeseriesEnhanced,visTypeMetric,visTypeTagcloud,watcher,canvas,discover,discoverEnhanced,savedObjectsManagement,spaces,security,reporting,dashboardMode,savedObjectsTagging,lens,maps,lists,encryptedSavedObjects,cloud,upgradeAssistant,snapshotRestore,fleet,indexManagement,remoteClusters,crossClusterReplication,rollup,indexLifecycleManagement,enterpriseSearch,ml,beatsManagement,transform,ingestPipelines,eventLog,actions,alerts,triggersActionsUi,stackAlerts,securitySolution,case,infra,monitoring,logstash,apm,uptime,esUiShared]</span></span><br><span class="line"><span class="string">  log   [12:12:04.758] [info][plugins][taskManager] TaskManager is identified by the Kibana UUID: 75bba0a2-d69a-4376-b540-34d359878b57</span></span><br><span class="line"><span class="string">  log   [12:12:05.076] [warning][config][plugins][security] Generating a random key for xpack.security.encryptionKey. To prevent sessions from being invalidated on restart, please set xpack.security.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:12:05.077] [warning][config][plugins][security] Session cookies will be transmitted over insecure connections. This is not recommended.</span></span><br><span class="line"><span class="string">  log   [12:12:05.120] [warning][config][plugins][reporting] Generating a random key for xpack.reporting.encryptionKey. To prevent sessions from being invalidated on restart, please set xpack.reporting.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:12:05.121] [info][config][plugins][reporting] Chromium sandbox provides an additional layer of protection, and is supported for Darwin OS. Automatically enabling Chromium sandbox.</span></span><br><span class="line"><span class="string">  log   [12:12:05.154] [warning][config][encryptedSavedObjects][plugins] Generating a random key for xpack.encryptedSavedObjects.encryptionKey. To decrypt encrypted saved objects attributes after restart, please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:12:05.184] [warning][fleet][plugins] Fleet APIs are disabled because the Encrypted Saved Objects plugin uses an ephemeral encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:12:05.287] [warning][actions][actions][plugins] APIs are disabled because the Encrypted Saved Objects plugin uses an ephemeral encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:12:05.303] [warning][alerting][alerts][plugins][plugins] APIs are disabled because the Encrypted Saved Objects plugin uses an ephemeral encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:12:05.446] [info][monitoring][monitoring][plugins] config sourced from: production cluster</span></span><br><span class="line"><span class="string">  log   [12:12:05.705] [info][savedobjects-service] Waiting until all Elasticsearch nodes are compatible with Kibana before starting saved objects migrations...</span></span><br><span class="line"><span class="string">  log   [12:12:05.790] [warning][licensing][plugins] License information could not be obtained from Elasticsearch due to [illegal_argument_exception] request [/_xpack] contains unrecognized parameter: [accept_enterprise] :: &#123;"</span>path<span class="string">":"</span>/_xpack?accept_enterprise=<span class="literal">true</span><span class="string">","</span>statusCode<span class="string">":400,"</span>response<span class="string">":"</span>&#123;\"error\":&#123;\"root_cause\":[&#123;\"<span class="built_in">type</span>\":\"illegal_argument_exception\",\"reason\":\"request [/_xpack] contains unrecognized parameter: [accept_enterprise]\"&#125;],\"<span class="built_in">type</span>\":\"illegal_argument_exception\",\"reason\":\"request [/_xpack] contains unrecognized parameter: [accept_enterprise]\"&#125;,\"status\":400&#125;<span class="string">"&#125; error</span></span><br><span class="line"><span class="string">  log   [12:12:05.794] [warning][monitoring][monitoring][plugins] X-Pack Monitoring Cluster Alerts will not be available: X-Pack plugin is not installed on the Elasticsearch cluster.</span></span><br><span class="line"><span class="string">  log   [12:12:05.900] [error][savedobjects-service] This version of Kibana (v7.11.1) is incompatible with the following Elasticsearch nodes in your cluster: v7.10.2 @ 127.0.0.1:9200 (127.0.0.1)</span></span><br><span class="line"><span class="string">  log   [12:12:35.729] [warning][licensing][plugins] License information could not be obtained from Elasticsearch due to [illegal_argument_exception] request [/_xpack] contains unrecognized parameter: [accept_enterprise] :: &#123;"</span>path<span class="string">":"</span>/_xpack?accept_enterprise=<span class="literal">true</span><span class="string">","</span>statusCode<span class="string">":400,"</span>response<span class="string">":"</span>&#123;\"error\":&#123;\"root_cause\":[&#123;\"<span class="built_in">type</span>\":\"illegal_argument_exception\",\"reason\":\"request [/_xpack] contains unrecognized parameter: [accept_enterprise]\"&#125;],\"<span class="built_in">type</span>\":\"illegal_argument_exception\",\"reason\":\"request [/_xpack] contains unrecognized parameter: [accept_enterprise]\"&#125;,\"status\":400&#125;<span class="string">"&#125; error</span></span><br><span class="line"><span class="string">^C  log   [12:12:42.392] [info][plugins-system] Stopping all plugins.</span></span><br><span class="line"><span class="string">  log   [12:12:42.395] [info][kibana-monitoring][monitoring][monitoring][plugins] Monitoring stats collection is stopped</span></span><br><span class="line"><span class="string">^C  log   [12:12:42.624] [info][plugins-system] Stopping all plugins.</span></span><br><span class="line"><span class="string">  log   [12:12:42.628] [info][savedobjects-service] Starting saved objects migrations</span></span><br><span class="line"><span class="string">  log   [12:12:42.631] [warning][savedobjects-service] Unable to connect to Elasticsearch. Error: Given the configuration, the ConnectionPool was not able to find a usable Connection for this request.</span></span><br><span class="line"><span class="string">  log   [12:12:42.632] [warning][savedobjects-service] Unable to connect to Elasticsearch. Error: Given the configuration, the ConnectionPool was not able to find a usable Connection for this request.</span></span><br><span class="line"><span class="string">^C%</span></span><br><span class="line"><span class="string"> kgh  ~</span></span><br><span class="line"><span class="string"><span class="variable">$kibana</span> --version</span></span><br><span class="line"><span class="string">7.11.1</span></span><br></pre></td></tr></table></figure><p>이렇게 해당오류가 발생한 이유를 보니 버전을 full 버전(즉, 최신버전으로)다운받지 않아서 이러한 호환성문제가 생기게 되었습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brew install elasticsearch(최신 버전 호환 X)</span><br><span class="line">brew install elasticsearch-full(최신 버전 호환 O)</span><br></pre></td></tr></table></figure><p>따라서 다음과 같은방법으로 elasticsearch버전을 unlink해주고 새롭게 다시 설치를 진행하였습니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$brew</span> uninstall elasticsearch</span><br><span class="line"><span class="variable">$rm</span> -rf /usr/<span class="built_in">local</span>/etc/elasticsearch</span><br><span class="line"><span class="variable">$rm</span> -rf /usr/<span class="built_in">local</span>/var/lib/elasticsearch</span><br><span class="line"><span class="variable">$brew</span> unlink elasticsearch</span><br><span class="line">Unlinking /usr/<span class="built_in">local</span>/Cellar/elasticsearch/7.10.2... 4 symlinks removed.</span><br><span class="line"></span><br><span class="line">brew install elasticsearch-full</span><br><span class="line">==&gt; Installing elasticsearch-full from elastic/tap</span><br><span class="line">==&gt; Downloading https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.11.1-darwin-x86_64.tar.gz?tap=elastic/homebrew-tap</span><br><span class="line">Already downloaded: /Users/kgh/Library/Caches/Homebrew/downloads/4c04176d64640de7c66954a6e6c536ac2ff45a342828e8af1d13fc8bf0ed47c8--elasticsearch-7.11.1-darwin-x86_64.tar.gz</span><br><span class="line">Warning: Tried to install empty array to /usr/<span class="built_in">local</span>/etc/elasticsearch/jvm.options.d</span><br><span class="line">==&gt; codesign -f -s - /usr/<span class="built_in">local</span>/Cellar/elasticsearch-full/7.11.1/libexec/modules/x-pack-ml/platform/darwin-x86_64/controller.app --deep</span><br><span class="line">==&gt; find /usr/<span class="built_in">local</span>/Cellar/elasticsearch-full/7.11.1/libexec/jdk.app/Contents/Home/bin -<span class="built_in">type</span> f -<span class="built_in">exec</span> codesign -f -s - &#123;&#125; ;</span><br><span class="line">==&gt; Caveats</span><br><span class="line">Data:    /usr/<span class="built_in">local</span>/var/lib/elasticsearch/elasticsearch_kgh/</span><br><span class="line">Logs:    /usr/<span class="built_in">local</span>/var/<span class="built_in">log</span>/elasticsearch/elasticsearch_kgh.log</span><br><span class="line">Plugins: /usr/<span class="built_in">local</span>/var/elasticsearch/plugins/</span><br><span class="line">Config:  /usr/<span class="built_in">local</span>/etc/elasticsearch/</span><br><span class="line"></span><br><span class="line">To have launchd start elastic/tap/elasticsearch-full now and restart at login:</span><br><span class="line"> brew services start elastic/tap/elasticsearch-full</span><br><span class="line">Or, <span class="keyword">if</span> you don<span class="string">'t want/need a background service you can just run:</span></span><br><span class="line"><span class="string"> elasticsearch</span></span><br><span class="line"><span class="string">==&gt; Summary</span></span><br><span class="line"><span class="string">🍺  /usr/local/Cellar/elasticsearch-full/7.11.1: 933 files, 488.2MB, built in 19 seconds</span></span><br></pre></td></tr></table></figure><p>다음과 같이 버전을 새로 설치하여 호환성을 맞추어주었습니다.</p><p><strong>반드시 $elasticsearch가 구동되어있다면 재시작을 진행해야 정상적으로 수행이됩니다</strong></p><blockquote><p>kibana 다시 재가동하기</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">kibana</span><br><span class="line">  log   [<span class="number">12</span>:<span class="number">50</span>:<span class="number">29.122</span>] [info][plugins-service] Plugin <span class="string">"visTypeXy"</span> is disabled.</span><br><span class="line">  log   [<span class="number">12</span>:<span class="number">50</span>:<span class="number">29.357</span>] [warning][config][deprecation] Environment variable <span class="string">"DATA_PATH"</span> will be removed.  It has been replaced with kibana.yml setting <span class="string">"path.data"</span></span><br><span class="line">  log   [<span class="number">12</span>:<span class="number">50</span>:<span class="number">29.359</span>] [warning][config][deprecation] Config key [monitoring.cluster_alerts.email_notifications.email_address] will be required <span class="keyword">for</span> email notifications to work in <span class="number">8.0</span>.<span class="string">"</span></span><br><span class="line"><span class="string">  log   [12:50:29.635] [info][plugins-system] Setting up [101] plugins: [taskManager,licensing,globalSearch,globalSearchProviders,code,usageCollection,xpackLegacy,telemetryCollectionManager,telemetry,telemetryCollectionXpack,kibanaUsageCollection,securityOss,newsfeed,mapsLegacy,kibanaLegacy,translations,share,legacyExport,embeddable,uiActionsEnhanced,expressions,charts,esUiShared,bfetch,data,home,observability,console,consoleExtensions,apmOss,searchprofiler,painlessLab,grokdebugger,management,indexPatternManagement,advancedSettings,fileUpload,savedObjects,visualizations,visTypeVislib,visTypeTimeseries,visTypeTimeseriesEnhanced,visTypeVega,visTypeTable,visTypeTimelion,features,licenseManagement,dataEnhanced,watcher,canvas,visTypeTagcloud,visTypeMetric,visTypeMarkdown,tileMap,regionMap,lensOss,mapsOss,inputControlVis,graph,timelion,dashboard,dashboardEnhanced,visualize,discover,discoverEnhanced,savedObjectsManagement,spaces,security,savedObjectsTagging,maps,lens,reporting,lists,encryptedSavedObjects,dashboardMode,cloud,upgradeAssistant,snapshotRestore,fleet,indexManagement,remoteClusters,crossClusterReplication,rollup,indexLifecycleManagement,enterpriseSearch,ml,beatsManagement,transform,ingestPipelines,eventLog,actions,alerts,triggersActionsUi,stackAlerts,securitySolution,case,infra,monitoring,logstash,apm,uptime]</span></span><br><span class="line"><span class="string">  log   [12:50:29.639] [info][plugins][taskManager] TaskManager is identified by the Kibana UUID: 75bba0a2-d69a-4376-b540-34d359878b57</span></span><br><span class="line"><span class="string">  log   [12:50:30.070] [warning][config][plugins][security] Generating a random key for xpack.security.encryptionKey. To prevent sessions from being invalidated on restart, please set xpack.security.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:50:30.070] [warning][config][plugins][security] Session cookies will be transmitted over insecure connections. This is not recommended.</span></span><br><span class="line"><span class="string">  log   [12:50:30.180] [warning][config][plugins][reporting] Generating a random key for xpack.reporting.encryptionKey. To prevent sessions from being invalidated on restart, please set xpack.reporting.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:50:30.183] [info][config][plugins][reporting] Chromium sandbox provides an additional layer of protection, and is supported for Darwin OS. Automatically enabling Chromium sandbox.</span></span><br><span class="line"><span class="string">  log   [12:50:30.192] [warning][config][encryptedSavedObjects][plugins] Generating a random key for xpack.encryptedSavedObjects.encryptionKey. To decrypt encrypted saved objects attributes after restart, please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:50:30.265] [warning][fleet][plugins] Fleet APIs are disabled because the Encrypted Saved Objects plugin uses an ephemeral encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:50:30.393] [warning][actions][actions][plugins] APIs are disabled because the Encrypted Saved Objects plugin uses an ephemeral encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:50:30.414] [warning][alerting][alerts][plugins][plugins] APIs are disabled because the Encrypted Saved Objects plugin uses an ephemeral encryption key. Please set xpack.encryptedSavedObjects.encryptionKey in the kibana.yml or use the bin/kibana-encryption-keys command.</span></span><br><span class="line"><span class="string">  log   [12:50:30.540] [info][monitoring][monitoring][plugins] config sourced from: production cluster</span></span><br><span class="line"><span class="string">  log   [12:50:30.816] [info][savedobjects-service] Waiting until all Elasticsearch nodes are compatible with Kibana before starting saved objects migrations...</span></span><br><span class="line"><span class="string">  log   [12:50:31.036] [info][savedobjects-service] Starting saved objects migrations</span></span><br><span class="line"><span class="string">  log   [12:50:31.095] [info][savedobjects-service] Creating index .kibana_task_manager_1.</span></span><br><span class="line"><span class="string">  log   [12:50:31.100] [info][savedobjects-service] Creating index .kibana_1.</span></span><br><span class="line"><span class="string">  log   [12:50:31.929] [info][savedobjects-service] Pointing alias .kibana_task_manager to .kibana_task_manager_1.</span></span><br><span class="line"><span class="string">  log   [12:50:32.013] [info][savedobjects-service] Pointing alias .kibana to .kibana_1.</span></span><br><span class="line"><span class="string">  log   [12:50:32.134] [info][savedobjects-service] Finished in 1039ms.</span></span><br><span class="line"><span class="string">  log   [12:50:32.188] [info][savedobjects-service] Finished in 1101ms.</span></span><br><span class="line"><span class="string">  log   [12:50:32.225] [info][plugins-system] Starting [101] plugins: [taskManager,licensing,globalSearch,globalSearchProviders,code,usageCollection,xpackLegacy,telemetryCollectionManager,telemetry,telemetryCollectionXpack,kibanaUsageCollection,securityOss,newsfeed,mapsLegacy,kibanaLegacy,translations,share,legacyExport,embeddable,uiActionsEnhanced,expressions,charts,esUiShared,bfetch,data,home,observability,console,consoleExtensions,apmOss,searchprofiler,painlessLab,grokdebugger,management,indexPatternManagement,advancedSettings,fileUpload,savedObjects,visualizations,visTypeVislib,visTypeTimeseries,visTypeTimeseriesEnhanced,visTypeVega,visTypeTable,visTypeTimelion,features,licenseManagement,dataEnhanced,watcher,canvas,visTypeTagcloud,visTypeMetric,visTypeMarkdown,tileMap,regionMap,lensOss,mapsOss,inputControlVis,graph,timelion,dashboard,dashboardEnhanced,visualize,discover,discoverEnhanced,savedObjectsManagement,spaces,security,savedObjectsTagging,maps,lens,reporting,lists,encryptedSavedObjects,dashboardMode,cloud,upgradeAssistant,snapshotRestore,fleet,indexManagement,remoteClusters,crossClusterReplication,rollup,indexLifecycleManagement,enterpriseSearch,ml,beatsManagement,transform,ingestPipelines,eventLog,actions,alerts,triggersActionsUi,stackAlerts,securitySolution,case,infra,monitoring,logstash,apm,uptime]</span></span><br><span class="line"><span class="string">  log   [12:50:35.778] [info][listening] Server running at http://localhost:5601</span></span><br><span class="line"><span class="string">  log   [12:50:36.837] [info][server][Kibana][http] http server running at http://localhost:5601</span></span><br><span class="line"><span class="string">  log   [12:50:36.851] [info][plugins][watcher] Your basic license does not support watcher. Please upgrade your license.</span></span><br><span class="line"><span class="string">  log   [12:50:36.865] [info][crossClusterReplication][plugins] Your basic license does not support crossClusterReplication. Please upgrade your license.</span></span><br><span class="line"><span class="string">  log   [12:50:36.876] [info][kibana-monitoring][monitoring][monitoring][plugins] Starting monitoring stats collection</span></span><br><span class="line"><span class="string">  log   [12:50:39.515] [info][plugins][reporting] Downloading https://storage.googleapis.com/headless_shell/chromium-ef768c9-darwin_x64.zip to /usr/local/Cellar/kibana-full/7.11.1/libexec/.chromium/chromium-ef768c9-darwin_x64.zip</span></span><br><span class="line"><span class="string">  log   [12:50:39.517] [info][plugins][reporting] Downloading https://storage.googleapis.com/headless_shell/chromium-ef768c9-linux_x64.zip to /usr/local/Cellar/kibana-full/7.11.1/libexec/.chromium/chromium-ef768c9-linux_x64.zip</span></span><br><span class="line"><span class="string">  log   [12:50:39.518] [info][plugins][reporting] Downloading https://storage.googleapis.com/headless_shell/chromium-ef768c9-linux_arm64.zip to /usr/local/Cellar/kibana-full/7.11.1/libexec/.chromium/chromium-ef768c9-linux_arm64.zip</span></span><br><span class="line"><span class="string">  log   [12:50:39.519] [info][plugins][reporting] Downloading https://storage.googleapis.com/headless_shell/chromium-ef768c9-windows_x64.zip to /usr/local/Cellar/kibana-full/7.11.1/libexec/.chromium/chromium-ef768c9-windows_x64.zip</span></span><br><span class="line"><span class="string">  log   [12:51:03.269] [info][plugins][reporting] Downloaded https://storage.googleapis.com/headless_shell/chromium-ef768c9-linux_x64.zip</span></span><br><span class="line"><span class="string">  log   [12:51:05.427] [info][plugins][reporting] Downloaded https://storage.googleapis.com/headless_shell/chromium-ef768c9-darwin_x64.zip</span></span><br><span class="line"><span class="string">  log   [12:51:06.716] [info][plugins][reporting] Downloaded https://storage.googleapis.com/headless_shell/chromium-ef768c9-windows_x64.zip</span></span><br><span class="line"><span class="string">  log   [12:51:07.962] [info][plugins][reporting] Downloaded https://storage.googleapis.com/headless_shell/chromium-ef768c9-linux_arm64.zip</span></span><br><span class="line"><span class="string">  log   [12:51:07.969] [info][plugins][reporting] Extracting [/usr/local/Cellar/kibana-full/7.11.1/libexec/.chromium/chromium-ef768c9-darwin_x64.zip] to [/usr/local/Cellar/kibana-full/7.11.1/libexec/x-pack/plugins/reporting/chromium/headless_shell-darwin_x64/headless_shell]</span></span><br><span class="line"><span class="string">  log   [12:51:07.995] [warning][environment] Detected an unhandled Promise rejection.</span></span><br><span class="line"><span class="string">Error: Cannot delete files/directories outside the current working directory. Can be overridden with the `force` option.</span></span><br></pre></td></tr></table></figure><blockquote><p>버전별 설치하기</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -O https:<span class="comment">//artifacts.elastic.co/downloads/kibana/kibana-7.10.2-darwin-x86_64.tar.gz</span></span><br><span class="line">tar -xzf kibana-<span class="number">7.10</span><span class="number">.2</span>-darwin-x86_64.tar.gz</span><br></pre></td></tr></table></figure><p><a href="https://smartstuartkim.wordpress.com/2019/09/23/install-elastic-stack-on-mac-session-1-openjdk-elastic-search-kibana-logstash-beat/" target="_blank" rel="noopener">https://smartstuartkim.wordpress.com/2019/09/23/install-elastic-stack-on-mac-session-1-openjdk-elastic-search-kibana-logstash-beat/</a></p><h1 id="kibana-gadong"><a href="#kibana-gadong" class="header-anchor">7. </a><a class="markdownIt-Anchor" href="#kibana-가동"></a> kibana 가동</h1><p>이제 다음과 같이 구동이되면 정상적으로 실행이 된것을 알 수 있습니다.</p><p><img src="https://www.google.com/imgres?imgurl=https%3A%2F%2Fpostfiles.pstatic.net%2FMjAxOTAzMjVfMjY2%2FMDAxNTUzNDQyNTg1OTM3.l64ILf-mwez4KBUG6Ot0imzxgb-W2Yp809zxaMOhdS4g.UNmLbyYSOgSh6oBMyn6G1SaRmwbEE-pS1NUnceix3V4g.PNG.hihello0426%2F%25EC%258A%25A4%25ED%2581%25AC%25EB%25A6%25B0%25EC%2583%25B7_2019-03-25_%25EC%2598%25A4%25EC%25A0%2584_12.49.36.png%3Ftype%3Dw773&amp;imgrefurl=https%3A%2F%2Fblog.naver.com%2FPostView.nhn%3FblogId%3Dhihello0426%26logNo%3D221496517750%26parentCategoryNo%3D50%26categoryNo%3D52%26viewDate%3D%26isShowPopularPosts%3Dfalse%26from%3DpostView&amp;tbnid=MOPqztZr9yT6YM&amp;vet=12ahUKEwig9JDBhvXuAhVIbJQKHUS8BBcQMygCegUIARCYAQ..i&amp;docid=jWTS9_Epc_LcSM&amp;w=773&amp;h=454&amp;q=Kibana%20welcome&amp;ved=2ahUKEwig9JDBhvXuAhVIbJQKHUS8BBcQMygCegUIARCYAQ" alt="Kibana"></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;homebrew&quot;&gt;&lt;a href=&quot;#homebrew&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#homebrew&quot;&gt;&lt;/a&gt; Homebrew&lt;/h1&gt;
&lt;p&gt;Homeb
      
    
    </summary>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/categories/elk/"/>
    
    
      <category term="ELK" scheme="http://gwanhyeon.github.io/tags/elk/"/>
    
  </entry>
  
  <entry>
    <title>Java MultiThread(멀티스레드) 고려사항</title>
    <link href="http://gwanhyeon.github.io/Java-20210218-multi-thread-java/"/>
    <id>http://gwanhyeon.github.io/Java-20210218-multi-thread-java/</id>
    <published>2021-02-18T07:22:53.000Z</published>
    <updated>2021-02-18T07:40:04.743Z</updated>
    
    <content type="html"><![CDATA[<h1 id="multi-thread-goryeosahang"><a href="#multi-thread-goryeosahang" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#multi-thread-고려사항"></a> Multi Thread 고려사항</h1><p>MultiThread를 구현하는 대표적인방법은 두가지가 있습니다.</p><ul><li>java.lang.Thread 클래스를 상속받아서 구현하는 방법</li><li>java.lang.Runnable 인터페이스를 구현해서 개발하는 방법</li></ul><blockquote><p>Field Member</p></blockquote><p>필드의 의미는 클래스에 변수를 정의하는 공간을 의미합니다. 하지만, 객체가 여러 스레드가 접근하는 싱글톤 객체라면 filed 상태값을 갖고 있지않고, 모든 변수를 parameter -&gt; return 형식으로 구성해야합니다.</p><blockquote><p>Synchronized</p></blockquote><p>동기화 처리시에 synchronized 키워드를 사용하여 스레드 간섭을 피하고 이 키워드 기반으로 구현된 Collection도 존재합니다.<br>List 대신 Vector, Map 대신 HashTable을 사용할 수 있지만, API 및 성능상 문제를 가지고 있습니다.</p><p>성능문제를 어떻게 해결 할 수 있을까요?</p><p>Collections 라는 utll 클래스에서 제공되는 static 메소드를 통해 해결이 가능합니다.</p><p>다음과 같이 변경하여 해결이 가능합니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Collections.synchronizedList()</span><br><span class="line">Collections.synchronizedSet()</span><br><span class="line">Collections.synchronizedMap()</span><br></pre></td></tr></table></figure><p>더 나아가서, JDK 1.7부터는 ConcurrentHashMap 구현체를 제공하여 Collections utill을 사용하는것보다 보다 좋은 성능을 내는 자료구조를 제공합니다.</p><ul><li>ConcurrentHashMap 예시</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    private final ConcurrentHashMap&lt;String, Movie.MovieDto&gt; movieMapCache = new ConcurrentHashMap&lt;&gt;(16);</span></span><br><span class="line"><span class="comment">    private volatile Long cacheLoadTime = 0L;</span></span><br><span class="line"><span class="comment">    private volatile Long cacheTimeLimit = 600 * 1000L;</span></span><br><span class="line"><span class="comment">     * 영화 캐시 조회</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> query</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Movie.MovieDto&gt; findCacheByQuery(<span class="keyword">final</span> String query) &#123;</span><br><span class="line">        <span class="keyword">long</span> nowTime = System.currentTimeMillis();</span><br><span class="line">        <span class="keyword">if</span>(CollectionUtils.isEmpty(movieMapCache) || nowTime - cacheLoadTime &gt; cacheTimeLimit)&#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (movieMapCache)&#123;</span><br><span class="line">                ResponseEntity&lt;Movie.MovieDto&gt; exchange = getExchange(query);</span><br><span class="line">                List&lt;Movie.Item&gt; ResponseMovieList = Movie.Item.of(exchange);</span><br><span class="line">                MovieGroup items = <span class="keyword">new</span> MovieGroup(ResponseMovieList);</span><br><span class="line">                List&lt;Movie.Item&gt; listOrderRating = items.getListOrderRating();</span><br><span class="line">                Movie.MovieDto resultList = Movie.MovieDto.of(exchange, listOrderRating);</span><br><span class="line">                cacheInitialized();</span><br><span class="line">                cacheLoadTime = nowTime;</span><br><span class="line">                movieMapCache.put(query, resultList);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> movieMapCache;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><blockquote><p>ThreadLocal</p></blockquote><p>일반 변수의 수명은 특정 코드 블록(예, 메서드 범위, for 블록 범위 등) 범위 내에서만 유효합니다. 하지만 <code>ThreadLocal</code>을 사용하면 반면에 ThreadLocal을 이용하면 쓰레드 영역에 변수를 설정할 수 있기 때문에, 특정 쓰레드가 실행하는 모든 코드에서 그 쓰레드에 설정된 변수 값을 사용할 수 있습니다. Thread사이에 간섭을 없애야하는 데이터에 사용이 되야하는데 멀티 스레드 환경에서는 클래스의필드에 멤버를 추가할 수 없고 매개변수로 넘겨받아야합니다. 결론적으로 스레드 내부의 싱글톤을 사용하기위해 사용합니다.</p><ul><li>ThreadLocal 주의 사항</li></ul><ol><li>ThreadLocal 객체를 생성한다.</li><li>ThreadLocal.set() 메서드를 이용해서 현재 쓰레드의 로컬 변수에 값을 저장한다.</li><li>ThreadLocal.get() 메서드를 이용해서 현재 쓰레드의 로컬 변수 값을 읽어온다.</li><li>ThreadLocal.remove() 메서드를 이용해서 현재 쓰레드의 로컬 변수 값을 삭제한다.</li></ol><p>쓰레드 풀 환경에서 ThreadLocal을 사용하는 경우 ThreadLocal 변수에 보관된 데이터의 사용이 끝나면 반드시 해당 데이터를 삭제해야하며 그렇지 않을 경우 재사용되는 쓰레드가 올바르지 않은 데이터를 참조할 수 있는 가능성이 있습니다.</p><ul><li>ThreadLocal 사용</li></ul><ol><li>사용자 인증정보 전파 - Spring Security에서는 ThreadLocal을 이용해서 사용자 인증 정보를 전달합니다.</li><li>트랜잭션 컨텍스트 - 트랜잭션 매니저는 트랜잭션 컨텍스트를 전파하는 데 ThreadLocal을 사용합니다.</li><li>세션 정보</li><li>Thread Safe한 데이터 저장</li></ol>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;multi-thread-goryeosahang&quot;&gt;&lt;a href=&quot;#multi-thread-goryeosahang&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#mul
      
    
    </summary>
    
    
      <category term="Java" scheme="http://gwanhyeon.github.io/categories/java/"/>
    
    
      <category term="Java" scheme="http://gwanhyeon.github.io/tags/java/"/>
    
      <category term="thread" scheme="http://gwanhyeon.github.io/tags/thread/"/>
    
  </entry>
  
  <entry>
    <title>Java Wrapper Class, Auto Boxing</title>
    <link href="http://gwanhyeon.github.io/Java-20210218-wrapper-class-auto-boxing-java/"/>
    <id>http://gwanhyeon.github.io/Java-20210218-wrapper-class-auto-boxing-java/</id>
    <published>2021-02-18T06:57:33.000Z</published>
    <updated>2021-02-18T07:17:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="wrapper-class"><a href="#wrapper-class" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#wrapper-class"></a> Wrapper Class</h1><p>Wrapper Class란?</p><p>자바의 자료형은 크게 <code>기본 타입(primitive type)과 참조 타입(reference type)</code>으로 나누어집니다.<br>대표적으로 기본 타입은 char, int, float, double, boolean 등이 있고 참조 타입은 class, interface 등이 있는데 프로그래밍을 하다 보면 기본 타입의 데이터를 객체로 표현해야 하는 경우가 종종 있습니다. 이럴 때에 기본 자료타입(primitive type)을 객체로 다루기 위해서 사용하는 클래스들을 래퍼 클래스(wrapper class)라고 합니다. Wrapper Class는 java.lang 패키지에 포함되어 있습니다.</p><p>컬렉션에서 제네릭을 사용하기 위해서는 Wrapper class를 사용해줘야하는데 null 값을 반환해야만 하는 경우에는 return type 을 Wrapper class 로 지정하여 null을 반환하도록 할 수 있습니다. 아니면 옵셔널을 붙여서 반환하는 방식도 있습니다.</p><p>Primitive data type 인 경우에는 “==” 비교가 가능하지만  Wrapper class 인 경우에는 .intValue() 메소드를 통해 해당 Wrapper class 의 값을 직접 가져와서 비교해야합니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WrapperClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Integer phoneNumber = <span class="keyword">new</span> Integer(<span class="string">"123456789"</span>);</span><br><span class="line">        <span class="keyword">int</span> num = phoneNumber.intValue();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>위와 같은 예제는 기본 타입의 값을 포장 객체로 만드는 과정을 <code>박싱</code>이라고 하고 반대로 포장객체에서 기본타입의 값을 얻어내는 과정을 <code>언박싱</code>이라고 합니다.</p><h1 id="autoboxing"><a href="#autoboxing" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#autoboxing"></a> AutoBoxing</h1><p>기본타입 값을 직접 박싱, 언박싱하지 않아도 자동적으로 박싱과 언박싱이 일어나는 경우가 있습니다. 자동 박싱의 포장 클래스 타입에 기본값이 대입될 경우에 발생합니다. AutoBoxing은 JDK 1.5 부터는 AutoBoxing과 AutoUnBoxing을 제공합니다. 이 기능은 각 Wrapper class 에 상응하는 Primitive data type 일 경우에만 가능합니다.</p><blockquote><p>예제 1</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WrapperClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 자동 박싱</span></span><br><span class="line">        Integer phoneNumber = <span class="number">123456789</span>;</span><br><span class="line">        <span class="comment">// 자동 언박싱</span></span><br><span class="line">        <span class="keyword">int</span> num = phoneNumber;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 Integer Wrapper Class에서 Primitive data type으로 AutoBoxing이 일어나게 됩니다.</p><blockquote><p>예제 2</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; arrList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">arrList.add(<span class="number">1</span>);</span><br></pre></td></tr></table></figure><p>다음과 같은 예제는 Integer라는 Wrapper class 로 설정한 collection 에 데이터를 add 할 때 Integer 객체로 감싸서 넣지 않습니다.<br>즉, 자바 내부에서 AutoBoxing 해주기 때문입니다.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;wrapper-class&quot;&gt;&lt;a href=&quot;#wrapper-class&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#wrapper-class&quot;&gt;&lt;/a&gt; Wrapper
      
    
    </summary>
    
    
      <category term="Java" scheme="http://gwanhyeon.github.io/categories/java/"/>
    
    
      <category term="WrapperClass" scheme="http://gwanhyeon.github.io/tags/wrapperclass/"/>
    
      <category term="AutoBoxing" scheme="http://gwanhyeon.github.io/tags/autoboxing/"/>
    
  </entry>
  
  <entry>
    <title>Java 클린코드 매직넘버 이슈 및 final 키워드</title>
    <link href="http://gwanhyeon.github.io/Java-20210218-magic-number-final-java/"/>
    <id>http://gwanhyeon.github.io/Java-20210218-magic-number-final-java/</id>
    <published>2021-02-18T04:27:38.000Z</published>
    <updated>2021-02-18T11:57:03.340Z</updated>
    
    <content type="html"><![CDATA[<h1 id="maejigneombeoreul-jigjeob-jagseonghaneungeoseul-jiyanghara"><a href="#maejigneombeoreul-jigjeob-jagseonghaneungeoseul-jiyanghara" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#매직넘버를-직접-작성하는것을-지양하라"></a> 매직넘버를 직접 작성하는것을 지양하라</h1><p>소스코드를 보다보면 특정한 숫자 매직넘버(Magic Number)를 직접 작성하는 나쁜 스타일의 코드를 볼 수 있습니다.</p><p>만약에 캐싱으로 캐싱값들을 강제로 업데이트하는 로직이 있다고 가정해보겠습니다. 여기에서 캐시에 대한 시간값을 지정했다고 가정하면 다음과 같이 코드를 작성하는것이 올바른 코드 일까요? 아닙니다. 저렇게 내부적으로 상수값들을 선언을 해주게 되면 유지보수측면이나 코드의 가독성측면에서 좋지 않은 결과를 가져다 줄 것입니다.</p><blockquote><p>매직넘버의 단점</p></blockquote><ul><li>매직넘버의 의미를 알기어렵고 0,1의 의미를 직접알기에 매우 쉽지않습니다.</li><li>매직넘버는 수정이 매우어렵고 유지보수를 힘들게합니다. 시간효율성측면에서 좋지않습니다.</li></ul><blockquote><p>캐싱 강제 업데이트(매직넘버 미적용)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 캐시 강제 업데이트</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> query</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Movie.MovieDto&gt; saveCacheByQuery(<span class="keyword">final</span> String query) &#123;</span><br><span class="line">    <span class="keyword">long</span> nowTime = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">if</span>(!CollectionUtils.isEmpty(movieMapCache) || nowTime - cacheLoadTime &lt; <span class="number">600</span> * <span class="number">1000L</span>;)&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (movieMapCache)&#123;</span><br><span class="line">            cacheInitialized();</span><br><span class="line">            ResponseEntity&lt;Movie.MovieDto&gt; exchange = getExchange(query);</span><br><span class="line">            List&lt;Movie.Item&gt; ResponseMovieList = Movie.Item.of(exchange);</span><br><span class="line">            MovieGroup items = <span class="keyword">new</span> MovieGroup(ResponseMovieList);</span><br><span class="line">            List&lt;Movie.Item&gt; listOrderRating = items.getListOrderRating();</span><br><span class="line">            Movie.MovieDto resultList = Movie.MovieDto.of(exchange, listOrderRating);</span><br><span class="line">            cacheLoadTime = nowTime;</span><br><span class="line">            movieMapCache.put(query, resultList);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> movieMapCache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>캐싱 강제 업데이트(매직넘버 적용)</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 선언부 </span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">volatile</span> Long cacheLoadTime = <span class="number">0L</span>;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">volatile</span> Long cacheTimeLimit = <span class="number">600</span> * <span class="number">1000L</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 캐시 강제 업데이트</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> query</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Movie.MovieDto&gt; saveCacheByQuery(<span class="keyword">final</span> String query) &#123;</span><br><span class="line">    <span class="keyword">long</span> nowTime = System.currentTimeMillis();</span><br><span class="line">    <span class="keyword">if</span>(!CollectionUtils.isEmpty(movieMapCache) || nowTime - cacheLoadTime &lt; cacheTimeLimit)&#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (movieMapCache)&#123;</span><br><span class="line">            cacheInitialized();</span><br><span class="line">            ResponseEntity&lt;Movie.MovieDto&gt; exchange = getExchange(query);</span><br><span class="line">            List&lt;Movie.Item&gt; ResponseMovieList = Movie.Item.of(exchange);</span><br><span class="line">            MovieGroup items = <span class="keyword">new</span> MovieGroup(ResponseMovieList);</span><br><span class="line">            List&lt;Movie.Item&gt; listOrderRating = items.getListOrderRating();</span><br><span class="line">            Movie.MovieDto resultList = Movie.MovieDto.of(exchange, listOrderRating);</span><br><span class="line">            cacheLoadTime = nowTime;</span><br><span class="line">            movieMapCache.put(query, resultList);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> movieMapCache;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>다음과 같이 매직넘버를 기호 상수로 선언하여 클린코드의 습관을 들여야합니다. 혹은 enum이나 public static final 클래스 필드를 사용하여 명확한 값들을 지정해주어야합니다. 실수를 줄일 수 있고, enum을 사용하여 상수값으로 매직넘버를 직접 사용해도 문제없이 컴파일시점에 처리가 가능합니다.</p><h1 id="final-keyword"><a href="#final-keyword" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#final-keyword"></a> final keyword</h1><blockquote><p>final class<br>다른 클래스에서 상속하지 못하게됩니다.</p></blockquote><blockquote><p>final method<br>다른 메소드에서 오버라이딩하지 못합니다.</p></blockquote><blockquote><p>final variable<br>변하지 않는 상수값이 되어 새로 할당할 수 없는 변수가 됩니다.</p></blockquote><blockquote><p>finally<br>try-catch or try-catch-resource 구문을 사용할 때, 마무리처리 작업 로직을 넣어야할때 사용합니다.</p></blockquote><blockquote><p>finalize()<br>keyword 도 아니고 code block 도 아닌 메소드입니다. 해당 메소드는 GC에 의해 호출되는 함수로 절대 호출해서는 안되며 Object 클래스에 정의되어 있으며 GC 가 발생하는 시점이 불분명하기 때문에 해당 메소드가 실행된다는 보장이 없습니다. 한 finalize() 메소드가 오버라이딩 되어 있으면 GC 가 이루어질 때 바로 Garbage Collecting 되지 않기때문에 GC 가 지연되면서 OOME(Out of Memory Exception)이 발생할 수 있는 이슈가 존재합니다.</p></blockquote>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;maejigneombeoreul-jigjeob-jagseonghaneungeoseul-jiyanghara&quot;&gt;&lt;a href=&quot;#maejigneombeoreul-jigjeob-jagseonghaneungeoseul-jiyanghara&quot; cl
      
    
    </summary>
    
    
      <category term="Java" scheme="http://gwanhyeon.github.io/categories/java/"/>
    
    
      <category term="final" scheme="http://gwanhyeon.github.io/tags/final/"/>
    
      <category term="magicnumber" scheme="http://gwanhyeon.github.io/tags/magicnumber/"/>
    
  </entry>
  
  <entry>
    <title>프로그래머스 경주로건설</title>
    <link href="http://gwanhyeon.github.io/Programmers-20210216-programmers-%EA%B2%BD%EC%A3%BC%EB%A1%9C%EA%B1%B4%EC%84%A4/"/>
    <id>http://gwanhyeon.github.io/Programmers-20210216-programmers-%EA%B2%BD%EC%A3%BC%EB%A1%9C%EA%B1%B4%EC%84%A4/</id>
    <published>2021-02-16T09:21:05.000Z</published>
    <updated>2021-02-16T09:30:57.398Z</updated>
    
    <content type="html"><![CDATA[<h1 id="peurogeuraemeoseu-gyeongjurogeonseol"><a href="#peurogeuraemeoseu-gyeongjurogeonseol" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#프로그래머스-경주로건설"></a> <a href="https://programmers.co.kr/learn/courses/30/lessons/67259" target="_blank" rel="noopener">프로그래머스 경주로건설 </a></h1><h1 id="munje-seolmyeong"><a href="#munje-seolmyeong" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#문제-설명"></a> 문제 설명</h1><p><img src="https://grepp-programmers.s3.ap-northeast-2.amazonaws.com/files/production/384b9e2a-4eb5-460d-bce2-d12359b03b14/kakao_road1.png" alt="문제설명"></p><p>건설회사의 설계사인 죠르디는 고객사로부터 자동차 경주로 건설에 필요한 견적을 의뢰받았습니다.<br>제공된 경주로 설계 도면에 따르면 경주로 부지는 N x N 크기의 정사각형 격자 형태이며 각 격자는 1 x 1 크기입니다.<br>설계 도면에는 각 격자의 칸은 0 또는 1 로 채워져 있으며, 0은 칸이 비어 있음을 1은 해당 칸이 벽으로 채워져 있음을 나타냅니다.<br>경주로의 출발점은 (0, 0) 칸(좌측 상단)이며, 도착점은 (N-1, N-1) 칸(우측 하단)입니다. 죠르디는 출발점인 (0, 0) 칸에서 출발한 자동차가 도착점인 (N-1, N-1) 칸까지 무사히 도달할 수 있게 중간에 끊기지 않도록 경주로를 건설해야 합니다.<br>경주로는 상, 하, 좌, 우로 인접한 두 빈 칸을 연결하여 건설할 수 있으며, 벽이 있는 칸에는 경주로를 건설할 수 없습니다.<br>이때, 인접한 두 빈 칸을 상하 또는 좌우로 연결한 경주로를 직선 도로 라고 합니다.<br>또한 두 직선 도로가 서로 직각으로 만나는 지점을 코너 라고 부릅니다.<br>건설 비용을 계산해 보니 직선 도로 하나를 만들 때는 100원이 소요되며, 코너를 하나 만들 때는 500원이 추가로 듭니다.<br>죠르디는 견적서 작성을 위해 경주로를 건설하는 데 필요한 최소 비용을 계산해야 합니다.</p><p>예를 들어, 아래 그림은 직선 도로 6개와 코너 4개로 구성된 임의의 경주로 예시이며, 건설 비용은 6 x 100 + 4 x 500 = 2600원 입니다.</p><p><img src="https://grepp-programmers.s3.ap-northeast-2.amazonaws.com/files/production/3f5d9c5e-d7d9-4248-b111-140a0847e741/kakao_road2.png" alt></p><p>또 다른 예로, 아래 그림은 직선 도로 4개와 코너 1개로 구성된 경주로이며, 건설 비용은 4 x 100 + 1 x 500 = 900원 입니다.</p><p><img src="https://grepp-programmers.s3.ap-northeast-2.amazonaws.com/files/production/ccc72e9c-2e22-4a09-a94b-ff057b081a70/kakao_road3.png" alt></p><p>도면의 상태(0은 비어 있음, 1은 벽)을 나타내는 2차원 배열 board가 매개변수로 주어질 때, 경주로를 건설하는데 필요한 최소 비용을 return 하도록 solution 함수를 완성해주세요.</p><p>[제한사항]<br>board는 2차원 정사각 배열로 배열의 크기는 3 이상 25 이하입니다.<br>board 배열의 각 원소의 값은 0 또는 1 입니다.<br>도면의 가장 왼쪽 상단 좌표는 (0, 0)이며, 가장 우측 하단 좌표는 (N-1, N-1) 입니다.<br>원소의 값 0은 칸이 비어 있어 도로 연결이 가능함을 1은 칸이 벽으로 채워져 있어 도로 연결이 불가능함을 나타냅니다.<br>board는 항상 출발점에서 도착점까지 경주로를 건설할 수 있는 형태로 주어집니다.<br>출발점과 도착점 칸의 원소의 값은 항상 0으로 주어집니다.<br>입출력 예<br>board    result<br>[[0,0,0],[0,0,0],[0,0,0]]    900<br>[[0,0,0,0,0,0,0,1],[0,0,0,0,0,0,0,0],[0,0,0,0,0,1,0,0],[0,0,0,0,1,0,0,0],[0,0,0,1,0,0,0,1],[0,0,1,0,0,0,1,0],[0,1,0,0,0,1,0,0],[1,0,0,0,0,0,0,0]]    3800<br>[[0,0,1,0],[0,0,0,0],[0,1,0,1],[1,0,0,0]]    2100<br>[[0,0,0,0,0,0],[0,1,1,1,1,0],[0,0,1,0,0,0],[1,0,0,1,0,1],[0,1,0,0,0,1],[0,0,0,0,0,0]]    3200<br>입출력 예에 대한 설명<br>입출력 예 #1</p><p>본문의 예시와 같습니다.</p><p>입출력 예 #2</p><p><img src="https://grepp-programmers.s3.ap-northeast-2.amazonaws.com/files/production/ccc72e9c-2e22-4a09-a94b-ff057b081a70/kakao_road4.png" alt></p><p>위와 같이 경주로를 건설하면 직선 도로 18개, 코너 4개로 총 3800원이 듭니다.</p><p>입출력 예 #3</p><p><img src="https://grepp-programmers.s3.ap-northeast-2.amazonaws.com/files/production/4fe42f47-2592-4cb8-91fb-31d6a6da8639/kakao_road5.png" alt></p><p>위와 같이 경주로를 건설하면 직선 도로 6개, 코너 3개로 총 2100원이 듭니다.</p><p>입출력 예 #4</p><p><img src="https://grepp-programmers.s3.ap-northeast-2.amazonaws.com/files/production/ccc72e9c-2e22-4a09-a94b-ff057b081a70/kakao_road6.png" alt></p><p>붉은색 경로와 같이 경주로를 건설하면 직선 도로 12개, 코너 4개로 총 3200원이 듭니다.<br>만약, 파란색 경로와 같이 경주로를 건설한다면 직선 도로 10개, 코너 5개로 총 3500원이 들며, 더 많은 비용이 듭니다.</p><h2 id="keompyutingjeog-sago"><a href="#keompyutingjeog-sago" class="header-anchor">2.1. </a><a class="markdownIt-Anchor" href="#컴퓨팅적-사고"></a> 컴퓨팅적 사고</h2><p>해당 문제는 BFS로 모든경로에서의 최소비용을 찾는 문제였습니다. 처음에 일반 bfs처럼 처리하려다가 모든 경로를 확인해야하는 경우가 있고 n-1,n-1지점에 도달하는 경우가 다수가 생길 수 있기때문에 그 부분을 다시 체크하여 푼 문제였습니다.</p><ul><li>(1) 0,0지점에서 (n-1,n-1)지점까지 도달하는 모든 경우를 구해주었습니다.</li><li>일반 bfs와는 다르게 check변수를 선언하지 않았는데 그 이유는 n-1,n-1지점으로 도달하는 경우가 여러개일수 있기 때문입니다.</li><li>(2) 4가지 방향을 이용하여 모든 보드를 탐색하였고, 최초로 진입시에는 0,0지점에서 시작점을 잡고 가중치는 0, 방향을 -1로 잡아를 수행하였습니다.</li><li>(3) 직선의 경우 비용이 100, 곡선이 포함된 경우 (곡선+직선)의 비용을 더해주어야지 해당되는 비용을 모두 구할 수 있습니다.</li><li>(4) 만약에 현재 보드에값보다 직선,곡선을 돌고 더 작은값이 있다면 값을 갱신하면서 bfs를 수행하는 형식으로 모든지점을 탐색할 수 있도록하였습니다.</li></ul><blockquote><p>시간복잡도</p></blockquote><p>인접리스트 BFS -&gt; O(V+E)</p><h2 id="soseukodeu"><a href="#soseukodeu" class="header-anchor">2.2. </a><a class="markdownIt-Anchor" href="#소스코드"></a> 소스코드</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">programmers_</span>경주로건설<span class="title">_kgh</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span>[][] dir = &#123;&#123;<span class="number">1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,-<span class="number">1</span>&#125;,&#123;-<span class="number">1</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">1</span>&#125;&#125;;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> n;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> answer;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        solution(<span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;,&#123;<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>&#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">solution</span><span class="params">(<span class="keyword">int</span>[][] board)</span> </span>&#123;</span><br><span class="line">        n = board.length;</span><br><span class="line">        answer = Integer.MAX_VALUE;</span><br><span class="line">        bfs(<span class="number">0</span>,<span class="number">0</span>,-<span class="number">1</span>,<span class="number">0</span>,board);</span><br><span class="line">        System.out.println(answer);</span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">bfs</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y,<span class="keyword">int</span> d, <span class="keyword">int</span> w,<span class="keyword">int</span>[][] board)</span> </span>&#123;</span><br><span class="line">        Queue&lt;Graph&gt; q = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">        q.add(<span class="keyword">new</span> Graph(x,y,d,w));</span><br><span class="line">        <span class="keyword">while</span>(!q.isEmpty())&#123;</span><br><span class="line">            Graph g = q.remove();</span><br><span class="line">            <span class="keyword">int</span> dx = g.x;</span><br><span class="line">            <span class="keyword">int</span> dy = g.y;</span><br><span class="line">            <span class="keyword">int</span> dDirection = g.direction;</span><br><span class="line">            <span class="keyword">int</span> dWeight = g.weight;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(dx == n-<span class="number">1</span> &amp;&amp; dy == n-<span class="number">1</span>)&#123;</span><br><span class="line">                answer = Math.min(answer, dWeight);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">4</span>; i++)&#123;</span><br><span class="line">                <span class="keyword">int</span> mx = dx + dir[i][<span class="number">0</span>];</span><br><span class="line">                <span class="keyword">int</span> my = dy + dir[i][<span class="number">1</span>];</span><br><span class="line">                <span class="keyword">int</span> mWeight = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">if</span>(mx &gt;= <span class="number">0</span> &amp;&amp; mx &lt; n &amp;&amp; my &gt;= <span class="number">0</span> &amp;&amp; my &lt; n)&#123;</span><br><span class="line">                    <span class="comment">// 같은 방향이거나 처음값이 들어온 경우 (직선=100원)</span></span><br><span class="line">                    <span class="keyword">if</span>(i == dDirection || dDirection == -<span class="number">1</span>)&#123;</span><br><span class="line">                        mWeight = dWeight + <span class="number">100</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 다른방향으로 꺾은 경우 (직선=100+곡선=500)</span></span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        mWeight = dWeight + <span class="number">600</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="comment">// 갈수있으며 해당 가중치값보다 더 작으면 갱신</span></span><br><span class="line">                    <span class="keyword">if</span>(board[mx][my] == <span class="number">0</span> || board[mx][my] &gt;= mWeight)&#123;</span><br><span class="line">                        board[mx][my] = mWeight;</span><br><span class="line">                        q.add(<span class="keyword">new</span> Graph(mx,my,i,mWeight));</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Graph</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> x;</span><br><span class="line">        <span class="keyword">int</span> y;</span><br><span class="line">        <span class="keyword">int</span> direction;</span><br><span class="line">        <span class="keyword">int</span> weight;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Graph</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y, <span class="keyword">int</span> direction, <span class="keyword">int</span> weight)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.x = x;</span><br><span class="line">            <span class="keyword">this</span>.y = y;</span><br><span class="line">            <span class="keyword">this</span>.direction = direction;</span><br><span class="line">            <span class="keyword">this</span>.weight = weight;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;peurogeuraemeoseu-gyeongjurogeonseol&quot;&gt;&lt;a href=&quot;#peurogeuraemeoseu-gyeongjurogeonseol&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdow
      
    
    </summary>
    
    
      <category term="Programmers" scheme="http://gwanhyeon.github.io/categories/programmers/"/>
    
    
      <category term="BFS" scheme="http://gwanhyeon.github.io/tags/bfs/"/>
    
      <category term="프로그래머스" scheme="http://gwanhyeon.github.io/tags/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4/"/>
    
  </entry>
  
  <entry>
    <title>프로그래머스 셔틀버스</title>
    <link href="http://gwanhyeon.github.io/Programmers-20210216-programmers-%EC%85%94%ED%8B%80%EB%B2%84%EC%8A%A4/"/>
    <id>http://gwanhyeon.github.io/Programmers-20210216-programmers-%EC%85%94%ED%8B%80%EB%B2%84%EC%8A%A4/</id>
    <published>2021-02-16T09:15:13.000Z</published>
    <updated>2021-02-16T09:19:27.654Z</updated>
    
    <content type="html"><![CDATA[<h1 id="peurogeuraemeoseu-syeoteulbeoseu"><a href="#peurogeuraemeoseu-syeoteulbeoseu" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#프로그래머스-셔틀버스"></a> <a href="https://programmers.co.kr/learn/courses/30/lessons/17678" target="_blank" rel="noopener">프로그래머스 셔틀버스 </a></h1><h2 id="munje"><a href="#munje" class="header-anchor">1.1. </a><a class="markdownIt-Anchor" href="#문제"></a> 문제</h2><p>셔틀버스<br>카카오에서는 무료 셔틀버스를 운행하기 때문에 판교역에서 편하게 사무실로 올 수 있다. 카카오의 직원은 서로를 '크루’라고 부르는데, 아침마다 많은 크루들이 이 셔틀을 이용하여 출근한다.</p><p>이 문제에서는 편의를 위해 셔틀은 다음과 같은 규칙으로 운행한다고 가정하자.</p><p>셔틀은 09:00부터 총 n회 t분 간격으로 역에 도착하며, 하나의 셔틀에는 최대 m명의 승객이 탈 수 있다.<br>셔틀은 도착했을 때 도착한 순간에 대기열에 선 크루까지 포함해서 대기 순서대로 태우고 바로 출발한다. 예를 들어 09:00에 도착한 셔틀은 자리가 있다면 09:00에 줄을 선 크루도 탈 수 있다.<br>일찍 나와서 셔틀을 기다리는 것이 귀찮았던 콘은, 일주일간의 집요한 관찰 끝에 어떤 크루가 몇 시에 셔틀 대기열에 도착하는지 알아냈다. 콘이 셔틀을 타고 사무실로 갈 수 있는 도착 시각 중 제일 늦은 시각을 구하여라.</p><p>단, 콘은 게으르기 때문에 같은 시각에 도착한 크루 중 대기열에서 제일 뒤에 선다. 또한, 모든 크루는 잠을 자야 하므로 23:59에 집에 돌아간다. 따라서 어떤 크루도 다음날 셔틀을 타는 일은 없다.</p><p>입력 형식<br>셔틀 운행 횟수 n, 셔틀 운행 간격 t, 한 셔틀에 탈 수 있는 최대 크루 수 m, 크루가 대기열에 도착하는 시각을 모은 배열 timetable이 입력으로 주어진다.</p><p>0 ＜ n ≦ 10<br>0 ＜ t ≦ 60<br>0 ＜ m ≦ 45<br>timetable은 최소 길이 1이고 최대 길이 2000인 배열로, 하루 동안 크루가 대기열에 도착하는 시각이 HH:MM 형식으로 이루어져 있다.<br>크루의 도착 시각 HH:MM은 00:01에서 23:59 사이이다.<br>출력 형식<br>콘이 무사히 셔틀을 타고 사무실로 갈 수 있는 제일 늦은 도착 시각을 출력한다. 도착 시각은 HH:MM 형식이며, 00:00에서 23:59 사이의 값이 될 수 있다.</p><p>입출력 예제<br>n    t    m    timetable    answer<br>1    1    5    [08:00, 08:01, 08:02, 08:03]    09:00<br>2    10    2    [09:10, 09:09, 08:00]    09:09<br>2    1    2    [09:00, 09:00, 09:00, 09:00]    08:59<br>1    1    5    [00:01, 00:01, 00:01, 00:01, 00:01]    00:00<br>1    1    1    [23:59]    09:00<br>10    60    45    [23:59,23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59, 23:59]</p><h2 id="keompyutingjeog-sago"><a href="#keompyutingjeog-sago" class="header-anchor">1.2. </a><a class="markdownIt-Anchor" href="#컴퓨팅적-사고"></a> 컴퓨팅적 사고</h2><p>해당 문제는 시간으로 주어진 값을 파싱하여 푸는 단순 구현문제였습니다. 시간관련한 문제에서 처음에 접근할때 어려움이 조금이 있었는데, 차근차근 하나씩 풀어나간 문제였습니다.</p><blockquote><p>제가 문제를 풀때 고려하였던 점은 다음과 같습니다.</p></blockquote><ul><li>(1) 타임테이블로 주어진 값들을 모두 &quot;분&quot;단위로 변경</li><li>(2) 순서대로 온다는 보장이 없으므로 sort</li><li>(3) 셔틀버스 시작시간은 09:00 이므로 9 * 60</li><li>(4) 셔틀버스 운행전에 도착한 크루가 있는경우(크루의 탑승객의수 증가 + 크루의 진행된 인덱스의 개수)</li><li>(5) 버스에 정원이 다 차지 않은 경우, 버스도착시간에 콘 도착</li><li>(5) 버스 정원이 모두 가득찼을 경우, 운행을 종료시키고 마지막지점까지 도달하여 콘은 마지막 프렌즈 도착시간 이전타임 보다 1분 일찍 오면 콘이 오는시간</li><li>(6) 아직 더 탈인원이 있다면 다음 운행버스 호출</li><li>(7) 정답은 hh:mm 형식이므로 convertToString 함수 호출하여 정답 반환</li></ul><p>해당 문제에서 가장 중요했던점은 시간을 &quot;분단위&quot;로 변환하는것이고 해당 로직에서 셔틀이 시작하는 시점은 09:00부터 시작된다는점입니다. 처음에 문제를 이해하는데 많은 시간이 소요된 것 같습니다.</p><h2 id="soseukodeu"><a href="#soseukodeu" class="header-anchor">1.3. </a><a class="markdownIt-Anchor" href="#소스코드"></a> 소스코드</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">programmers_</span>셔틀버스<span class="title">_kgh</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        solution(<span class="number">1</span>,<span class="number">1</span>,<span class="number">5</span>,<span class="keyword">new</span> String[]&#123;<span class="string">"08:00"</span>,<span class="string">"08:01"</span>,<span class="string">"08:02"</span>,<span class="string">"08:03"</span>&#125;);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">static</span> String <span class="title">solution</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> t, <span class="keyword">int</span> m, String[] timetable)</span> </span>&#123;</span><br><span class="line">        String answer = <span class="string">""</span>;</span><br><span class="line">        <span class="comment">//1. 모든 타임테이블 시간을 분단위로 변경</span></span><br><span class="line">        <span class="keyword">int</span>[] times = convertToTime(timetable);</span><br><span class="line">        <span class="comment">//2. 도착순서대로 정렬을 진행</span></span><br><span class="line">        Arrays.sort(times);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> busTime = <span class="number">9</span> * <span class="number">60</span>;</span><br><span class="line">        <span class="comment">// 몇번째 크루까지 탑승했는지</span></span><br><span class="line">        <span class="keyword">int</span> busIdx = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> cornTime = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 운행횟수만큼 진행</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;n; i++)&#123;</span><br><span class="line">            <span class="comment">// 버스탑승인원</span></span><br><span class="line">            <span class="keyword">int</span> busCrewCnt = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=busIdx; j&lt;times.length; j++)&#123;</span><br><span class="line">                <span class="comment">// 버스 출발전에 도착한크루가 있는 경우</span></span><br><span class="line">                <span class="keyword">if</span>(times[j] &lt;= busTime)&#123;</span><br><span class="line">                    busCrewCnt++;</span><br><span class="line">                    busIdx++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 버스 정원 꽉찬 경우</span></span><br><span class="line">                <span class="keyword">if</span>(busCrewCnt == m)&#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>(i == n-<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="comment">// 버스에 정원이 다 차지 않은 경우, 버스도착시간에 콘 도착</span></span><br><span class="line">                <span class="keyword">if</span>(busCrewCnt &lt; m)&#123;</span><br><span class="line">                    cornTime = busTime;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 버스의 정원이 다 찬경우, 콘은 마지막에 탄 프렌즈보다 1분먼저오면 탈수 있음</span></span><br><span class="line">                <span class="keyword">else</span> &#123;</span><br><span class="line">                    cornTime = times[busIdx-<span class="number">1</span>]-<span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 다음 셔틀 호출하기</span></span><br><span class="line">            busTime += t;</span><br><span class="line">        &#125;</span><br><span class="line">        answer = convertToString(cornTime / <span class="number">60</span>, cornTime % <span class="number">60</span>);</span><br><span class="line">        System.out.println(answer);</span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 분단위 hh:mm형식 변환</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> h</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> m</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">convertToString</span><span class="params">(<span class="keyword">int</span> h, <span class="keyword">int</span> m)</span> </span>&#123;</span><br><span class="line">        String hour = Integer.toString(h);</span><br><span class="line">        String minute = Integer.toString(m);</span><br><span class="line">        <span class="keyword">if</span>(hour.length() == <span class="number">1</span>)&#123;</span><br><span class="line">            hour = <span class="string">"0"</span> + hour;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(minute.length() == <span class="number">1</span>)&#123;</span><br><span class="line">            minute = <span class="string">"0"</span> + minute;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hour + <span class="string">":"</span> + minute;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hh:mm형식 분단위 변환</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> timetable</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">int</span>[] convertToTime(String[] timetable) &#123;</span><br><span class="line">        <span class="keyword">int</span>[] times = <span class="keyword">new</span> <span class="keyword">int</span>[timetable.length];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;timetable.length; i++)&#123;</span><br><span class="line">            String[] time = timetable[i].split(<span class="string">":"</span>);</span><br><span class="line">            <span class="keyword">int</span> h = Integer.parseInt(time[<span class="number">0</span>]);</span><br><span class="line">            <span class="keyword">int</span> m = Integer.parseInt(time[<span class="number">1</span>]);</span><br><span class="line">            <span class="keyword">int</span> total = h * <span class="number">60</span> + m;</span><br><span class="line">            times[i] = total;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> times;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;peurogeuraemeoseu-syeoteulbeoseu&quot;&gt;&lt;a href=&quot;#peurogeuraemeoseu-syeoteulbeoseu&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anch
      
    
    </summary>
    
    
      <category term="Programmers" scheme="http://gwanhyeon.github.io/categories/programmers/"/>
    
    
      <category term="완전탐색" scheme="http://gwanhyeon.github.io/tags/%EC%99%84%EC%A0%84%ED%83%90%EC%83%89/"/>
    
      <category term="프로그래머스" scheme="http://gwanhyeon.github.io/tags/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4/"/>
    
  </entry>
  
  <entry>
    <title>02 마이크로서비스 아키텍처</title>
    <link href="http://gwanhyeon.github.io/MSA-20210212-02-%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98/"/>
    <id>http://gwanhyeon.github.io/MSA-20210212-02-%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98/</id>
    <published>2021-02-11T14:59:08.000Z</published>
    <updated>2021-02-12T15:32:39.018Z</updated>
    
    <content type="html"><![CDATA[<h1 id="maikeuroseobiseu-akitegceo"><a href="#maikeuroseobiseu-akitegceo" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#마이크로서비스-아키텍처"></a> 마이크로서비스 아키텍처</h1><h2 id="maikeuroseobiseu-akitegceoyi-gaenyeom"><a href="#maikeuroseobiseu-akitegceoyi-gaenyeom" class="header-anchor">1.1. </a><a class="markdownIt-Anchor" href="#마이크로서비스-아키텍처의-개념"></a> 마이크로서비스 아키텍처의 개념</h2><p>마이크로서비스 아키텍처(microservice architecture)는 마이크로서비스가 실행 될 수 있는 아키텍처를 뜻합니다. 마이크로서비스, 즉 아주 작은 단위로 동작하는 서비스가 구동되도록 시스템 및 소프트웨어의 구성과 구성 요소간의 관계를 정의한 아키텍처입니다.</p><p>마이크로서비스 아키텍처의 구성 요소는 서비스와 이를 실행할 수 있게하는 여러 기술적 환경입니다. 마이크로서비스 아키텍처를 다시 한번 정리해보면, 아주 작은 단위의 서비스들을 실행할 수 있도록 구성하기 위한 서비스 중심의 아키텍처입니다.</p><h2 id="monolriseu-akitegceowayi-caijeom"><a href="#monolriseu-akitegceowayi-caijeom" class="header-anchor">1.2. </a><a class="markdownIt-Anchor" href="#모놀리스-아키텍처와의-차이점"></a> 모놀리스 아키텍처와의 차이점</h2><p>모놀리스 아키텍처 구조에서는 하나의 애플리케이션에 데이터가 연결된 구성이 일반적으로 되어있고, 애플리케이션의 크기가 클 경우 변경과 배포가 쉽지 않은 구조를 띄고 있습니다.</p><p>이에반해, 마이크로서비스 아키텍처는 서비스와 데이터가 분할되어 작은 서비스들이 여러 독립된 형태로 서비스를 제공하여 필요에 따라 서로 참고하여 사용됩니다.</p><p>즉, 모놀리스 아키텍처와의 차이점은 하나의 애플리케이션 형태가 아닌 분할된 다수의 서비스라는점입니다. 애플리케이션 기능뿐만 아니라 데이터까지 분리하여 격리된 독립된 환경으로 구성되는것이 가장 큰 차이점이 됩니다.</p><p>단일 애플리케이션 형태인 모놀리스 아키텍처로 구성된 시스템에서는 클라이언트 요청에 대한 처리 반응 속도가 아주 중요한 요소인데, 데이터 조회에 대한 부하나 이를 처리하는 애플리케이션이 문제가 생긴다면 시스템이 동작하지 않는 결과를 초래합니다.</p><p>이것들을 대응하기 위해서는 <code>로드밸런서, 2중화,3중화, 백업 및 복구방안</code>이 아주 중요한 아키텍처 결정 사항이고 환경 구성을 위하여 많은 시스템 리소스(resource)를 투자합니다.</p><blockquote><p>온프로미스 아키텍처</p></blockquote><p>시스템이 받을 부하를 사전에 분석예측하는 하드웨어 스케일업 과정과 애플리케이션의 빠른 대응과 데이터 조회의 성닝 개선을 위한 튜닝(tuning) 활동등이 아키텍트의 주요한 관심사였습니다.</p><blockquote><p>마이크로서비스 아키텍처</p></blockquote><p>서비스의 수평적 확장에 유연성과 탄력성을 높여 성능적 이슈에 대해서 유연하게 대처할 수 있는 구조를 가집니다. 당연히 단일 애플리케이션 구조에서 보다 많은 서비스를 관리하는 문제로 서비스들을 관리하고 제어하기 위한 에코시스템(eco-system)들의 역할이 아주 중요하고, 자동화 시각화가 잘 고려되지않으면 오히려 운영 측면의 위험성은 증가하게 됩니다.</p><h2 id="seobiseu-jihyang-akitegceo"><a href="#seobiseu-jihyang-akitegceo" class="header-anchor">1.3. </a><a class="markdownIt-Anchor" href="#서비스-지향-아키텍처"></a> 서비스 지향 아키텍처</h2><p>대규모 시스템 환경에서 업무처리 단위를 각가의 서비스로 반영하여 데이터 중심이 아닌 전체 시스템을 서비스 중심으로 설계하는 아키텍처 스타일입니다.</p><p>마이크로 서비스가 주목받기 이전부터 기업환경에서 중복되는 프로세스나 업무들을 하나의 서비스단위로 개발하여 각 서비스는 호출 가능한 상태로 개발하자는 노력이 계속되어 왔습니다.</p><blockquote><p>서비스 지향 아키텍처의 특징</p></blockquote><ol><li>서비스 계약</li></ol><p>서비스와 서비스소비자와의 계약을 뜻합니다.<br>서비스는 약속한 기능을 수행해야하고 서비스 소비자는 서비스를 사용하기 위한 계약 규칙을 준수해야합니다. 서비스계약은 때에 따라서는 서비스 자체에 문제가 발생할 수도 있고, 서비스가 개선될 수도 있습니다. 버전1 -&gt; 버전2로 기능업그레이드가 가능할 수 있습니다.</p><ol start="2"><li>서비스의 가용성</li></ol><p>서비스지향 아키텍처에서 서비스들의 가용성을 보장하기 위한 소프트웨어 방법으로 타임아웃 기능 구현을 제안합니다.</p><p>일정 시간동안 서비스 요청에 대한 반응이 없으면 기존 요청경로를 차단하고, 다른 경로로 요청 경로를 변경하는 기능을 가동하여 서비스가 정상적으로 수행되도록 합니다.<br>정상적으로 동작하던 서비스가 문제가 발생하여 서비스 요청에 대한 응답 지연이 발생하면 정상적인 다른 서비스로 요청 경로를 변경하는 기능이 작동합니다.<br>즉, 서비스 가용성을 유지하기 위한 방법을 서비스 라우팅이라고 하며 라우팅 기능을 L4/L7은 하드 웨어 장비를 이용하여 구현할 수도 있고, 서킷 브레이커(circuit breaker) 같은 소프트웨어 기능으로 구현할 수 있습니다.</p><ol start="3"><li>보안</li></ol><p>하나의 서비스가 다른 서비스를 호출할 경우 별도의 인증 및 권한 확인 없이 바로 호출할 수 있는 구조가 되면 자칫 보안상 문제가 될 수 있습니다. 권한에 관한 제어권을 서비스 자체에 넘기게 되면 이러한 문제는 다소해결 될 수 있습니다.</p><ol start="4"><li>트랜잭션(transaction)</li></ol><p>서비스가 분할되고 서비스에서 발생하는 트랜잭션들에 대한 일관성 유지입니다. 일반적으로 서비스 지향 아키텍처에서는 성능상의 문제로 데이터베이스 읽기 전용 데이터 저장소와 데이터베이스 쓰기, 데이터 저장소를 분리 구성하도록 권고합니다. 하지만, 쓰인 데이터를 읽기 위해서는 데이터의 이동이 필요하고 이 부분에서 데이터의 일관성과 실시간 동기화 이슈가 발생학세 됩니다.</p><blockquote><p>BASE(Basically Available Soft State Eventual Consistency)트랜잭션</p></blockquote><p>basically available의 대표적인 기술 메커니즘은 Optional Locking, Queue이고 soft state는 외부전달 데이터로 인해 상태가 갱신되는것 입니다.</p><p>즉, 두 개의 노드가 있으면 한쪽에서 전달된 데이터로 인해 다른 한쪽 노드가 갱신된다는 사앙이며 eventual consistency는 두 노드의 데이터가 일시적으로 불일치한 시점이 있고, 일관성이 없는 상태이지만 결국에는 두 노드의 데이터가 같아진다는 개념이 됩니다.</p><ol start="5"><li>서비스 관리</li></ol><p>서비스들의 수가 많아지면 이들간의 관계를 관리해야합니다. 상황에 따라서 서비스가 동적으로 증가하여 과부하나 오류 상황에서도 지속적으로 가능한 서비스가 가능하도록 관리됩니다.</p><p>특정 서비스의 오류가 발생하면 자연스럽게 다른 정상적인 서비스로 요청 흐름의 변경도 가능하고 실시간으로 관리되고 시각화하여 모니터링이 진행되어야합니다.</p><h2 id="soawa-maikeuroseobiseu-akitegceoneun-mueosi-dareulggayo"><a href="#soawa-maikeuroseobiseu-akitegceoneun-mueosi-dareulggayo" class="header-anchor">1.4. </a><a class="markdownIt-Anchor" href="#soa와-마이크로서비스-아키텍처는-무엇이-다를까요"></a> SOA와 마이크로서비스 아키텍처는 무엇이 다를까요?</h2><p>비즈니스 변화 대응을 위한 서비스 중심의 아키텍처라는 점에서는 공통점이 있지만 서비스 상대적 크기와 관심사, 오너십(ownership) 기술구조에서 차이가 있습니다.</p><p>비즈니스 -&gt; SOA, 마이크로서비스 아키텍처</p><p>SOA와 마이크로 서비스 아키텍처의 공통점은 소프트웨어를 설계할 때 서비스 중심의 설계를 지향하는것이며 기능 중심의 모듈 재사용보다는 상위 수준의 서비스 수준에 재사용성에 초점을 맞추게됩니다. 다만 SOA는 비즈니스측면에서의 서비스 재사용성을 강조하는 반면에 마이크로서비스는 한가지 작은 서비스에 집중하기를 강조합니다.</p><p>SOA는 되도록 많은 서비스의 공유를 위해 ESB(Enterprise Service Bus)라는 서비스 채널을 이용하여 서비스를 공유하고 재사용하는데 초점을 맞춘다면, 마이크로서비스는 되도록 서비스를 공유하지않고 독립되어 실행하는것을 지향합니다. 즉, 시스템의 탄력성을 높입니다.</p><blockquote><p>SOA 마이크로서비스 차이점</p></blockquote><ol><li>서비스 상대적 크기와 관심사의 차이점<br>마이크로서비스아키텍처는 서비스는 작고 한가지 일에 집중하는 반면, SOA서비스는 비즈니스에 집중합니다.</li></ol><p>CRM(Customer Relationship Management) 통합 구축 프젝트에서는 고객정보 관리라는 큰 서비스가 있으면 마이크로서비스 관점에서는 고객빌링관리 등의 업무를 더 세분화 시킵니다.</p><p>예를 들면, 청구 조회,등록,수정,삭제 서비스, 신용 정보 조회, 등록, 수정, 삭제 등 더 작게 세분화 시킬 수 있습니다.</p><ol start="2"><li>서비스 오너십 측면에서 마이크로서비스는 하나의 작은 팀에서 관리합니다.</li></ol><p>서비스의 개발에서 운영까지 오너십과 권한을 가지는 독립된 단위의 서비스이며 조직 구성과도 관련이 있는 부분입니다. 마이크로서비스는 하나의 독립된 팀에서 개발하고 관리하고 반면의 SOA의 서비스는 비즈니스 프로세스의 흐름과 관련된 서비스를 공유하기 위해서 중앙의 인프라 미들웨어에 탑재하고 필요에 따라 연결 및 조합하여 새로운 서비스를 만들어내게 됩니다.</p><p>이 과정에서 업무팀, 공통 기능 개발팀, 개발팀의 상호협업이 반드시 필요하게 됩니다.</p><ol start="3"><li>서비스 공유 정도의 차이</li></ol><p>마이크로서비스는 서비스 공유의 최소화를 지향하는 반면에 SOA는 되도록 많은 서비스의 공유를 지향합니다.</p><p>마이크로 서비스 아키텍처는 서비스 간의 결합도를 낮추어 변화에 능동적으로 대응하기 위한 민첩성에 초점을 두지만, SOA는 재사용을 높여 비용을 절감하고 품질을 높이는데 초점을 두게 됩니다.</p><ol start="4"><li>기술 방식의 차이</li></ol><p>SOA가 공통 서비스를 ESB라는 공통된 채널에 모아 사업 측면에서 공통 서비스 형식으로 서비스를 제공하였다면 마이크로 서비스는 각각의 독립된 서비스가 필요에 따라 노출된 REST API(Application Programming Interface)를 사용합니다.</p><p>SOA는 흩어져 있던 같은 역할을 하는 서비스들을 통합하여 ESB에 담아서 필요할때마다 사용할 수 있는 기술 구조이고 마이크로 서비스 아키텍처는 흩어져있는 서비스들의 통합없이 각각의 서비스가 노출한 RESTful API정보를 보고 필요할때 호출하여 사용하는것 입니다. 결국 SOA는 통합과 공유 마이크로 서비스 아키텍처는 분산과 독립이라는 개념으로 구분할 수 있습니다.</p><blockquote><p>서비스 메커니즘</p></blockquote><p>SOA는 통합된 서비스들을 UDDI(Universal Description Discovery and Integration)라는 서비스 저장소에 등록하고 WSDL(Web Service Description Langauge)라는 서비스 저장소에 등록하고 WSDL에는 UDDI에 공유한 서비스의 명세가 담겨있고, 이 명세를 참고하여 서비스를 사용하는 클라이언트는 'stub’이라는 클래스를 생성하여 서버와 SOAP(Simple Object Access Protocol)을 이용하여 통신하게 됩니다. 만약 WSDL의 명세가 바뀌면 이를 참조하는 모든 클라이언트 프로그램들을 바꿔야하고 변경이나 장애에 대한 결합도가 아주 높아지게 됩니다.</p><p>이해 반해, 마이크로 서비스 아키텍처는 클라이언트에서 서비스 제공자가 노출해놓은 RESTful API를 보고 호출하여 받는 결과값만 활용하므로 구현이 쉽고, 서비스 제공자가 제공하는 서비스의 인터페이스에 대한 변경 영향은 발생하지 않습니다. 서비스 제공자가 제공하는 결과값이 다소 바뀔 수 있어도 그로 인한 영향도는 SOA만큼이나 결합도가 높지 않습니다. 마이크로 서비스 아키텍처와 SOA는 아키텍처의 기술 구조와 다른 아키텍처 스타일이지만, 비즈니스에 민첩한 대응을 위한 아키텍처구조와 아키텍처의 모습이 서비스를 지향해야하고 이를 민첩하게 반응하기 위하여 기술 메커니즘에서는 같은 사상을 가지게 됩니다.</p><blockquote><p>마이크로서비스 아키텍처와 SOA 특징 비교</p></blockquote><table><thead><tr><th>구분</th><th>마이크로서비스 아키텍처</th><th>SOA</th></tr></thead><tbody><tr><td>사상</td><td>서비스지향</td><td>서비스 지향</td></tr><tr><td>서비스 오너십</td><td>조직(팀)단위 자율성 부여</td><td>조직간 협업</td></tr><tr><td>서비스 크기</td><td>SOA 대비 작음</td><td>마이크로서비스아키텍처 대비 큼</td></tr><tr><td>서비스 공유 정보</td><td>서비스간 독립</td><td>서비스 공유</td></tr><tr><td>서비스 공유 방식</td><td>API</td><td>서비스공유를 위한 미들웨어</td></tr><tr><td>서비스 통신 방식</td><td>RESTful API</td><td>SOAP, WSDL, UDDI, ESB</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;maikeuroseobiseu-akitegceo&quot;&gt;&lt;a href=&quot;#maikeuroseobiseu-akitegceo&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#마
      
    
    </summary>
    
    
      <category term="MSA" scheme="http://gwanhyeon.github.io/categories/msa/"/>
    
    
      <category term="MSA" scheme="http://gwanhyeon.github.io/tags/msa/"/>
    
  </entry>
  
  <entry>
    <title>프로그래머스 합승택시요금</title>
    <link href="http://gwanhyeon.github.io/Programmers-20210208-programmers-%ED%95%A9%EC%8A%B9%ED%83%9D%EC%8B%9C%EC%9A%94%EA%B8%88/"/>
    <id>http://gwanhyeon.github.io/Programmers-20210208-programmers-%ED%95%A9%EC%8A%B9%ED%83%9D%EC%8B%9C%EC%9A%94%EA%B8%88/</id>
    <published>2021-02-08T11:19:28.000Z</published>
    <updated>2021-02-08T11:21:51.889Z</updated>
    
    <content type="html"><![CDATA[<h1 id="peurogeuraemeoseu-habseungtaegsiyogeum"><a href="#peurogeuraemeoseu-habseungtaegsiyogeum" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#프로그래머스-합승택시요금"></a> <a href="https://developmentspace.tistory.com/98?category=737181" target="_blank" rel="noopener">프로그래머스 합승택시요금 </a></h1><h2 id="keompyutingjeog-sago"><a href="#keompyutingjeog-sago" class="header-anchor">1.1. </a><a class="markdownIt-Anchor" href="#컴퓨팅적-사고"></a> 컴퓨팅적 사고</h2><blockquote><p>플로이드워셜알고리즘을 이용한 최단경로 문제</p></blockquote><ul><li>(1) 모든 맵에 지점의 개수 * 택시비용의 최댓값인 (100 * 200000)으로 값을 초기화해줍니다.</li><li>(2) 자기자신을 바라보는것들은 0으로 초기화합니다</li><li>(3) 배열값을 복사하여 배열들의 값을 재 세팅을 해줍니다.</li><li>(4) 플로이드워셜알고리즘의 점화식을 도출해냅니다. graph[i][j] = Math.min(graph[i][j], graph[i][k] + graph[k][j])</li><li>(5) 점화식으로 도출해낸 모든 비용의 배열에서 출발지점 -&gt; (모든지점을 탐색의 비용 + 모든지점의 탐색 -&gt; A의 도착의 비용 + 모든지점의 탐색 -&gt; B의 도착의 비용)의 최솟값을 구해줍니다.</li><li>(6) 결국, 시작점에서 출발하여 거쳐간 지점중에 + A도착점 + B도착점의 최솟값을 탐색을 하게 되면 모든 최단 경로의 비용을 구할 수 있게 됩니다.</li><li>(7) 시간복잡도 O(N^3)</li></ul><h2 id="soseukodeu"><a href="#soseukodeu" class="header-anchor">1.2. </a><a class="markdownIt-Anchor" href="#소스코드"></a> 소스코드</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">programmers_</span>합승택시요금<span class="title">_kgh</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span>[][] graph;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> INF = <span class="number">200</span> * <span class="number">100000</span>;      <span class="comment">// 지점의 개수 * 택시비용 최댓</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        solution(<span class="number">6</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">2</span>,<span class="keyword">new</span> <span class="keyword">int</span>[][]&#123;</span><br><span class="line">                &#123;<span class="number">4</span>, <span class="number">1</span>, <span class="number">10</span>&#125;,</span><br><span class="line">                &#123;<span class="number">3</span>, <span class="number">5</span>, <span class="number">24</span>&#125;,</span><br><span class="line">                &#123;<span class="number">5</span>, <span class="number">6</span>, <span class="number">2</span>&#125;,</span><br><span class="line">                &#123;<span class="number">3</span>, <span class="number">1</span>, <span class="number">41</span>&#125;,</span><br><span class="line">                &#123;<span class="number">5</span>, <span class="number">1</span>, <span class="number">24</span>&#125;,</span><br><span class="line">                &#123;<span class="number">4</span>, <span class="number">6</span>, <span class="number">50</span>&#125;,</span><br><span class="line">                &#123;<span class="number">2</span>, <span class="number">4</span>, <span class="number">66</span>&#125;,</span><br><span class="line">                &#123;<span class="number">2</span>, <span class="number">3</span>, <span class="number">22</span>&#125;,</span><br><span class="line">                &#123;<span class="number">1</span>, <span class="number">6</span>, <span class="number">25</span>&#125;&#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> n 노드의 개수</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> s 출발지점</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> a A 도착지점</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> b B 도착 지점</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fares</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">int</span> <span class="title">solution</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> s, <span class="keyword">int</span> a, <span class="keyword">int</span> b, <span class="keyword">int</span>[][] fares)</span></span>&#123;</span><br><span class="line">        graph = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">201</span>][<span class="number">201</span>];</span><br><span class="line">        <span class="keyword">int</span> answer = INF;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 1. 무한으로 초기화</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;<span class="number">201</span>; i++)&#123;</span><br><span class="line">            Arrays.fill(graph[i], INF);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2. 자기 자신 0 초기화</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=n; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(i == j)&#123;</span><br><span class="line">                    graph[i][j] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 3.배열값 복사</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;fares.length; i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> x = fares[i][<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">int</span> y = fares[i][<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">int</span> w = fares[i][<span class="number">2</span>];</span><br><span class="line">            graph[x][y] = w;</span><br><span class="line">            graph[y][x] = w;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 4. 플로이드 워셜: 모든 경우에서 거쳐가는경로의 최소비용을 구합니다.</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">1</span>; k&lt;=n; k++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>; j&lt;=n; j++)&#123;</span><br><span class="line">                    graph[i][j] = Math.min(graph[i][j], graph[i][k] + graph[k][j]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5. 거쳐가는 경로를 모두 합한값의 최솟값을 구해줍니다.</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>; i&lt;=n; i++)&#123;</span><br><span class="line">            answer = Math.min(answer,graph[s][i] + graph[i][a] + graph[i][b]);</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(answer);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;peurogeuraemeoseu-habseungtaegsiyogeum&quot;&gt;&lt;a href=&quot;#peurogeuraemeoseu-habseungtaegsiyogeum&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;mar
      
    
    </summary>
    
    
      <category term="Programmers" scheme="http://gwanhyeon.github.io/categories/programmers/"/>
    
    
      <category term="프로그래머스" scheme="http://gwanhyeon.github.io/tags/%ED%94%84%EB%A1%9C%EA%B7%B8%EB%9E%98%EB%A8%B8%EC%8A%A4/"/>
    
      <category term="플로이드워셜알고리즘" scheme="http://gwanhyeon.github.io/tags/%ED%94%8C%EB%A1%9C%EC%9D%B4%EB%93%9C%EC%9B%8C%EC%85%9C%EC%95%8C%EA%B3%A0%EB%A6%AC%EC%A6%98/"/>
    
  </entry>
  
  <entry>
    <title>JPA 엔티티(Entity)</title>
    <link href="http://gwanhyeon.github.io/JPA-20210219-jpa-03-%EC%97%94%ED%8B%B0%ED%8B%B0/"/>
    <id>http://gwanhyeon.github.io/JPA-20210219-jpa-03-%EC%97%94%ED%8B%B0%ED%8B%B0/</id>
    <published>2021-02-05T06:15:32.000Z</published>
    <updated>2021-02-18T16:34:19.678Z</updated>
    
    <content type="html"><![CDATA[<h1 id="entity-maeping-eonoteisyeon"><a href="#entity-maeping-eonoteisyeon" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#entity-매핑-어노테이션"></a> Entity 매핑 어노테이션</h1><ul><li><p>객체, 테이블 매핑<br>@Entity, @table</p></li><li><p>필드와 컬럼 매핑<br>@Column</p></li><li><p>기본 키 매핑<br>@Id</p></li><li><p>연관관계 매핑<br>@ManyToOne, @JoinColumn</p></li></ul><blockquote><p>Entity 의미</p></blockquote><p>@Entity가 붙은 클래스는 JPA가 관리하고 하는 엔티티라고 하며 JPA에서 사용하는 테이블과 매핑할 클래스는 @Entity는 필수로 사용되어지고 있습니다.<br>여기서 가장 중요한것은 기본 생성자는 필수로 있어야하며, final, enum, interface, inner 클래스는 사용할 수없습니다. 즉, 해당것들을 매핑이 불가능하게 됩니다. 그리고 저장할 필드에서는 final을 사용하면 안됩니다.</p><blockquote><p>Entity 속성</p></blockquote><p>name속성 같은경우는 사용할 엔티티 이름을 지정합니다. 기본값은 현재 클래스의 이름을 그대로 사용하고 같은 클래스 이름이 없으면 가급적으로 기본값을 사용하는것이 가장 좋습니다.</p><h1 id="teibeul-maeping-eonoteisyeon"><a href="#teibeul-maeping-eonoteisyeon" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#테이블-매핑-어노테이션"></a> 테이블 매핑 어노테이션</h1><p>@Table 어노테이션은 엔티티와 매핑할 테이블일 지정합니다. 테이블 매핑 어노테이션은 여러가지 속성들을 가지고 있는데 대표적인것들이 4가지로 나눌 수 있습니다.</p><ol><li>name: 매핑할 테이블 이름</li><li>catalog: 데이터베이스 catalog 매핑</li><li>schema: 데이터베이스 schema 매핑</li><li>uniqueConstraints DDL 생성 시에 유니크 제약 조건 생성</li></ol><h1 id="deiteo-beiseu-ddl-seukima"><a href="#deiteo-beiseu-ddl-seukima" class="header-anchor">3. </a><a class="markdownIt-Anchor" href="#데이터-베이스-ddl-스키마"></a> 데이터 베이스 DDL 스키마</h1><p>데이터베이스에서 스키마가 자동생성은 DDL을 애플리케이션 생성 시점에 자동 생성이 됩니다. 이것은 테이블 중심에서 객체중심으로 옮겨간 패러다임이라고 할 수 있으며 데이터베이스마다 방언(dialect) Mysql, Oracle 등 데이터베이스에 맞는 적절한 DDL을 생성시킬 수 있습니다. 이것은 데이터베이스에서 사용되는것이 아니라 현재 개발중인 DDL에서만 적용되게 됩니다.</p><h2 id="deiteobeiseu-seukima-jadong-saengseong-sogseong"><a href="#deiteobeiseu-seukima-jadong-saengseong-sogseong" class="header-anchor">3.1. </a><a class="markdownIt-Anchor" href="#데이터베이스-스키마-자동-생성속성"></a> 데이터베이스 스키마 자동 생성(속성)</h2><ol><li>craete: 기존테이블 삭제 후 다시 생성합니다.(drop + create)</li><li>create-drop: create와 같지만 종료시점에 테이블을 다시 drop시켜버립니다.</li><li>update: 변경된 부분만 반영하고 운영쪽에서는 사용하면 위험합니다.</li><li>validate: 엔티티와 테이블이 정상 매핑되었는지만 확인합니다.</li><li>none: 사용하지 않는 속성</li></ol><h3 id="kodeu-yeje"><a href="#kodeu-yeje" class="header-anchor">3.1.1. </a><a class="markdownIt-Anchor" href="#코드-예제"></a> 코드 예제</h3><p>DB Dialect 를 설정 할 수 있으며 javax로 시작하는것은 여러가지를 가지고 있는데 하이버네이트 라이브러리나 또 다른 구현체 라이브러리를 써도 사용할 수 있다. 즉, 하이버네이트 전용 옵션이라고 할 수 있습니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;property name=<span class="string">"hibernate.dialect"</span> value=<span class="string">"org.hibernate.dialect.H2Dialect"</span>/&gt;</span><br><span class="line">&lt;property name=<span class="string">"hibernate.dialect"</span> value=<span class="string">"org.hibernate.dialect.MySQL5Dialect"</span>/&gt;</span><br><span class="line">&lt;property name=<span class="string">"hibernate.dialect"</span> value=<span class="string">"org.hibernate.dialect.Oracle10gDialect"</span>/&gt;</span><br></pre></td></tr></table></figure><p>차이점이라고 하면 예를 들어 오라클같은경우는 varchar2, Mysql은 varchar과 같은 예를 들 수 있습니다. 여기서 가장 중요한점은 운영하는 서버에서는 craete, create-drop, update를 사용하면 절대 안됩니다.</p><p>개발 초기단계에는 create 또는 update를 사용하고 테스트 서버에서는 update 또는 validate를 처리할 수 있습니다. 스테이징과 운영서버는 validate 또는 none으로 처리하여 진행하면 됩니다.</p><h2 id="ddl-saengseong-gineung"><a href="#ddl-saengseong-gineung" class="header-anchor">3.2. </a><a class="markdownIt-Anchor" href="#ddl-생성-기능"></a> DDL 생성 기능</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Column</span>(nullable == <span class="keyword">false</span>, length = <span class="number">10</span>)</span><br></pre></td></tr></table></figure><p>다음과 같은 컬럼 어노테이션 속성이 있다고 가정하면 해당 컬럼은 null값이 올 수 없으며 10자를 초과할 수 없다라는 의미가 됩니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Table</span>(uniqueConstraints = &#123;UniqueConstraint(name = <span class="string">"NAME"</span>, columnNames=&#123;<span class="string">"NAME"</span>. <span class="string">"AGE"</span>&#125;)&#125;)</span><br></pre></td></tr></table></figure><p>다음과 같은 유니크 테이블 제약조건을 처리할 수도 있습니다.</p><p>즉, DDL 생성 기능은 DDL을 자동 생성할때만 사용되고 JPA실행 로직에는 영향을 주지 않는다는점을 알고 있어야합니다.</p><h1 id="pildeu-mic-keolreom-maeping"><a href="#pildeu-mic-keolreom-maeping" class="header-anchor">4. </a><a class="markdownIt-Anchor" href="#필드-및-컬럼-매핑"></a> 필드 및 컬럼 매핑</h1><blockquote><p>매핑 어노테이션 hibernate.hbm2ddl.auto</p></blockquote><ul><li>@Column: 컬럼 매핑</li><li>@Temporal: 날짜 타입 매핑</li><li>@Enumerated: enum 타입 매핑</li><li>@Lob: BLOB, CLOB 매핑(varchar 범위 넘어설때)</li><li>@Transient: 특정 필드를 매핑하지 않음.(무시)</li></ul><blockquote><p>@Column 속성</p></blockquote><ul><li>name: 필드와 매핑할 테이블의 칼럼 이름</li><li>insertable, updatable: 등록,변경 가능여부</li><li>nullable(DDL): null값의 허용 여부를 설정하고 false로 설정하면 DDL 생성시에 not null 제약조건을 붙입니다.</li><li>unique(DDL): @Table의 uniqueConstraints와 같지만 한 컬럼에 간단히 유니크 제약조건을 걸때 사용됩니다.</li><li>columnDefinition(DDL): 데이터베이스 컬럼 정보를 직접 줄 수 있습니다. (varchar(100) default ‘EMPTY’)</li><li>length(DDL): 문자 길이 제약조건, String 타입에만 사용한다.</li><li>precision, scale(DDL): BigDecimal 타입에서 사용하고 precision은 소수점을 포함한 전체 자릿수며 scale은 소수의 자릿수입니다. (double, float 타입에는 적용 X)</li></ul><blockquote><p>@Enumerated</p></blockquote><p>Java Enum타입을 매핑할때 사용하며 ORDINAL 속성은 사용하지 않는게 좋다. 왜냐하면 DB에서 값이 변경되면 누락된 값이 들어갈 수 있기 때문이다.<br>즉, String을 사용하여야한다.</p><ul><li>value 속성: EnumType.ORDINAL enum순서를 DB 저장, EnumType.STRING enum 이름을 DB 저장 (기본값은 ORDINAL)</li></ul><blockquote><p>@Temporal</p></blockquote><p>날짜 타입을 매핑할때 사용합니다. LocalDate, LocalDateTime을 사용할시에는 생략이 가능합니다.(java8문법)</p><ul><li>value 속성:</li></ul><ol><li>TemporalType.DATE: 날짜 타입과 매핑 (2021-01-01 yyyy-mm-dd)</li><li>TemporalType.TIME: 시간, 데이터베이스 time 타입과 매핑 (24:00:00 hh-mm-ss)</li><li>TemporalType.TIMESTAMP: 날짜와 시간, timestamp와 매핑(2021-01-01 24:00:00 yyyy-mm-dd hh-mm-ss)</li></ol><blockquote><p>@Lob</p></blockquote><p>데이터베이스 BLOB, CLOB 타입과 매핑</p><ul><li>@Lob에는 지정할 수 있는 속성이 없습니다.</li><li>매핑하는 필드타입이 문자면 CLOB 매핑, 나머지는 BLOB 매핑</li></ul><p>CLOB: String, char[], java.sql.CLOB<br>BLOB: byte[], java.sql.BLOB</p><blockquote><p>@Transient</p></blockquote><ul><li>필드 매핑을 하지 않습니다.</li><li>데이터베이스에 저장 및 조회를 진행하지 않습니다.</li><li>주로 메모리상에서만 임시로 어떤값을 보관하고 싶을때 사용합니다.</li></ul><h1 id="gibonki-maeping"><a href="#gibonki-maeping" class="header-anchor">5. </a><a class="markdownIt-Anchor" href="#기본키-매핑"></a> 기본키 매핑</h1><h2 id="gibon-ki-maeping-eonoteisyeon"><a href="#gibon-ki-maeping-eonoteisyeon" class="header-anchor">5.1. </a><a class="markdownIt-Anchor" href="#기본-키-매핑-어노테이션"></a> 기본 키 매핑 어노테이션</h2><p>@Id, @GeneratedValue의 두가지 어노테이션을 가지고 있습니다.</p><blockquote><p>기본키 매핑 방법</p></blockquote><p>직접 할당은 @Id를 사용하여 할당하고 자동생성을 진행하기 위해서는 @GeneratedValue을 사용합니다.</p><ul><li>IDENTITY: 데이터베이스에 위임, MYSQL</li><li>SEQUENCE: 데이터베이스 시퀀스 오브젝트 사용 Oracle, @SequenceGenerator</li><li>Table: 키 생성용 테이블 사용하고 모든 데이터베이스에서 사용될 수 있습니다. @TableGenerator</li><li>AUTO: 방언에 따라 자동 지정하고 기본값으로 세팅됩니다.</li></ul><blockquote><p>IDENTITY 전략</p></blockquote><p>기본키 생성을 데이터베이스에 위임하고 주로 Mysql, PostgreSQL, SQL Server, DB2에서 사용됩니다. (AUTO_INCREMENT)<br>그리고 JPA는 주로 트랜잭션 커밋 시점에 INSERT SQL을 실행합니다. AUTO_INCREMENT는 데이터베이스에 INSERT SQL을 실행한 이후에 ID값을 알 수 있고 IDENTITY 전략은 em.persist() 시점에 즉시 INSERT SQL을 실행하고 DB에서 식별자를 조회해옵니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.IDENTITY)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>SEQUENCE 전략</p></blockquote><p>데이터 베이스 시퀀스는 유일한 값을 순서대로 생성하는 특별한 데이터베이스 오브젝트입니다. 예를 들면 오라클 시퀀스와 같습니다. 그리고 오라클, PostgreSQL, DB2, H2 데이터베이스에서 사용됩니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Entity</span></span><br><span class="line"><span class="meta">@SequenceGenerator</span>(</span><br><span class="line">    name = <span class="string">"MEMBER_SEQ_GENERATOR"</span>,</span><br><span class="line">    sequenceName = <span class="string">"MEMBER_SEQ"</span></span><br><span class="line">    initValue = <span class="number">1</span>, allocationSize = <span class="number">1</span>)</span><br><span class="line">)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="meta">@Id</span></span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.SEQUENCE,</span><br><span class="line">    generator = <span class="string">"MEMBER_SEQ_GENERATOR"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>name: 식별자 이름</li><li>sequenceName: 데이터베이스에 등록되어있는 시퀀스 이름</li><li>initialValue: DDL 생성시에만 사용되고 시퀀스 DDL을 생성할때 처음 1 시작하는 수를 지정합니다.</li><li>allocationSize: 시퀀스 한 번 호출에 증가하는 수이며 성능최적화에 주로 사용됩니다. 데이터베이스 시퀀스 값이 하나씩 증가하도록 설정되어 있으면 이 값을 반드시 1로 설정하여야합니다.</li><li>catalog, schema: 데이터베이스 catalog, schema 이름</li></ul><h1 id="teibeul-jeonryag"><a href="#teibeul-jeonryag" class="header-anchor">6. </a><a class="markdownIt-Anchor" href="#테이블-전략"></a> 테이블 전략</h1><p>키 생성 전용 테이블을 하나 만들어서 데이터베이스 시퀀스를 흉내내는 전략인데 모든 데이터베이스에 적용이 가능하지만 성능적으로 뛰어나지는 않다는 단점을 가지고 있습니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableGenerator</span>(</span><br><span class="line">    name = <span class="string">"MEMBER_SEQ_GENERATOR"</span>,</span><br><span class="line">    table = <span class="string">"MY_SEQUENCES"</span>,</span><br><span class="line">    pkColumnValue = <span class="string">"MEMBER_SEQ"</span>, allocationSize = <span class="number">1</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span></span>&#123;</span><br><span class="line">    <span class="meta">@GeneratedValue</span>(strategy = GenerationType.TABLE,            <span class="comment">// 테이블 전략외</span></span><br><span class="line">    generator = <span class="string">"MEMBER_SEQ_GENERATOR"</span>)</span><br><span class="line">    <span class="keyword">private</span> Long id</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>@TableGenerator 속성</p></blockquote><ul><li>name: 식별자 이름(필수값)</li><li>table: 키생성 테이블명</li><li>pcColumnName: 시퀀스 컬럼명</li><li>valueColumnNa: 시퀀스 값 컬럼명</li><li>pkColumnValue: 키로 사용할 이름</li><li>initialValue: 초기 값, 마지막으로 생성된 값이 기준</li><li>allocationSize: 시퀀스 한 번 호출에 증가하는 수이며 최적화에 사용된다.</li><li>catalog, schema: 데이터베이스 catalog, schema 이름</li><li>uniqueConstraint: 유니크 제약조건 지정</li></ul><h1 id="gweonjanghaneun-sigbyeolja-jeonryag"><a href="#gweonjanghaneun-sigbyeolja-jeonryag" class="header-anchor">7. </a><a class="markdownIt-Anchor" href="#권장하는-식별자-전략"></a> 권장하는 식별자 전략</h1><p>기본 키 제약조건을 사용하고 null이 아니여야하고 변경성이 없어야합니다. 그리고 대체키를 활용하여 사용하도록 합니다. 즉, UUID와 같은 Long형+대체키+키생성전략을 사용하여 대체키를 생성할 수 있어야합니다. 예) 주민번호 PK</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;entity-maeping-eonoteisyeon&quot;&gt;&lt;a href=&quot;#entity-maeping-eonoteisyeon&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;
      
    
    </summary>
    
    
      <category term="JPA" scheme="http://gwanhyeon.github.io/categories/jpa/"/>
    
    
      <category term="JPA" scheme="http://gwanhyeon.github.io/tags/jpa/"/>
    
      <category term="Entity" scheme="http://gwanhyeon.github.io/tags/entity/"/>
    
  </entry>
  
  <entry>
    <title>Network HTTP 상태코드</title>
    <link href="http://gwanhyeon.github.io/Network-20210205-network-09-http-%EC%83%81%ED%83%9C%EC%BD%94%EB%93%9C/"/>
    <id>http://gwanhyeon.github.io/Network-20210205-network-09-http-%EC%83%81%ED%83%9C%EC%BD%94%EB%93%9C/</id>
    <published>2021-02-05T04:17:11.000Z</published>
    <updated>2021-02-05T05:22:43.294Z</updated>
    
    <content type="html"><![CDATA[<h1 id="http-sangtaekodeu"><a href="#http-sangtaekodeu" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#http-상태코드"></a> HTTP 상태코드</h1><h2 id="sangtae-kodeu"><a href="#sangtae-kodeu" class="header-anchor">1.1. </a><a class="markdownIt-Anchor" href="#상태-코드"></a> 상태 코드</h2><p>상태코드라고 하는것은 클라이언트가 보낸 요청의 처리상태를 응답에서 알려주는 기능이라고 할 수 있습니다.</p><p>예를 들어보겠습니다. 크롬에서 개발자모드를 키면 network탭에 보시면 어떤식으로 응답이 오고가는지를 확인할 수 있습니다.</p><blockquote><p>상태코드 예시</p></blockquote><ul><li>1xx(Informational): 요청 수신 및 처리진행중일때 나오는 상태코드</li><li>2xx(Successful): 요청 정상 처리 상태코드</li><li>3xx(Redirection): 요청을 완료하려면 추가 행동필요함을 알리는 상태코드</li><li>4xx(Client Error): 클라이언트 오류, 잘못된 문법 서버 요청 수행할 수 없을때 상태코드</li><li>5xx(Server Error): 서버 오류, 서버가 정상 요청을 처리하지 못할때 나오는 상태코드</li></ul><p>인식할 수 없는 상태코드를 서버가 반환하게 되는 경우 상위 상태코드를 해석해서 처리를 진행합니다. 즉, 2xx면 성공상태 코드라고 생각하고, 4xx 클라이언트에러, 5xx 서버에러라고 생각하면 상태코드를 변경하지 않아도되게됩니다.</p><h2 id="sangtaekodeubyeol-ceori"><a href="#sangtaekodeubyeol-ceori" class="header-anchor">1.2. </a><a class="markdownIt-Anchor" href="#상태코드별-처리"></a> 상태코드별 처리</h2><ol><li><p>1xx(Informational)<br>현재 요청이 수신이 되어 처리를 진행중인 상태</p></li><li><p>2xx(Successful)<br>클라이언트의 요청을 성공적인 처리한 상태<br>200: OK, 201: Created(리소스 생성),  202: Accepted(요청접수 처리되었으나 처리 완료 X) - 배치 처리, 204: No Content: 서버가 요청을 성공적으로 수행했지만, 응답 페이로드 본문에 보낼 데이터가 없을때 처리합니다.</p></li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 200 OK</span><br><span class="line">HTTP/1.1 201 Created</span><br><span class="line">HTTP/1.1 202 Accepted </span><br><span class="line">HTTP/1.1 200 No Content</span><br></pre></td></tr></table></figure><ol start="3"><li>3xx(Redirection)<br>요청을 완료하기 위해서는 유저의 에이전트에서 추가 조치가 필요한 상태코드</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">HTTP/1.1 300 Multiple Choices</span><br><span class="line">HTTP/1.1 301 Moved Permanently</span><br><span class="line">HTTP/1.1 302 Found</span><br><span class="line">HTTP/1.1 303 See Other</span><br><span class="line">HTTP/1.1 304 Not Modified</span><br><span class="line">HTTP/1.1 307 Temporary Redirect</span><br><span class="line">HTTP/1.1 308 Permanent Redirect</span><br></pre></td></tr></table></figure><p>웹 브라우저는 3xx 응답의 결과에 Location가 있는 경우 해당 위치로 리다이렉션을 진행합니다.</p><ul><li><p>영구 리다이렉션: 특정 리소스의 UR가 영구적으로 리다이렉션<br>301: 리다이렉트시 요청 메서드가 GET 변경되어 본문 제거<br>308: 리다이렉트시 요청 메서드와 본문 유지</p></li><li><p>일시적 리다이렉션: 특정 로직 주문같은 경우 주문이 모두 완료시 GET화면으로 리다이렉션<br>302: 리다이렉트시 요청 메서드가 GET 변경 본문 제거<br>307: 302와 기능은 같으나 요청메서드와 본문 유지<br>308: 리다이렉트시 요청 메서드가 GET으로 변경</p></li><li><p>특수 리다이렉션: 결과를 캐시로 리다이렉션<br>300: 잘 사용되지 않음<br>304: 캐시를 목적으로 사용되며 로컬 PC저장된 캐시를 재사용합니다.</p></li></ul><ol start="4"><li>4xx(Client Error)</li></ol><p>클라이언트의 요청에 잘못된 문법등으로 서버가 요청을 수행할 수 없습니다. 즉, 오류의 원인은 클라이언트</p><ul><li>400(Bad Request): 클라이언트가 잘못된 요청을 해서 서버가 요청을 처리할 수 없습니다.<br>요청 구문, 메시지 등의 오류와 클라이언트는 요청 내용을 다시검토하고 데이터를 전송해야합니다. Request Parameter 혹은 API 스펙이 맞지 않을 경우</li></ul><p>400은 500번과 다르게 복구가 불가능하고 500번은 같은 요청시 성공 가능성이 있습니다.</p><ul><li>401(Unauthorizaed)<br>클라이언트가 해당 리소스에 대한 인증이 필요합니다.</li></ul><p>인증이 되지 않거나 401 오류 발생시 응답에 WWW-Authenticate헤더와 함께 인증 방법을 설명해야합니다.<br>인증: 로그인, 인가: 권한부여(ADMIN)</p><ul><li><p>403(Forbidden)<br>서버가 요청을 이해했지만 승인을 거부한 경우<br>주로 인증 자격 증명은 있지만, 접근 권한이 불충분한 경우 발생할 수 있습니다. (인가관련된 허가 여부-ADMIN)</p></li><li><p>404(Not Found)<br>요청 리소스를 찾을 수 없을때 발생하거나 권한이 부족한 리소스에 접근할때 발생합니다. 혹은 리소스를 Hide처리하고 싶을때 발생합니다.</p></li></ul><ol start="5"><li>5xx(Server Error)</li></ol><p>서버 문제로 오류가 발생할때 반환하는 상태코드입니다. 만약 서버가 문제가 있으니 클라이언트에서 재시도를 진행하면 성공할 수도 있다는것이 장점입니다.</p><ul><li><p>500(Internal Server Error)<br>서버 문제로 오류 발생, 애매하면 500을 반환합니다.</p></li><li><p>503(Service Unavailable)<br>서비스 이용 불가, 일시적인 과부하또는 예정된 작업으로 잠시 요청을 처리할 수 없는 경우 반환합니다. Retry-After헤더필드를 사용하면 얼마뒤에 복구되는지 반환시킬 수 있습니다.</p></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;http-sangtaekodeu&quot;&gt;&lt;a href=&quot;#http-sangtaekodeu&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#http-상태코드&quot;&gt;&lt;/a&gt; HTT
      
    
    </summary>
    
    
      <category term="Network" scheme="http://gwanhyeon.github.io/categories/network/"/>
    
    
      <category term="network" scheme="http://gwanhyeon.github.io/tags/network/"/>
    
      <category term="http" scheme="http://gwanhyeon.github.io/tags/http/"/>
    
      <category term="상태코드" scheme="http://gwanhyeon.github.io/tags/%EC%83%81%ED%83%9C%EC%BD%94%EB%93%9C/"/>
    
  </entry>
  
  <entry>
    <title>01 마이크로서비스 아키텍처의 이해</title>
    <link href="http://gwanhyeon.github.io/MSA-20210212-01-%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EC%9D%98%EC%9D%B4%ED%95%B4/"/>
    <id>http://gwanhyeon.github.io/MSA-20210212-01-%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%EC%84%9C%EB%B9%84%EC%8A%A4-%EC%95%84%ED%82%A4%ED%85%8D%EC%B2%98%EC%9D%98%EC%9D%B4%ED%95%B4/</id>
    <published>2021-02-04T01:52:30.000Z</published>
    <updated>2021-02-11T17:35:25.336Z</updated>
    
    <content type="html"><![CDATA[<h1 id="sopeuteuweeo-akitegceoyi-ihae"><a href="#sopeuteuweeo-akitegceoyi-ihae" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#소프트웨어-아키텍처의-이해"></a> 소프트웨어 아키텍처의 이해</h1><h1 id="sopeuteuweeo-akitegceoran-mueosilgga"><a href="#sopeuteuweeo-akitegceoran-mueosilgga" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#소프트웨어-아키텍처란-무엇일까"></a> 소프트웨어 아키텍처란 무엇일까?</h1><h2 id="sopeuteuweeo-akitegceoyi-jeongyi"><a href="#sopeuteuweeo-akitegceoyi-jeongyi" class="header-anchor">2.1. </a><a class="markdownIt-Anchor" href="#소프트웨어-아키텍처의-정의"></a> 소프트웨어 아키텍처의 정의</h2><p>소프트웨어 아키텍처(software architecture)는 소프트웨어를 구성하는 요소와 요소간의 관계를 정의한것 입니다.<br>이는 소프트웨어의 전체적인 구성 관계인 구성 요소와 구성 요소간의 포함 관계, 호출 관계 등을 표현하여 소프트웨어 구성 전체를 조망하고 이해하는 데 매우 유용합니다.</p><h2 id="akitegceoyi-pyohyeon"><a href="#akitegceoyi-pyohyeon" class="header-anchor">2.2. </a><a class="markdownIt-Anchor" href="#아키텍처의-표현"></a> 아키텍처의 표현</h2><p>아키텍처는 시스템을 조망하고 소통의 도구이므로 이해할 수 있는 언어와 수준으로 작성되고 공유되야 합니다.<br>아키텍처를 표현하는 언어는 <code>UML(Unified Modeling Language)</code>와 같은 표준화 모델링 언어를 이용하여 작성해야합니다.</p><blockquote><p>표준된 언어를 사용하는 이유</p></blockquote><p>아키텍처를 표현하는 방법이 이를 표현하는 아키텍트(architect) 수준과 설계도 모습도 제각각으로 도식, 표기법으로 작성될 가능성이 높아 다르게 해석가능성이 있습니다.</p><p>하나의 아키텍처에는 <code>운영자, 아키텍트, 백엔드 개발자, 프론트엔드 개발자, 품질 담당자 등등</code> 각기 다른 아키텍처를 이해할 수 있는 상황이 발생하게 됩니다. 즉, 다양한 이해관계 각자의 관점에서 시스템을 바라봅니다.<br>아키텍처의 다양한 관점으로 접근하고 표현되는것을 <code>뷰(view)</code>라 일컫습니다.</p><blockquote><p>4+1 View(뷰)</p></blockquote><ol><li><p>논리 뷰(logic view)<br>소프트웨어를 구성하는 요소들의 관계 구조</p></li><li><p>프로세스 뷰(process view)<br>동적 흐름과 스레드(thread), 프로세스(process)등의 동시성 처리</p></li><li><p>구현 뷰(implementaion view)<br>논리적인 설계의 실제 구현된측면에서 소프트웨어의 구성과 구조</p></li><li><p>배치 뷰(deployment view)<br>소프트웨어 배치</p></li></ol><p>즉, 4가지의 모든 뷰를 포함하는 중심에는 <code>유스케이스 뷰(usecase view)</code></p><blockquote><p>View(뷰)란?</p></blockquote><p>시스템과 관련된 다양한 이해관계자들이 소프트웨어의 구조를 쉽게 이해할 수 있게 다양한 관점을 제시하고 표현한 명세</p><h2 id="akitegceoyi-yeoghal"><a href="#akitegceoyi-yeoghal" class="header-anchor">2.3. </a><a class="markdownIt-Anchor" href="#아키텍처의-역할"></a> 아키텍처의 역할</h2><p>소프트웨어 아키텍처는 폭넓은 시각과 사례를 기반으로 설계되어야합니다. 프로그램들을 연결하고 안정적으로 운영하기 위한 전체적인 뼈대를 설계하는 것이 무엇보다 중요합니다.<br>즉, 아키텍처는 구성 요소 간의 역할관계가 명확하고 효율적으로 구성될때 탄력적인 아키텍처가 되고, 시스템 품질속성으로 충족할 수 있게 설계되어야 합니다.</p><h1 id="sopeuteuweeo-akitegceo-seutail"><a href="#sopeuteuweeo-akitegceo-seutail" class="header-anchor">3. </a><a class="markdownIt-Anchor" href="#소프트웨어-아키텍처-스타일"></a> 소프트웨어 아키텍처 스타일</h1><h2 id="seutail"><a href="#seutail" class="header-anchor">3.1. </a><a class="markdownIt-Anchor" href="#스타일"></a> 스타일</h2><p>아키텍처의 스타일은 특정 제약 조건에서 아키텍처의 방향과 접근 방법을 말합니다. 즉, 어떠한 상황에 잘 어울릴 수 있는 방식이나 형태입니다.</p><h2 id="sopeuteuweeo-akitegceo-seutail"><a href="#sopeuteuweeo-akitegceo-seutail" class="header-anchor">3.2. </a><a class="markdownIt-Anchor" href="#소프트웨어-아키텍처-스타일-2"></a> 소프트웨어 아키텍처 스타일</h2><p>소프트웨어 아키텍처 스타일(software architecture style) 시스템 요건을 충족시키기 위한 제약 조건을 가진 아키텍처 측면의 접근방법입니다. 아키텍처 스타일과 아키텍처 패턴을 흔히 혼용해서 사용하지만 둘 사이에는 차이점이 존재합니다.</p><p>스타일은 상호아을 해결할 수 있는 접근 방법을 제시하지만, 정답을 제시해주지는 않습니다. 다만, 스타일에서 제시하는 접근 방법을 선택하면 그만큼 실패할 확률을 줄일 수 있습니다.<br>즉, 스타일은 접근방식을 제시하고 패턴은 구체적은 해결 전술을 제시한다고 생각하면 됩니다.</p><blockquote><p>아키텍처 스타일 예시</p></blockquote><p>아키텍처 -&gt; 아키텍처 스타일 -&gt; 시스템의 구조가 있으면 아키텍처 접근 방향을 제시하고 아키텍처를 어떻게 설계할지를 고민합니다.</p><blockquote><p>아키텍처 패턴</p></blockquote><p>메시지 전달이나 이벤트처리, Peer to Peer Patten, 이벤트-버스 패턴(Event Bus Pattern), Listener</p><h1 id="akitegceowa-akitegteu-yeoghalyi-byeonhwa"><a href="#akitegceowa-akitegteu-yeoghalyi-byeonhwa" class="header-anchor">4. </a><a class="markdownIt-Anchor" href="#아키텍처와-아키텍트-역할의-변화"></a> 아키텍처와 아키텍트 역할의 변화</h1><h2 id="monolriseueseo-maikeuroseobiseuro-byeonhwa"><a href="#monolriseueseo-maikeuroseobiseuro-byeonhwa" class="header-anchor">4.1. </a><a class="markdownIt-Anchor" href="#모놀리스에서-마이크로서비스로-변화"></a> 모놀리스에서 마이크로서비스로 변화</h2><blockquote><p>모놀리스한 아키텍처란?</p></blockquote><p>모든 업무로직이 하나의 애플리케이션 형태로 패키지(package)되어 서비스 되고, 애플리케이션에서 사용하는 데이터 또한 한곳에 모인 데이터를 참조하여 서비스하는 것이 일반적인 형태입니다.</p><p>제조회사에서는 약 1000개이상의 프로그램들이 단일 애플리케이션 패키지로 배포하고 돌아가기때문에 일부 프로그램을 수정하려고 하면 단일 애플리케이션이 다시 배포되어야 하는 번거로움과 시간적인 비용이 들어가게 됩니다.<br>즉, 관리구조의 편리함을 가지고 있지만 변화에 대한 대응이 힘들 수 있습니다.</p><p>Cloud, PaaS(Platform as a service)같은 플랫폼 서비스가 지금 수준으로 서비스 되지 않던 시절의 기준에서는 최적의 아키텍처 설계안으로 간주되었습니다.</p><p>하지만, 현재에는 서비스를 유연하고 안정적으로 운영할 수 있는 인프라 지원기술들(AWS, Azure)가 등장하면서 서비스 설계의 접근방법과 구축 운영 형태의 패러다임 전환이 일어나고 있습니다. 이때 나타나게 된 것이 마이크로 서비스입니다.</p><blockquote><p>마이크로 서비스</p></blockquote><p>기존 모놀리스와 달리 하나의 큰 애플리케이션을 아주 작은 애플리케이션으로 나누어 서비스하는 사싱입니다. 단일 애플리케이션이 가지는 단점을 해결하고 민첩성과 유연한 시스템을 구축할 수  있습니다.</p><h2 id="hoesaegjidaewa-akitegteu"><a href="#hoesaegjidaewa-akitegteu" class="header-anchor">4.2. </a><a class="markdownIt-Anchor" href="#회색지대와-아키텍트"></a> 회색지대와 아키텍트</h2><p>대내외 크고 작은 시스템 통합 프로젝트를 수행하다 보면 업무 영억이나 기술적인 측면에서 담당자가 애매하거나 복잡한 이해관계자들의 의견대립으로 결론나지 않은 상태 혹은 무관심한 상태로 방치되는 영역이 생기게 됩니다.<br>기술적인 측면에서 팀간의 틈을 메워 주는 역할자는 아키텍트 집단입니다 즉, 조직간에 발생할 수 있는 기술적 이슈와 연결에 대한 해결과 중재, 결과물의 통합과 프로젝트 경계 밖의 요소와 연결하는 역할을 잘 수행하여 프로젝트를 이끄는것들이 아키텍처 집단의 역할이 됩니다.</p><h2 id="akitegteu-yeoghalyi-sebunhwawa-byeonhwa"><a href="#akitegteu-yeoghalyi-sebunhwawa-byeonhwa" class="header-anchor">4.3. </a><a class="markdownIt-Anchor" href="#아키텍트-역할의-세분화와-변화"></a> 아키텍트 역할의 세분화와 변화</h2><p>아키텍트들은 프로젝트 모든 기술 요소에 이해수준이 높아야하며 소프트웨어와 하드웨어의 기술 구조를 이해하고 활용을 위한 가이드 배포를 작업하는 수행을 합니다. 모놀리스 형태의 아키텍처든 마이크로서비스 아키텍처구조에 대한 아키텍트 역할에 대한 구분이 필요한 이유중에 하나가 됩니다.</p><blockquote><p>역할의 세분화</p></blockquote><p>소프트웨어 아키텍트, 프론트엔드 아키텍트, 프레임워크 아키텍트, 데이터 아키텍트, 테크니컬 아키텍트, 인프라 아키텍트</p><h2 id="solrusyeon-akitegteu"><a href="#solrusyeon-akitegteu" class="header-anchor">4.4. </a><a class="markdownIt-Anchor" href="#솔루션-아키텍트"></a> 솔루션 아키텍트</h2><p>과거에는 아키텍트들이 했던 대부분의 작업 Saas(Software as a service), PaaS(Platform as a service), IaaS(Infrastructure as a service) 등 자동화된 기능으로 지원하게 되었습니다.</p><blockquote><p>예시</p></blockquote><ol><li>시스템 자원 구성, 할당, 관리, 모니터링, 소프트웨어 빌드, 통합, 배포 등의 일련의 프로세스들을 최근에는 자동화 시각화</li><li>인증 권한, 로깅, 모니터링 서비스기능 단위까지도 SaaS형태로 제공</li></ol><h1 id="gyeolron"><a href="#gyeolron" class="header-anchor">5. </a><a class="markdownIt-Anchor" href="#결론"></a> 결론</h1><p>아키텍트들도 기존 온프레미스(on-premise) 형태의 구축성 사업에서 요구하는 역할보다는 하루가 다르게 새롭게 만들어지는 기술 집약적 솔루션의 특징을 이해하고 조합할 줄 아는 능력이 요구되어지고 있습니다.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;sopeuteuweeo-akitegceoyi-ihae&quot;&gt;&lt;a href=&quot;#sopeuteuweeo-akitegceoyi-ihae&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; hr
      
    
    </summary>
    
    
      <category term="MSA" scheme="http://gwanhyeon.github.io/categories/msa/"/>
    
    
      <category term="MSA" scheme="http://gwanhyeon.github.io/tags/msa/"/>
    
  </entry>
  
  <entry>
    <title>Redis 설치 및 명령어 정리</title>
    <link href="http://gwanhyeon.github.io/Database-20210131-redis-install-command/"/>
    <id>http://gwanhyeon.github.io/Database-20210131-redis-install-command/</id>
    <published>2021-01-30T16:17:34.000Z</published>
    <updated>2021-01-31T03:17:32.559Z</updated>
    
    <content type="html"><![CDATA[<h1 id="1-mac-os-redis"><a href="#1-mac-os-redis" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#1mac-os-redis"></a> 1.Mac OS Redis</h1><blockquote><p>Redis 설치하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$brew</span> install redis</span><br><span class="line"></span><br><span class="line">Warning: Treating redis as a formula. For the cask, use homebrew/cask/redis</span><br><span class="line">==&gt; Downloading https://homebrew.bintray.com/bottles/redis-6.0.9.catalina.bottle.tar.gz</span><br><span class="line">==&gt; Downloading from https://d29vzk4ow07wi7.cloudfront.net/673b1485f012e3c9a509c913d175e18451ddab50eca0</span><br><span class="line"><span class="comment">######################################################################## 100.0%</span></span><br><span class="line">==&gt; Pouring redis-6.0.9.catalina.bottle.tar.gz</span><br><span class="line">==&gt; Caveats</span><br><span class="line">To have launchd start redis now and restart at login:</span><br><span class="line">  brew services start redis</span><br><span class="line">Or, <span class="keyword">if</span> you don<span class="string">'t want/need a background service you can just run:</span></span><br><span class="line"><span class="string">  redis-server /usr/local/etc/redis.conf</span></span><br><span class="line"><span class="string">==&gt; Summary</span></span><br><span class="line"><span class="string">🍺  /usr/local/Cellar/redis/6.0.9: 13 files, 3.9MB</span></span><br></pre></td></tr></table></figure><p>다음과 같이 명령어를 진행하면 Redis설치가 진행됩니다. 아직 Homebrew가 없으신분들은 반드시 설치를 하셔야합니다.</p><blockquote><p>Redis가 설치된 경로</p></blockquote><p>Redis의 실행파일은 다음과 같은 경로에 저장됩니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/bin/redis-server</span><br></pre></td></tr></table></figure><p>Redis 설정파일은 다음과 같은 경로에 저장됩니다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/<span class="built_in">local</span>/etc/redis.conf</span><br></pre></td></tr></table></figure><h1 id="2-redis-silhaenghagi"><a href="#2-redis-silhaenghagi" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#2-redis-실행하기"></a> 2. Redis 실행하기</h1><p>이제 brew를 통하여 Redis를 성공적으로 설치를 하였으니 Redis서버를 실행하여봅시다.</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$redis</span>-server</span><br></pre></td></tr></table></figure><p>다음과 같은 명령어를 사용하면</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">10529:C 31 Jan 2021 01:08:11.335 <span class="comment"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span></span><br><span class="line">10529:C 31 Jan 2021 01:08:11.335 <span class="comment"># Redis version=6.0.9, bits=64, commit=00000000, modified=0, pid=10529, just started</span></span><br><span class="line">10529:C 31 Jan 2021 01:08:11.335 <span class="comment"># Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf</span></span><br><span class="line">10529:M 31 Jan 2021 01:08:11.337 * Increased maximum number of open files to 10032 (it was originally <span class="built_in">set</span> to 256).</span><br><span class="line">                _._</span><br><span class="line">           _.-``__ <span class="string">''</span>-._</span><br><span class="line">      _.-``    `.  `_.  <span class="string">''</span>-._           Redis 6.0.9 (00000000/0) 64 bit</span><br><span class="line">  .-`` .-```.  ```\/    _.,_ <span class="string">''</span>-._</span><br><span class="line"> (    <span class="string">'      ,       .-`  | `,    )     Running in standalone mode</span></span><br><span class="line"><span class="string"> |`-._`-...-` __...-.``-._|'</span>` _.-<span class="string">'|     Port: ----</span></span><br><span class="line"><span class="string"> |    `-._   `._    /     _.-'</span>    |     PID: ----</span><br><span class="line">  `-._    `-._  `-./  _.-<span class="string">'    _.-'</span></span><br><span class="line"> |`-._`-._    `-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|</span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-'</span>_.-<span class="string">'    |           http://redis.io</span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-'</span>_.-<span class="string">'    _.-'</span></span><br><span class="line"> |`-._`-._    `-.__.-<span class="string">'    _.-'</span>_.-<span class="string">'|</span></span><br><span class="line"><span class="string"> |    `-._`-._        _.-'</span>_.-<span class="string">'    |</span></span><br><span class="line"><span class="string">  `-._    `-._`-.__.-'</span>_.-<span class="string">'    _.-'</span></span><br><span class="line">      `-._    `-.__.-<span class="string">'    _.-'</span></span><br><span class="line">          `-._        _.-<span class="string">'</span></span><br><span class="line"><span class="string">              `-.__.-'</span></span><br><span class="line"></span><br><span class="line">10529:M 31 Jan 2021 01:08:11.338 <span class="comment"># Server initialized</span></span><br><span class="line">10529:M 31 Jan 2021 01:08:11.338 * Loading RDB produced by version 6.0.9</span><br><span class="line">10529:M 31 Jan 2021 01:08:11.338 * RDB age 64 seconds</span><br><span class="line">10529:M 31 Jan 2021 01:08:11.338 * RDB memory usage when created 0.96 Mb</span><br><span class="line">10529:M 31 Jan 2021 01:08:11.338 * DB loaded from disk: 0.000 seconds</span><br><span class="line">10529:M 31 Jan 2021 01:08:11.338 * Ready to accept connections</span><br><span class="line">redis-cli</span><br><span class="line">^C10529:signal-handler (1612022976) Received SIGINT scheduling shutdown...</span><br><span class="line">10529:M 31 Jan 2021 01:09:36.132 <span class="comment"># User requested shutdown...</span></span><br><span class="line">10529:M 31 Jan 2021 01:09:36.132 * Saving the final RDB snapshot before exiting.</span><br><span class="line">10529:M 31 Jan 2021 01:09:36.135 * DB saved on disk</span><br><span class="line">10529:M 31 Jan 2021 01:09:36.135 <span class="comment"># Redis is now ready to exit, bye bye...</span></span><br></pre></td></tr></table></figure><p>다음과같은 하드디스크같은 그림이 뜨면서 Redis가 정상적으로 동작한것을 확인할 수 있습니다.</p><h1 id="3-redis-cli"><a href="#3-redis-cli" class="header-anchor">3. </a><a class="markdownIt-Anchor" href="#3-redis-cli"></a> 3. Redis-Cli</h1><p>이제 다음과 같이 서버가 동작하게 되었으므로, 해당 터미널은 띄워둔채 다른 터미널을 하나 키신후 다음과 같은 명령어를 진행합니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$redis-cli</span><br><span class="line"><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">6379</span>&gt;</span><br></pre></td></tr></table></figure><p>하나의 콘솔 cli창이 보여지게 되면서 이제 Redis관련 동작을 command로 제어할 수 있게됩니다.</p><h1 id="4-redis-command"><a href="#4-redis-command" class="header-anchor">4. </a><a class="markdownIt-Anchor" href="#4-redis-command"></a> 4. Redis Command</h1><blockquote><p>redis 키 생성 및 조회</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> gwan www.github.com</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt;</span><br><span class="line">127.0.0.1:6379&gt; get gwan</span><br><span class="line"><span class="string">"www.github.com"</span></span><br></pre></td></tr></table></figure><blockquote><p>모든 키값 조회하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; keys *</span><br><span class="line">1) <span class="string">"gwan"</span></span><br></pre></td></tr></table></figure><blockquote><p>저장된 키값 조회</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$127</span>.0.0.1:6379&gt; keys *gw*</span><br><span class="line">1) <span class="string">"gwan"</span></span><br></pre></td></tr></table></figure><blockquote><p>키 존재여부 확인</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; exists gwan</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br></pre></td></tr></table></figure><blockquote><p>키 삭제하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; del gwan</span><br><span class="line">(<span class="built_in">integer</span>) 0</span><br><span class="line">127.0.0.1:6379[15]&gt; keys *</span><br><span class="line">(empty array)</span><br></pre></td></tr></table></figure><blockquote><p>키 만료시간 지정하기(Second)</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; expire gwan 100</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><blockquote><p>키 만료시간 지정하기(Unix Time)</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; expireat gwan 100</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379[15]&gt; ttl gwan</span><br><span class="line">(<span class="built_in">integer</span>) -2</span><br></pre></td></tr></table></figure><blockquote><p>키 만료시간 삭제</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; persist gwan</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br></pre></td></tr></table></figure><blockquote><p>키 만료시간 확인하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; expire gwan 1000</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379[15]&gt; ttl gwan</span><br><span class="line">(<span class="built_in">integer</span>) 997</span><br></pre></td></tr></table></figure><blockquote><p>키 타입 조회</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; <span class="built_in">type</span> gwan</span><br><span class="line">string</span><br></pre></td></tr></table></figure><blockquote></blockquote><blockquote><p>Redis 정보 조회</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379[15]&gt; info</span><br><span class="line"><span class="comment"># Server</span></span><br><span class="line">redis_version:6.0.9</span><br><span class="line">redis_git_sha1:00000000</span><br><span class="line">redis_git_dirty:0</span><br><span class="line">redis_build_id:26c3229b35eb3beb</span><br><span class="line">redis_mode:standalone</span><br><span class="line">os:Darwin 19.5.0 x86_64</span><br><span class="line">arch_bits:64</span><br><span class="line">multiplexing_api:kqueue</span><br><span class="line">atomicvar_api:atomic-builtin</span><br><span class="line">gcc_version:4.2.1</span><br><span class="line">process_id:10758</span><br><span class="line">run_id:91ff9f67b95c54f394234f6004cffbe07960d2b2</span><br><span class="line">tcp_port:6379</span><br><span class="line">uptime_in_seconds:1719</span><br><span class="line">uptime_in_days:0</span><br><span class="line">hz:10</span><br><span class="line">configured_hz:10</span><br><span class="line">lru_clock:1412238</span><br><span class="line">executable:/Users/kgh/redis-server</span><br><span class="line">config_file:</span><br><span class="line">io_threads_active:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Clients</span></span><br><span class="line">connected_clients:1</span><br><span class="line">client_recent_max_input_buffer:16</span><br><span class="line">client_recent_max_output_buffer:0</span><br><span class="line">blocked_clients:0</span><br><span class="line">tracking_clients:0</span><br><span class="line">clients_in_timeout_table:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Memory</span></span><br><span class="line">used_memory:1066368</span><br><span class="line">used_memory_human:1.02M</span><br><span class="line">used_memory_rss:901120</span><br><span class="line">used_memory_rss_human:880.00K</span><br><span class="line">used_memory_peak:1123120</span><br><span class="line">used_memory_peak_human:1.07M</span><br><span class="line">used_memory_peak_perc:94.95%</span><br><span class="line">used_memory_overhead:1019192</span><br><span class="line">used_memory_startup:1001536</span><br><span class="line">used_memory_dataset:47176</span><br><span class="line">used_memory_dataset_perc:72.77%</span><br><span class="line">allocator_allocated:1019776</span><br><span class="line">allocator_active:863232</span><br><span class="line">allocator_resident:863232</span><br><span class="line">total_system_memory:8589934592</span><br><span class="line">total_system_memory_human:8.00G</span><br><span class="line">used_memory_lua:37888</span><br><span class="line">used_memory_lua_human:37.00K</span><br><span class="line">used_memory_scripts:0</span><br><span class="line">used_memory_scripts_human:0B</span><br><span class="line">number_of_cached_scripts:0</span><br><span class="line">maxmemory:0</span><br><span class="line">maxmemory_human:0B</span><br><span class="line">maxmemory_policy:noeviction</span><br><span class="line">allocator_frag_ratio:0.85</span><br><span class="line">allocator_frag_bytes:18446744073709395072</span><br><span class="line">allocator_rss_ratio:1.00</span><br><span class="line">allocator_rss_bytes:0</span><br><span class="line">rss_overhead_ratio:1.04</span><br><span class="line">rss_overhead_bytes:37888</span><br><span class="line">mem_fragmentation_ratio:0.88</span><br><span class="line">mem_fragmentation_bytes:-118656</span><br><span class="line">mem_not_counted_for_evict:0</span><br><span class="line">mem_replication_backlog:0</span><br><span class="line">mem_clients_slaves:0</span><br><span class="line">mem_clients_normal:17456</span><br><span class="line">mem_aof_buffer:0</span><br><span class="line">mem_allocator:libc</span><br><span class="line">active_defrag_running:0</span><br><span class="line">lazyfree_pending_objects:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Persistence</span></span><br><span class="line">loading:0</span><br><span class="line">rdb_changes_since_last_save:3</span><br><span class="line">rdb_bgsave_in_progress:0</span><br><span class="line">rdb_last_save_time:1612023255</span><br><span class="line">rdb_last_bgsave_status:ok</span><br><span class="line">rdb_last_bgsave_time_sec:-1</span><br><span class="line">rdb_current_bgsave_time_sec:-1</span><br><span class="line">rdb_last_cow_size:0</span><br><span class="line">aof_enabled:0</span><br><span class="line">aof_rewrite_in_progress:0</span><br><span class="line">aof_rewrite_scheduled:0</span><br><span class="line">aof_last_rewrite_time_sec:-1</span><br><span class="line">aof_current_rewrite_time_sec:-1</span><br><span class="line">aof_last_bgrewrite_status:ok</span><br><span class="line">aof_last_write_status:ok</span><br><span class="line">aof_last_cow_size:0</span><br><span class="line">module_fork_in_progress:0</span><br><span class="line">module_fork_last_cow_size:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Stats</span></span><br><span class="line">total_connections_received:1</span><br><span class="line">total_commands_processed:14</span><br><span class="line">instantaneous_ops_per_sec:0</span><br><span class="line">total_net_input_bytes:369</span><br><span class="line">total_net_output_bytes:18757</span><br><span class="line">instantaneous_input_kbps:0.00</span><br><span class="line">instantaneous_output_kbps:0.00</span><br><span class="line">rejected_connections:0</span><br><span class="line">sync_full:0</span><br><span class="line">sync_partial_ok:0</span><br><span class="line">sync_partial_err:0</span><br><span class="line">expired_keys:0</span><br><span class="line">expired_stale_perc:0.00</span><br><span class="line">expired_time_cap_reached_count:0</span><br><span class="line">expire_cycle_cpu_milliseconds:49</span><br><span class="line">evicted_keys:0</span><br><span class="line">keyspace_hits:1</span><br><span class="line">keyspace_misses:0</span><br><span class="line">pubsub_channels:0</span><br><span class="line">pubsub_patterns:0</span><br><span class="line">latest_fork_usec:0</span><br><span class="line">migrate_cached_sockets:0</span><br><span class="line">slave_expires_tracked_keys:0</span><br><span class="line">active_defrag_hits:0</span><br><span class="line">active_defrag_misses:0</span><br><span class="line">active_defrag_key_hits:0</span><br><span class="line">active_defrag_key_misses:0</span><br><span class="line">tracking_total_keys:0</span><br><span class="line">tracking_total_items:0</span><br><span class="line">tracking_total_prefixes:0</span><br><span class="line">unexpected_error_replies:0</span><br><span class="line">total_reads_processed:15</span><br><span class="line">total_writes_processed:14</span><br><span class="line">io_threaded_reads_processed:0</span><br><span class="line">io_threaded_writes_processed:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Replication</span></span><br><span class="line">role:master</span><br><span class="line">connected_slaves:0</span><br><span class="line">master_replid:4c355e7154a8a46cccffd4acfbe1e1ed5e5183d9</span><br><span class="line">master_replid2:0000000000000000000000000000000000000000</span><br><span class="line">master_repl_offset:0</span><br><span class="line">second_repl_offset:-1</span><br><span class="line">repl_backlog_active:0</span><br><span class="line">repl_backlog_size:1048576</span><br><span class="line">repl_backlog_first_byte_offset:0</span><br><span class="line">repl_backlog_histlen:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># CPU</span></span><br><span class="line">used_cpu_sys:0.767543</span><br><span class="line">used_cpu_user:0.575956</span><br><span class="line">used_cpu_sys_children:0.000000</span><br><span class="line">used_cpu_user_children:0.000000</span><br><span class="line"></span><br><span class="line"><span class="comment"># Modules</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Cluster</span></span><br><span class="line">cluster_enabled:0</span><br><span class="line"></span><br><span class="line"><span class="comment"># Keyspace</span></span><br><span class="line">db0:keys=1,expires=0,avg_ttl=0</span><br><span class="line">db15:keys=1,expires=1,avg_ttl=68029</span><br></pre></td></tr></table></figure><blockquote><p>Redis Database 변경</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$select</span> 1</span><br><span class="line"></span><br><span class="line">select 1~15</span><br><span class="line">해당 번호는 1~15 데이터베이스를 선택하겠다 라는 뜻입니다.</span><br></pre></td></tr></table></figure><p><em>주의할점:</em> select를 사용할때 1~15까지 진행하는 이유는 Redis는 하나의 인스턴스에 최대 16개의 데이터베이스를 가질 수 있습니다.</p><blockquote><p>auth 접속하기</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$redis</span>-cli</span><br><span class="line">127.0.0.1:6379&gt; auth 비밀번호입력</span><br></pre></td></tr></table></figure><h1 id="redis-myeongryeongeo-jeongri"><a href="#redis-myeongryeongeo-jeongri" class="header-anchor">5. </a><a class="markdownIt-Anchor" href="#redis-명령어-정리"></a> Redis 명령어 정리</h1><table><thead><tr><th>명령어</th><th>사용예시</th><th>기능설명</th></tr></thead><tbody><tr><td>del</td><td>del ${key}</td><td>키 삭제</td></tr><tr><td>exists</td><td>exists ${key}</td><td>키 존재여부</td></tr><tr><td>expire</td><td>expire ${key} ${second}</td><td>만료시간 지정 (초단위)</td></tr><tr><td>expireat</td><td>expireat $(key} ${unixtime}</td><td>만료시간 지정 (유닉스 시간)</td></tr><tr><td>get</td><td>get ${key}</td><td>해당 키의 값 출력</td></tr><tr><td>info</td><td>info</td><td>redis 정보 조회</td></tr><tr><td>keys</td><td>keys ${key_pattern}</td><td>패턴에 부합하는 키목록 출력</td></tr><tr><td>persist</td><td>persist ${key}</td><td>만료시간을 삭제</td></tr><tr><td>set</td><td>set ${key} ${value}</td><td>키와 데이터를 추가</td></tr><tr><td>ttl</td><td>ttl ${key}</td><td>만료시간 확인</td></tr><tr><td>type</td><td>type ${key}</td><td>해당 키의 타입 확인</td></tr></tbody></table>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;1-mac-os-redis&quot;&gt;&lt;a href=&quot;#1-mac-os-redis&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownIt-Anchor&quot; href=&quot;#1mac-os-redis&quot;&gt;&lt;/a&gt; 1.Mac
      
    
    </summary>
    
    
      <category term="Database" scheme="http://gwanhyeon.github.io/categories/database/"/>
    
    
      <category term="Redis" scheme="http://gwanhyeon.github.io/tags/redis/"/>
    
      <category term="Database" scheme="http://gwanhyeon.github.io/tags/database/"/>
    
      <category term="Command" scheme="http://gwanhyeon.github.io/tags/command/"/>
    
  </entry>
  
  <entry>
    <title>Effective Java 3/E Item 55 옵셔널반환은 신중히 하라</title>
    <link href="http://gwanhyeon.github.io/EffectiveJava-20210126-%EC%95%84%EC%9D%B4%ED%85%9C55-%EC%98%B5%EC%85%94%EB%84%90%EB%B0%98%ED%99%98%EC%9D%80-%EC%8B%A0%EC%A4%91%ED%9E%88%ED%95%98%EB%9D%BC/"/>
    <id>http://gwanhyeon.github.io/EffectiveJava-20210126-%EC%95%84%EC%9D%B4%ED%85%9C55-%EC%98%B5%EC%85%94%EB%84%90%EB%B0%98%ED%99%98%EC%9D%80-%EC%8B%A0%EC%A4%91%ED%9E%88%ED%95%98%EB%9D%BC/</id>
    <published>2021-01-26T12:01:34.000Z</published>
    <updated>2021-01-26T16:09:38.596Z</updated>
    
    <content type="html"><![CDATA[<h1 id="obsyeoneolbanhwaneun-sinjunghi-hara"><a href="#obsyeoneolbanhwaneun-sinjunghi-hara" class="header-anchor">1. </a><a class="markdownIt-Anchor" href="#옵셔널반환은-신중히-하라"></a> 옵셔널반환은 신중히 하라</h1><p>자바 8전에는 메서드가 특정조건에서 값을 반환할 수 없을때 취할 수 있는 선택지가 두가지가 있었다. 예외를 던지거나 null을 반환하는것입니다.</p><blockquote><p>예외</p></blockquote><p>예외의 경우는 스택 추적 전체를 캡처하므로 비용이 만만치 않습니다.</p><blockquote><p>null 반환</p></blockquote><p>null은 반환하면 이런 문제가 생기지 않지만 null을 반환할 수 있는 메서드를 호출할 때는 null이 반환될 일이 절대 없다고 확신하지 않는한) 별도의 null처리 코드를 추가해야합니다. null처리를 무시하고 반환된 null 값을 어딘가에 저장해두면 언젠가 NullPointerException이 발생할 수 있습니다.<br>즉, null을 반환하게 한 실제 원인과는 전혀 상관없는 코드일 경우입니다.</p><h1 id="jaba-8yi-deungjang"><a href="#jaba-8yi-deungjang" class="header-anchor">2. </a><a class="markdownIt-Anchor" href="#자바-8의-등장"></a> 자바 8의 등장</h1><p>Optional<t>는 null이 아닌 T타입 참조를 하나 담거나, 혹은 아무것도 담지 않을 수 있습니다. 아무것도 담지않은 옵셔널은 '비었다’라고 말하며 반대로 어떤값을 담은 옵셔녈은 비지않았다고 합니다. 옵셔널은 원소를 최대 1개 가질 수 있는 '불변’컬렉션입니다. Optional<t>가 Collection<t>를 구현하지는 않았지만, 원칙적으로는 그렇게 처리합니다.</t></t></t></p><p>보통은 T를 반환해야 하지만 특정 조건에서는 아무것도 반환하지 않아야할 때 T대신에 Optional<t>를 반환하도록 선언하면 됩니다. 그러면 유효한 반환값이 없을때는 빈 결과를 반환하는 메서드가 만들어집니다. 옵셔널을 반환하는 메서드는 예외를 던지는 메서드보다 유연하고 사용하기 쉬우며, null을 반환하는 메서드보다 오류 가능성이 적습니다.</t></p><h2 id="keolregsyeoneseo-coedaesgabseul-guhabnida-keolregsyeoni-bieosseumyeon-yeoereul-deonjibnida"><a href="#keolregsyeoneseo-coedaesgabseul-guhabnida-keolregsyeoni-bieosseumyeon-yeoereul-deonjibnida" class="header-anchor">2.1. </a><a class="markdownIt-Anchor" href="#컬렉션에서-최댓값을-구합니다컬렉션이-비었으면-예외를-던집니다"></a> 컬렉션에서 최댓값을 구합니다(컬렉션이 비었으면 예외를 던집니다)</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Run Configuration -&gt; program arguement설정</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; words = Arrays.asList(args);</span><br><span class="line">    System.out.println(max(words));</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 컬렉션에서 최댓값을 구한다 컬렉션이 비었으면 예외를 던진다.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E extends Comparable&lt;E&gt;&gt; <span class="function">E <span class="title">max</span><span class="params">(Collection&lt;E&gt; c)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(c.isEmpty())</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">"empty Collection"</span>);</span><br><span class="line">    E result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (E e : c) &#123;</span><br><span class="line">        <span class="keyword">if</span>(result == <span class="keyword">null</span> || e.compareTo(result) &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            result = Objects.requireNonNull(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="keolregsyeoneseo-coedaesgabseul-guhae-optionalro-banhwanhabnida"><a href="#keolregsyeoneseo-coedaesgabseul-guhae-optionalro-banhwanhabnida" class="header-anchor">2.2. </a><a class="markdownIt-Anchor" href="#컬렉션에서-최댓값을-구해-optionale로-반환합니다"></a> 컬렉션에서 최댓값을 구해 Optional<e>로 반환합니다.</e></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 컬렉션에서 최댓값을 구해 Optional&lt;E&gt;로 반환합니다.</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E extends Comparable&lt;E&gt;&gt; <span class="function">Optional&lt;E&gt; <span class="title">max1</span><span class="params">(Collection&lt;E&gt; c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(c.isEmpty())&#123;</span><br><span class="line">        <span class="keyword">return</span> Optional.empty();</span><br><span class="line">    &#125;</span><br><span class="line">    E result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (E e : c) &#123;</span><br><span class="line">        <span class="keyword">if</span>(result == <span class="keyword">null</span> || e.compareTo(result)&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            result = Objects.requireNonNull(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Optional.of(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>옵셔널 반환하도록 구현하기는 어렵지는 않지만 적절한 정적 팩터리를 사용해 옵셔널을 생성해주기만 하면됩니다. 이 코드에서는 두 가지 팩터리를 사용했습니다.</p><p>빈 옵셔널은 Optional.empty()로 만들고, 값이 든 옵셔널은 Optional.of(value)로 생성하였습니다. Optional.of(value)에 null을 넣으면 NullPointerException을 던집니다.</p><p>null값도 허용하는 옵셔널을 만드려면 Optional.ofNullable(value)를 사용하면 됩니다. <code>옵셔널을 반환하는 메서드에서는 절대 null을 반환하면 안됩니다.</code> (취지에 어긋납니다)</p><p>스트림의 종단 연산중 상당수가 옵셔널을 반환합니다. 앞의 max메서드를 스트림 버전으로 다시 작성하면 Stream의 max연산이 우리에게 필요한 옵셔널을 생성해줄 것입니다.</p><h2 id="keolregsyeoneseo-coedaesgabseul-guhae-optionalro-banhwanhabnida-stream"><a href="#keolregsyeoneseo-coedaesgabseul-guhae-optionalro-banhwanhabnida-stream" class="header-anchor">2.3. </a><a class="markdownIt-Anchor" href="#컬렉션에서-최댓값을-구해-optionale로-반환합니다-stream"></a> 컬렉션에서 최댓값을 구해 Optional<e>로 반환합니다. (Stream)</e></h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 컬렉션에서 최댓값을 구해 Optional&lt;E&gt;로 반환합니다. (Stream)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> &lt;E extends Comparable&lt;E&gt;&gt; <span class="function">Optional&lt;E&gt; <span class="title">max2</span><span class="params">(Collection&lt;E&gt; c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> c.stream().max(Comparator.naturalOrder());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>이렇게 스트림 형식으로 간단하게 처리할 수 잇으며 Null을 반환하거나 예외를 던지는 대신 옵셔널 반환을 선택하는 기준은 무엇일까요?</p><p><code>옵셔널은 검사 예외와 취지가 비슷합니다.</code> 즉, 반환값이 없을 수도 있음을 API 사용자에게 명확하게 알려주며 비검사 예외를 던지거나 null을 반환한다면 API 사용자가 그 사실을 인지하지 못해 끔찍한 결과로 이어질 수 있습니다. 하지만 검사 예외를 던지면 클라이언트에서는 반드시 이에 대처하는 코드를 작성해넣어야합니다.</p><p>비슷하게, 메서드가 옵셔널을 반환한다면 클라이언트는 값을 받지 못했을때 취할 행동을 선택해야합니다.</p><h2 id="obsyeoneol-hwalyong-1-gibongabseul-jeonghaedul-su-issda"><a href="#obsyeoneol-hwalyong-1-gibongabseul-jeonghaedul-su-issda" class="header-anchor">2.4. </a><a class="markdownIt-Anchor" href="#옵셔널-활용-1-기본값을-정해둘-수-있다"></a> 옵셔널 활용 1- 기본값을 정해둘 수 있다.</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 코드 55-4 옵셔널 활용 1 - 기본값을 정해둘 수 있습니다.</span></span><br><span class="line">String lastWordInLexicon = max2(words).orElse(<span class="string">"단어 없음..."</span>);</span><br></pre></td></tr></table></figure><p>상황에 맞는 예외를 던질 수 있으며 다음 코드에서 실제 예외가 아니라 예외 팩터리를 건넨것에 주목해야합니다. 이렇게 하면 예외가 실제로 발생하지 않는한 예외 생성 비용은 들지 않게 됩니다.</p><h2 id="obsyeoneol-hwalyong-2-weonhaneun-yeoe-gabseul-deonjil-su-issseubnida"><a href="#obsyeoneol-hwalyong-2-weonhaneun-yeoe-gabseul-deonjil-su-issseubnida" class="header-anchor">2.5. </a><a class="markdownIt-Anchor" href="#옵셔널-활용-2-원하는-예외-값을-던질-수-있습니다"></a> 옵셔널 활용 2 - 원하는 예외 값을 던질 수 있습니다.</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 원하는 </span></span><br><span class="line">Toy myToy = max2(toys).orElseThrow(words).orElseThrow(TemperTantrumException::<span class="keyword">new</span>);</span><br></pre></td></tr></table></figure><p>옵셔널이 항상 값이 채워져있다고 확신한다면 그냥 바로 꺼내 사용하는 선택지도 있습니다. 다만 잘못 판단한 것이라면 NoSuchElementException이 발생하게 됩니다.</p><h2 id="obsyeoneol-hwalyong-hangsang-gabsi-caeweojyeo-issdago-gajeonghabnida"><a href="#obsyeoneol-hwalyong-hangsang-gabsi-caeweojyeo-issdago-gajeonghabnida" class="header-anchor">2.6. </a><a class="markdownIt-Anchor" href="#옵셔널-활용-항상-값이-채워져-있다고-가정합니다"></a> 옵셔널 활용 - 항상 값이 채워져 있다고 가정합니다.</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Element lastNobleGas = max2(Elements.NOBLE_GASES).get();</span><br></pre></td></tr></table></figure><p>기본값을 설정하는 비용이 아주 커서 부담이 될 수 있습니다. 그럴때는 Supplier<t>를 인수로 받는 orElseGet을 사용하면 값이 처음 필요할때 Supplier<t>를 사용해 생성하므로 초기 설정 비용을 낮출 수 있습니다.</t></t></p><p>filter, map, flatMap, ifPresent메서드는 기본 메서드로 처리하기 어려워보인다면 API문서를 참조해 이 고급 메서드들이 문제를 해결해줄 수 있을지 검토해보면 됩니다.</p><p>isPresent메서드는 안전 밸브역할의 메서드로, 옵셔널이; 채워져있으면 true, 비어져있으면 false를 반환합니다. 이 메서드로는 원하는 모든 작업을 수행할 수 있지만 신중히 사용해야합니다.</p><p>실제로 isPresent를 쓴 코드 중 상당수는 앞서 언급한 메서드들로 대체할 수 있으며, 그렇게 하면 더 짧고 명확하고 용법에 맞는 코드가 됩니다.</p><h2 id="ispresent-meseodeu"><a href="#ispresent-meseodeu" class="header-anchor">2.7. </a><a class="markdownIt-Anchor" href="#ispresent-메서드"></a> isPresent 메서드</h2><blockquote><p>java 9</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">ProcessHandle ph = <span class="keyword">new</span> ProcessHandle() &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">pid</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Optional&lt;ProcessHandle&gt; <span class="title">parent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Optional.empty();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Stream&lt;ProcessHandle&gt; <span class="title">children</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Stream&lt;ProcessHandle&gt; <span class="title">descendants</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Info <span class="title">info</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CompletableFuture&lt;ProcessHandle&gt; <span class="title">onExit</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">supportsNormalTermination</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">destroy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">destroyForcibly</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAlive</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">hashCode</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">equals</span><span class="params">(Object other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">compareTo</span><span class="params">(ProcessHandle other)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">Optional&lt;ProcessHandle&gt; parentProcess = ph.parent();</span><br><span class="line">System.out.println(<span class="string">"부모 PID"</span> + (parentProcess.isPresent() ? String.valueOf(parentProcess.get().pid()) : <span class="string">"N/A"</span>));</span><br><span class="line">System.out.println(<span class="string">"부모 PID"</span> + (ph.parent().map(h -&gt; String.valueOf(h.pid())).orElse(<span class="string">"N/A"</span>)));</span><br></pre></td></tr></table></figure><p>위 코드는 Optional의 map을 사용하여 다음처럼 다듬을 수 있습니다.</p><p>스트림을 사용한다면 옵셔널들을 Stream(Optional<t>&gt; 로 받아서 그중 채워진 옵셔널들에서 값을 뽑아 Stream<t>에 건네 담아 처리하는 경우가 드물지 않습니다.</t></t></p><blockquote><p>java8</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 자바8 구현 </span></span><br><span class="line">streamOfOptionals</span><br><span class="line">        .filter(Optional::isPresent)</span><br><span class="line">        .map(Optional::get)</span><br></pre></td></tr></table></figure><p>옵셔널에 값이 있다면 (Optional::isPresent) 그 값을 꺼내 (Optional::get) 스트림에 매핑합니다.<br>자바9에서는 Optional에 stream()메서드가 추가되었습니다. 이 메서드는 Optional을 stream으로 변환해주는 어댑터 이며 옵셔널에 값이 있으면 그 값을 원소로 담은 스트림으로, 값이 없다면 빈 스트림으로 변환합니다. 이를 stream의 flatMap메서드와 조합하면 명료하게 바꿀 수 있습니다.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">streamOfOptionals</span><br><span class="line">    .flatMap(Optional::stream)</span><br></pre></td></tr></table></figure><p>반환 값으로 옵셔널을 사용한다고 무조건 득이되는것이 아닙니다. 컬렉션, 스트림, 배열, 옵셔널과 같은 컨테이너 타입은 옵셔널로 감싸면 안됩니다. 빈 Optional&lt;List<t>&gt;를 반환하기 보다는 빈 List<t>를 반환하는게 더 좋습니다. 빈 컨테이너를 반환하게 되면 클라이언트에서 옵셔널 처리 코드를 넣지 않아도 됩니다.</t></t></p><ul><li>참고<br><a href="http://ProcessHandle.Info" target="_blank" rel="noopener">ProcessHandle.Info</a> 인터페이스의 arguements 메서드는 Optional&lt;String[]&gt;를 반환하는데, 이는 예외적인 경우이니 따라하지 않도록해야합니다.</li></ul><h2 id="eoddeohan-gyeongue-banhwantaibeul-tdaesin-optionalro-seoneonhaeyahalggayo"><a href="#eoddeohan-gyeongue-banhwantaibeul-tdaesin-optionalro-seoneonhaeyahalggayo" class="header-anchor">2.8. </a><a class="markdownIt-Anchor" href="#어떠한-경우에-반환타입을-t대신-optionalt로-선언해야할까요"></a> 어떠한 경우에 반환타입을 T대신 Optional<t>로 선언해야할까요?</t></h2><p>결과가 없을 수 있으며, 클라이언트가 이 상황을 특별하게 처리해야 한다면 Optional<t>를 반환하도록 합니다.</t></p><p>박싱된 기본 타입을 담는 옵셔널은 기본 타입 자체보다 무거울 수밖에 없으며 자바 API설계자는 int, long, double 전용 옵셔널 클래스들을 준비해놨습니다. 바로 OptionalInt, OptionalLong, OptionalDouble입니다. 이 옵셔널들도 Optional<t>가 제공하는 메서드를 거의 다 제공하게 됩니다.</t></p><p>결과적으로 박싱도니 기본 타입을 담은 옵셔널을 반환하는일은 없도록 해야합니다.</p><h2 id="obsyeoneoleul-maebyi-gabseuro-sayonghaji-malja"><a href="#obsyeoneoleul-maebyi-gabseuro-sayonghaji-malja" class="header-anchor">2.9. </a><a class="markdownIt-Anchor" href="#옵셔널을-맵의-값으로-사용하지-말자"></a> 옵셔널을 맵의 값으로 사용하지 말자</h2><p>옵셔널을 맵의 값으로 사용하면 절대안됩니다. 키 자체가 없는 경우나 다른키는 있지만 그 키가 속이 빈 옵셔널인 경우가 있을 수 있기때문에 혼란만 가중시킬 수 있습니다.</p><p>즉, 옵셔널을 컬렉션의 키, 값, 원소나 배열의 원소로 사용하는 게 적절한 상황은 거의 없습니다.</p><h2 id="obsyeoneoleul-inseuteonseu-pildeue-jeojanghaeduneunge-pilyohan-gyeongu"><a href="#obsyeoneoleul-inseuteonseu-pildeue-jeojanghaeduneunge-pilyohan-gyeongu" class="header-anchor">2.10. </a><a class="markdownIt-Anchor" href="#옵셔널을-인스턴스-필드에-저장해두는게-필요한-경우"></a> 옵셔널을 인스턴스 필드에 저장해두는게 필요한 경우?</h2><p>아이템2의 NutritionFacts 클래스의 예제를 보면 선택적 필드의 게터 메서드들이 옵셔널을 반환해주면 좋습니다. 따라서, 이럴때는 필드 자체를 옵셔널도 선언하는것도 좋은 방법중 하나입니다.</p><h1 id="haegsim-jeongri"><a href="#haegsim-jeongri" class="header-anchor">3. </a><a class="markdownIt-Anchor" href="#핵심-정리"></a> 핵심 정리</h1><p>값을 반환하지 못할 가능성이 있고, 호출할때마다 반환값이 없을 가능성을 염두하는 메서드라면 옵셔널을 반환해야 할 상황일 수도 있습니다. 하지만, 옵셔널 반환에는 성능저하가 뒤따르니, 성능에 민감한 메서드라면 null을 반환하거나 예외를 던지는 편이 나을 수 있습니다. 그리고 옵셔널을 반환값 이외의 용도로 쓰는 경우는 매우 드뭅니다.</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h1 id=&quot;obsyeoneolbanhwaneun-sinjunghi-hara&quot;&gt;&lt;a href=&quot;#obsyeoneolbanhwaneun-sinjunghi-hara&quot; class=&quot;header-anchor&quot;&gt;1. &lt;/a&gt;&lt;a class=&quot;markdownI
      
    
    </summary>
    
    
      <category term="Java" scheme="http://gwanhyeon.github.io/categories/java/"/>
    
    
      <category term="EffectiveJava3/E" scheme="http://gwanhyeon.github.io/tags/effectivejava3-e/"/>
    
      <category term="Optional" scheme="http://gwanhyeon.github.io/tags/optional/"/>
    
  </entry>
  
</feed>
